{"ID":"20240213210820-25r8aus","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240213210820-25r8aus","title":"描述系统调用的流程","updated":"20240213212737"},"Children":[{"ID":"20240213210827-7vdixlo","Type":"NodeParagraph","Properties":{"id":"20240213210827-7vdixlo","updated":"20240213211007"},"Children":[{"Type":"NodeText","Data":"系统调用：用户态进入内核态的形式，用户态程序想操作一些资源，而这些资源只能由内核调用，那么就使用系统调用来操作。"}]},{"ID":"20240213211013-7xi355t","Type":"NodeParagraph","Properties":{"id":"20240213211013-7xi355t","updated":"20240213211026"},"Children":[{"Type":"NodeText","Data":"（内核提供给用户空间的变成接口）"}]},{"ID":"20240213211028-kx53c1d","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240213211028-kx53c1d","updated":"20240213211036"},"Children":[{"Type":"NodeText","Data":"为什么需要系统调用？"}]},{"ID":"20240213211036-ib0n3ox","Type":"NodeParagraph","Properties":{"id":"20240213211036-ib0n3ox","updated":"20240213211116"},"Children":[{"Type":"NodeText","Data":"内核具有操作磁盘等受限资源的权限，对这些资源的调用只能通过内核来执行，因此需要系统调用"}]},{"ID":"20240213211116-eanabwk","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240213211116-eanabwk","updated":"20240213211122"},"Children":[{"Type":"NodeText","Data":"流程"}]},{"ID":"20240213211123-gjgslrx","Type":"NodeParagraph","Properties":{"id":"20240213211123-gjgslrx","updated":"20240213211148"},"Children":[{"Type":"NodeText","Data":"应用程序 ➡ 函数库 ➡ 系统调用 ➡ 内核"}]},{"ID":"20240213211441-3k805k7","Type":"NodeParagraph","Properties":{"id":"20240213211441-3k805k7","updated":"20240213211825"},"Children":[{"Type":"NodeText","Data":"触发中断 ➡ 切换堆栈（用户态切换至内核态） ➡ 执行中断程序（通过中断号找到中断处理程序） ➡ 从中断处理程序返回"}]},{"ID":"20240213211148-qs2deq0","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240213211148-qs2deq0","updated":"20240213211156"},"Children":[{"Type":"NodeText","Data":"中断"}]},{"ID":"20240213210820-kl790w0","Type":"NodeParagraph","Properties":{"id":"20240213210820-kl790w0","updated":"20240213211245"},"Children":[{"Type":"NodeText","Data":"硬件中断：网卡获取数据时发起硬件中断，让CPU读数据"}]},{"ID":"20240213211307-h1aylo5","Type":"NodeParagraph","Properties":{"id":"20240213211307-h1aylo5","updated":"20240213211331"},"Children":[{"Type":"NodeText","Data":"软件中断：应用程序由用户态切换至内核态"}]},{"ID":"20240213211331-7dywuq2","Type":"NodeParagraph","Properties":{"id":"20240213211331-7dywuq2","updated":"20240213211343"},"Children":[{"Type":"NodeText","Data":"中断属性："}]},{"ID":"20240213211343-mcpedil","Type":"NodeParagraph","Properties":{"id":"20240213211343-mcpedil","updated":"20240213211411"},"Children":[{"Type":"NodeText","Data":"1.中断号 2.中断处理程序 3.中断向量表"}]},{"ID":"20240213211357-9l6vo50","Type":"NodeParagraph","Properties":{"id":"20240213211357-9l6vo50","updated":"20240213211434"},"Children":[{"Type":"NodeText","Data":"通过中断向量表和中断号来触发中断处理程序"}]},{"ID":"20240213212257-a0d6v0g","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240213212257-a0d6v0g","updated":"20240213212312"},"Children":[{"Type":"NodeText","Data":"系统调用是否会引起进程或线程切换？"}]},{"ID":"20240213212312-6hnaqm2","Type":"NodeParagraph","Properties":{"id":"20240213212312-6hnaqm2","updated":"20240213212315"},"Children":[{"Type":"NodeText","Data":"不一定。"}]},{"ID":"20240213212315-ownccy5","Type":"NodeParagraph","Properties":{"id":"20240213212315-ownccy5","updated":"20240213212528"},"Children":[{"Type":"NodeText","Data":"比如read(fd, buf, sz); 如果fd带阻塞的属性（默认带阻塞属性），且fd资源未就绪，那么进程就会阻塞，可能会进行进程切换。进程从运行态变为阻塞态。"}]},{"ID":"20240213212531-nmdc094","Type":"NodeParagraph","Properties":{"id":"20240213212531-nmdc094","updated":"20240213212607"},"Children":[{"Type":"NodeText","Data":"如果使用非阻塞系统调用，那么会立刻返回，不会引起进程或线程切换。"}]},{"ID":"20240213212654-g6zq3n9","Type":"NodeParagraph","Properties":{"id":"20240213212654-g6zq3n9","updated":"20240213212654"}},{"ID":"20240213212654-wajgolq","Type":"NodeParagraph","Properties":{"id":"20240213212654-wajgolq","updated":"20240213212737"},"Children":[{"Type":"NodeText","Data":"用户态切换至内核态时，会切换堆栈、切换上下文、改变进程状态等。"}]}]}