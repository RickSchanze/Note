{"ID":"20240422220907-clap6wp","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240422220907-clap6wp","title":"非真实感渲染（NPR） - Gooch着色模型","type":"doc","updated":"20240422221125"},"Children":[{"ID":"20240422220907-i1qr0xj","Type":"NodeParagraph","Properties":{"id":"20240422220907-i1qr0xj","updated":"20240422220923"},"Children":[{"Type":"NodeText","Data":"原链："},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://zhuanlan.zhihu.com/p/455574304","TextMarkTextContent":"非真实感渲染（NPR） - Gooch着色模型 - 知乎 (zhihu.com)"}]},{"ID":"20240422220949-4w1wu69","Type":"NodeParagraph","Properties":{"id":"20240422220949-4w1wu69","updated":"20240422220949"},"Children":[{"Type":"NodeText","Data":"最近在看RTR4，5.1里的Shading Models里讲到了一个叫做Gooch着色模型，书中的示例是用来区分模型相对于光照朝向的冷暖边界[1]。"}]},{"ID":"20240422220949-rihfhut","Type":"NodeParagraph","Properties":{"id":"20240422220949-rihfhut","updated":"20240422221008"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"v2-66f5778c356e5a712aeae634a7e35bf0_1440w"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/net-img-v2-66f5778c356e5a712aeae634a7e35bf0_1440w-20240422225053-hi78z0i.webp"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240422220949-mwudab3","Type":"NodeParagraph","Properties":{"id":"20240422220949-mwudab3","updated":"20240422220949"},"Children":[{"Type":"NodeText","Data":"书中给出的公式如下[3]："}]},{"ID":"20240422221021-uhpn9y9","Type":"NodeMathBlock","Properties":{"id":"20240422221021-uhpn9y9","updated":"20240422221111"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{c}_{\\text {shaded }}=s \\mathbf{c}_{\\text {highlight }}+(1-s)\\left(t \\mathbf{c}_{\\text {warm }}+(1-t) \\mathbf{c}_{\\text {cool }}\\right).\n\\tag{5.1}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240422221114-2x3c94o","Type":"NodeMathBlock","Properties":{"id":"20240422221114-2x3c94o","updated":"20240422221125"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{aligned} \\mathbf{c}_{\\mathrm{cool}} \u0026=(0,0,0.55)+0.25 \\mathbf{c}_{\\mathrm{surface}}, \\\\ \\mathbf{c}_{\\mathrm{warm}} \u0026=(0.3,0.3,0)+0.25 \\mathbf{c}_{\\mathrm{surface}}, \\\\ \\mathbf{c}_{\\mathrm{highlight}} \u0026=(1,1,1), \\\\ t \u0026=\\frac{(\\mathbf{n} \\cdot \\mathbf{l})+1}{2}, \\\\ \\mathbf{r} \u0026=2(\\mathbf{n} \\cdot \\mathbf{l}) \\mathbf{n}-\\mathbf{l}, \\\\ s \u0026=(100(\\mathbf{r} \\cdot \\mathbf{v})-97)^{\\mp} . \\end{aligned}\n\\tag{5.2}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240422220949-wsy1cag","Type":"NodeParagraph","Properties":{"id":"20240422220949-wsy1cag","updated":"20240422220949"},"Children":[{"Type":"NodeText","Data":"Gooch等人则把这个方法用来加强工业技术图解的对比度，如下图所示。这种光照模型相对于Phong模型增强了本体的轮廓感，高光的层次感 [2]。"}]},{"ID":"20240422220949-vlwwv1p","Type":"NodeParagraph","Properties":{"id":"20240422220949-vlwwv1p","updated":"20240422221002"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"v2-deab19478d44d381a239fb0c3eb3e4bb_1440w"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/net-img-v2-deab19478d44d381a239fb0c3eb3e4bb_1440w-20240422225053-3vy933p.webp"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240422220949-uwhysql","Type":"NodeParagraph","Properties":{"id":"20240422220949-uwhysql","updated":"20240422220949"},"Children":[{"Type":"NodeText","Data":"Gooch 等人展示了一种用于工业交互软件里的光照模型"}]},{"ID":"20240422220949-kq7x1a1","Type":"NodeParagraph","Properties":{"id":"20240422220949-kq7x1a1","updated":"20240422220949"},"Children":[{"Type":"NodeText","Data":"gooch着色模型的介绍仅仅是这篇paper内的一小部分，其中还包含了描边、阴影的一些实现方式。"}]},{"ID":"20240422220949-p8nsykw","Type":"NodeParagraph","Properties":{"id":"20240422220949-p8nsykw","updated":"20240422220949"},"Children":[{"Type":"NodeText","Data":"恰好《RTR4》书中提供了其中一小部分的代码，我便尝试用URP写了一下着色部分的shader，以下是部分代码~"}]},{"ID":"20240422220949-7bpux5p","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240422220949-7bpux5p","updated":"20240422220949"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"dGV4dA=="},{"Type":"NodeCodeBlockCode","Data":"    Properties \n    {\n        _MyColor(\"固有色\", Color) = (1, 1, 1, 1) \n        _MySpeColor(\"高光颜色\", Color) = (1, 1, 1, 1)\n        _MyColdColor(\"冷色\", Color) = (0.2, 0.2, 1, 1) //蓝色\n        _MyWarmColor(\"暖色\", Color) = (1, 0.8, 0.2, 1) //黄色\n    }\n\n           half4 frag(v2f i):SV_TARGET\n           {\n               Light mainLight = GetMainLight();\n\n               float3 L = normalize(mainLight.direction);//光照方向\n               float3 N = normalize(i.normal);//法线方向\n               float3 V = normalize(_WorldSpaceCameraPos.xyz - i.vertex_world.xyz);//观察方向\n\n               float3 base_color = _MyColor * mainLight.color.rgb; //固有色 * 灯光色\n               float3 Ka =  _GlossyEnvironmentColor * base_color.rgb; //环境光 * 固有色\n           \n               float3 R = saturate(2 * dot(N,L) * N - L); //高光方向\n               float3 T = (dot(N,L) + 1) / 2; //用来计算冷暖色的程度，相对于N*L的值\n               float3 KCool = _MyColdColor.rgb + 0.25 * Ka; //冷色、偏蓝一些\n               float3 KWarm = _MyWarmColor.rgb + 0.25 * Ka; //暖色、偏黄一些\n\n               float3 S = clamp(100 * dot(R,V) - 97, 0 , 1); //Clamp的程度\n               float3 ShadedColor = S * _MySpeColor.rgb + (1 - S) * (T * KWarm + (1 - T) * KCool);//高光 + 介于0~1之间按T分配的冷暖色\n               return float4( ShadedColor, 1.0f );//Gooch 着色，正面暖色、背面冷色\n           }\n\n        Pass //阴影Pass\n        {\n            ...\n        }\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240422220949-w77m45i","Type":"NodeParagraph","Properties":{"id":"20240422220949-w77m45i","updated":"20240422220949"},"Children":[{"Type":"NodeText","Data":"图一：正面偏暖"}]},{"ID":"20240422220949-7jie18z","Type":"NodeParagraph","Properties":{"id":"20240422220949-7jie18z","updated":"20240422220955"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"v2-2cc66bb8556e5ae0697b501d19275d24_1440w"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/net-img-v2-2cc66bb8556e5ae0697b501d19275d24_1440w-20240422225053-srgm7va.webp"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240422220949-4myu1vq","Type":"NodeParagraph","Properties":{"id":"20240422220949-4myu1vq","updated":"20240422220949"},"Children":[{"Type":"NodeText","Data":"图二：背面偏冷（你怎么看着像法线似的！o(≧口≦)o）"}]},{"ID":"20240422220949-58eyg7z","Type":"NodeParagraph","Properties":{"id":"20240422220949-58eyg7z","updated":"20240422220957"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"v2-86f4b85b2cc5c82912159c8eddc269a7_1440w"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/net-img-v2-86f4b85b2cc5c82912159c8eddc269a7_1440w-20240422225053-68rluei.webp"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240422220949-hqtogsa","Type":"NodeParagraph","Properties":{"id":"20240422220949-hqtogsa","updated":"20240422220949"},"Children":[{"Type":"NodeText","Data":"然后调整其中的clamp参数、NdotL值可以得到一些微妙的效果，我都怀疑这是不是最近比较受欢迎的卡通渲染灵感来源之一....（好像现在比较现代点的卡渲也很少用clamp来做了ಠ_ಠ）"}]},{"ID":"20240422220949-w1v3ryu","Type":"NodeParagraph","Properties":{"id":"20240422220949-w1v3ryu","updated":"20240422220959"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"v2-f954e955379fecfe5d4a6b4afc846fc5_1440w"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/net-img-v2-f954e955379fecfe5d4a6b4afc846fc5_1440w-20240422225053-oetu2xe.webp"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240422220949-9vhmjtx","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240422220949-9vhmjtx","updated":"20240422220949"},"Children":[{"Type":"NodeText","Data":"参考资料"}]},{"ID":"20240422220949-fudrd28","Type":"NodeBlockquote","Properties":{"id":"20240422220949-fudrd28","updated":"20240422220950"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240422220949-7nrekw0","Type":"NodeParagraph","Properties":{"id":"20240422220949-7nrekw0","updated":"20240422220949"},"Children":[{"Type":"NodeText","Data":"[1] Gooch, Amy, Bruce Gooch, Peter Shirley, and Elaine Cohen, \"A Non-Photorealistic Lighting Model for Automatic Technical Illustration,\" in"},{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"SIGGRAPH '98: Proceedings of the 25th Annual Conference on Computer Graphics and Interactive Techniques"},{"Type":"NodeText","Data":", ACM, pp. 447-452, July 1998.\n[2] Gooch, Bruce, Peter-Pike J. Sloan, Amy Gooch, Peter Shirley, and Richard Riesenfeld, \"Interactive Technical Illustration,\" in"},{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"Proceedings of the 1999 Symposium on Interactive 3D Graphics"},{"Type":"NodeText","Data":", ACM, pp. 31-38, 1999. "},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://link.zhihu.com/?target=http%3A//www.ppsloan.org/publications/iti99.pdf","TextMarkTextContent":"www.ppsloan.org/publications/iti99.pdf"},{"Type":"NodeText","Data":"\n[3]"},{"Type":"NodeTextMark","TextMarkType":"em a","TextMarkAHref":"https://link.zhihu.com/?target=https%3A//smile.amazon.com/Real-Time-Rendering-Fourth-Tomas-Akenine-M%25C3%25B6ller/dp/1138627003%3Ftag%3Drealtimerenderin","TextMarkTextContent":"Real-Time Rendering, Fourth Edition"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"5.1 Shading Models"}]}]}]}