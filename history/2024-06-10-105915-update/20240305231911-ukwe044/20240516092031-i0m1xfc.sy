{"ID":"20240516092031-i0m1xfc","Spec":"1","Type":"NodeDocument","Properties":{"id":"20240516092031-i0m1xfc","title":"Chapter9 基于物理的着色 Physically Based Shading","type":"doc","updated":"20240610105907"},"Children":[{"ID":"20240516092052-q6voa2q","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240516092052-q6voa2q","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.1 光的物理学"}]},{"ID":"20240516092118-u813r9k","Type":"NodeParagraph","Properties":{"id":"20240516092118-u813r9k","updated":"20240517090720"},"Children":[{"Type":"NodeText","Data":"光被认为是一种电磁横波（electromagnetic transverse wave），它使得电场（electric field）和磁场（magnetic field）在其传播方向的垂直面上来回振荡。"}]},{"ID":"20240517090728-l41uc5p","Type":"NodeParagraph","Properties":{"id":"20240517090728-l41uc5p","updated":"20240517090731"},"Children":[{"Type":"NodeText","Data":"电场和磁场的振荡是耦合的，二者的矢量相互垂直，并且长度之比也是固定的，这个比值等于相位速度（phase velocity）。"}]},{"ID":"20240517090737-yyuj3xv","Type":"NodeParagraph","Properties":{"id":"20240517090737-yyuj3xv","updated":"20240525124917"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block; width: 520px;","style":"width: 510px;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240517090737-qby6cuy.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.1：光是一种电磁横波。电场和磁场的矢量垂直于光线的传播方向，并以90度夹角相互振荡。本图中所展示的是最简单的光波，它是单色光（仅有一个固定的波长 λ ），并且是线性偏振的（电场和磁场各自沿着一条直线进行振荡）。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"width: 510px;\" parent-style=\"display: block; width: 520px;\"}"},{"Type":"NodeText","Data":"​​"}]},{"ID":"20240517094025-nnuyh36","Type":"NodeParagraph","Properties":{"id":"20240517094025-nnuyh36","updated":"20240517101144"},"Children":[{"Type":"NodeText","Data":"图9.1展示了一个简单的光波，事实上，这是最简单的一种，即一个完美的正弦函数。这个波只有一个波长（wavelength），使用希腊字母"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\lambda"},{"Type":"NodeText","Data":"进行表示。"}]},{"ID":"20240517101142-u0k9o5z","Type":"NodeParagraph","Properties":{"id":"20240517101142-u0k9o5z","updated":"20240517101158"},"Children":[{"Type":"NodeText","Data":"具有单一波长的光被称为单色光（monochromatic light）。然而在实践中所遇到的大多数光都是多色光（polychromatic light），即它们包含了许多不同的波长。"}]},{"ID":"20240517101224-3p3qhvt","Type":"NodeParagraph","Properties":{"id":"20240517101224-3p3qhvt","updated":"20240517101232"},"Children":[{"Type":"NodeText","Data":"之所以我们说图9.1所展示的光波是简单的，是因为它是"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"线性偏振"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"（linearly  polarized）的。这意味着"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"对于空间中的一个不动点，电场和磁场都沿着一条直线来回运动"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"；相比之下，在这本书中，我们所关注的是更加普遍的非偏振光（unpolarized light）。"}]},{"ID":"20240517101443-rcv7gwy","Type":"NodeParagraph","Properties":{"id":"20240517101443-rcv7gwy","updated":"20240525124832"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240517101443-o032p4x.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.2：左图展示了不同波长的可见光与一根蜘蛛丝，蜘蛛丝的长度略微超过1微米。右图是一根蜘蛛丝和一根人类头发的直径对比。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240517101454-3pptyqa","Type":"NodeParagraph","Properties":{"id":"20240517101454-3pptyqa","updated":"20240517101510"},"Children":[{"Type":"NodeText","Data":"光波会携带能量，这个能量流的强度等于电场强度和磁场强度的乘积，由于电场和磁场交替振荡，二者强度是成比例的，因此光线能量流的强度与电场强度的平方成正比。"}]},{"ID":"20240517101642-grvnsk9","Type":"NodeParagraph","Properties":{"id":"20240517101642-grvnsk9","updated":"20240517101642"},"Children":[{"Type":"NodeText","Data":"光波会以线性的方式进行叠加，总体波是各个分量波之和。"}]},{"ID":"20240517101712-sfgklmw","Type":"NodeBlockquote","Properties":{"id":"20240517101712-sfgklmw","updated":"20240517101716"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240517101713-9jnq4m2","Type":"NodeParagraph","Properties":{"id":"20240517101713-9jnq4m2","updated":"20240517101716"},"Children":[{"Type":"NodeText","Data":"然而，由于irradiance和振幅的平方成正比，这似乎导致了一个悖论，例如：将两个相同的光波进行叠加，会不会导致irradiance“1+1=4”的情况？由于irradiance描述的是能量流，这会不会违反能量守恒能量？对于这两个问题，前者的答案是“有时会”，而后者的答案则是“不会”。"}]}]},{"ID":"20240517101957-mw9kzkv","Type":"NodeParagraph","Properties":{"id":"20240517101957-mw9kzkv","updated":"20240525124759"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240517101957-t968sd4.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.3： n 个具有相同频率、相同偏振和相同振幅的单色光，它们以三种不同的方式进行叠加。从左到右分别是：`​相长干涉，相消干涉和不相干叠`​加 。每种情况的下面都展示了对应组合波的振幅和irradiance。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240517102015-tiw0na7","Type":"NodeParagraph","Properties":{"id":"20240517102015-tiw0na7","updated":"20240517102358"},"Children":[{"Type":"NodeText","Data":"当光波被发射出来之后，它们穿过空间，直到遇到一些可以相互作用的物质。"}]},{"ID":"20240517102404-phj7iaf","Type":"NodeParagraph","Properties":{"id":"20240517102404-phj7iaf","updated":"20240517102411"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"振荡的电场会推动和拉动物质中的电荷，使它们也依次发生振荡。振荡的电荷会发射出新的光波，这个过程会将入射光波的一些能量重新定向到新的方向。这个作用过程被称为散射（scattering）"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"，它是各种光学现象的基础。"}]},{"ID":"20240517102412-upyz45m","Type":"NodeParagraph","Properties":{"id":"20240517102412-upyz45m","updated":"20240517102720"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"散射出的光波与原始光波具有相同的频率"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。通常情况下，当原始光波包含多个频率的光波时，每个频率的光波都会单独与物质发生作用。"}]},{"ID":"20240517102718-4a4xlxa","Type":"NodeParagraph","Properties":{"id":"20240517102718-4a4xlxa","updated":"20240517102718"},"Children":[{"Type":"NodeText","Data":"一个孤立的分子会使光波向着各个方向进行散射，并使光的强度发生一些方向性的变化。但是更多的光线还是会沿着接近原始传播轴的方向进行散射，包括向前的方向或者向后的方向。"}]},{"ID":"20240517102721-aqx5q7k","Type":"NodeParagraph","Properties":{"id":"20240517102721-aqx5q7k","updated":"20240517102747"},"Children":[{"Type":"NodeText","Data":"分子作为散射体（scatterer）的有效性（分子附近的光波被散射的可能性），会随着波长的变化而发生很大的改变。"}]},{"ID":"20240517102755-1valj32","Type":"NodeParagraph","Properties":{"id":"20240517102755-1valj32","updated":"20240517102755"},"Children":[{"Type":"NodeText","Data":"在渲染中，我们主要关心的是包含许多分子的集合，光线在与这些聚集体发生相互作用的时候，其结果可能会与孤立分子的情况有所不同。"}]},{"ID":"20240517102811-6d89t0c","Type":"NodeParagraph","Properties":{"id":"20240517102811-6d89t0c","updated":"20240517102819"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"从附近分子散射出的光波通常是相干的，因此会相互干涉，因为它们大概率都具有相同的入射波"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240517102821-a61p6q2","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240517102821-a61p6q2","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.1.1 粒子"}]},{"ID":"20240517103318-slkofl2","Type":"NodeParagraph","Properties":{"id":"20240517103318-slkofl2","updated":"20240517103406"},"Children":[{"Type":"NodeText","Data":"在"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"理想气体（ideal gas）中，分子之间互不影响，即它们的相对位置是完全随机且不相关"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"的，虽然这是一种抽象概念，但是对于标准大气压下的空气而言，这是一个相当好的模型。在这种情况下，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"从不同分子散射出的波，其相位差异是随机且不断变化的，因此这些散射波是不相干的，其能量呈线性叠加"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"，如图9.3右侧所示。"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"即从n个分子散射出的总光能，是单分子散射的n倍"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240517103318-vit6zdg","Type":"NodeParagraph","Properties":{"id":"20240517103318-vit6zdg","updated":"20240517103615"},"Children":[{"Type":"NodeText","Data":"相反，如果分子紧密地排列在比光波长小得多的团簇（cluster）中，那么每个团簇中的散射光波都是同相位的，即会发生相长干涉，如图9.3左侧所示。即"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"从由n个分子组成的团簇散射出的总光强，是单分子散射的 "},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"n^2"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"  倍，也是相同数量分子在理想气体散射中的n倍"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。这种关系意味着，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"对于一种密度恒定的物质，将分子聚集成团簇，将会显著增加散射光的强度。在保持整体分子密度不变的情况下，增加每个团簇的大小，将会进一步增加散射光的强度，直到团簇的直径接近光的波长，当超过这个临界值的时候，额外增加团簇的大小将并不会进一步增加散射光的强度"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240517103545-qoczl8u","Type":"NodeBlockquote","Properties":{"id":"20240517103545-qoczl8u","updated":"20240517103630"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240517103625-fgbn6sy","Type":"NodeParagraph","Properties":{"id":"20240517103625-fgbn6sy","updated":"20240517103630"},"Children":[{"Type":"NodeText","Data":"这个过程解释了为什么云和雾的散射光是如此强烈。因为这两种现象都是由冷凝（condensation）产生的，所谓冷凝，是指空气中的水分子聚集成越来越大的团簇的过程。"}]}]},{"ID":"20240517103631-q99t0g4","Type":"NodeParagraph","Properties":{"id":"20240517103631-q99t0g4","updated":"20240517103748"},"Children":[{"Type":"NodeText","Data":"当我们在讨论光线散射的时候，粒子（particle）这个术语同时代表了孤立的分子与包含多个分子的团簇。"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"由于直径小于波长的多分子粒子散射，是孤立分子散射的增强版本（由于相长干涉），因此它会表现出相同的方向性变化和波长依赖性"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。这种类型的散射在"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"大气粒子中被称为瑞利散射（Rayleigh scattering），在固体中则被称为丁达尔散射（Tyndall scattering）"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240517103751-t22dju0","Type":"NodeParagraph","Properties":{"id":"20240517103751-t22dju0","updated":"20240517103832"},"Children":[{"Type":"NodeText","Data":"当粒子的大小超过光波长的时候，散射波在不再是同相的，这会改变散射的性质。散射光的方向越来越倾向于前向（即光波的原始传播方向），此时波长的依赖性会降低，直到所有的可见光波长都被均匀散射，这种类型的散射被称为米氏散射（Mie scattering）。（Ref: 14.1）"}]},{"ID":"20240517103834-pi582yt","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240517103834-pi582yt","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.1.2 介质"}]},{"ID":"20240517103843-ea44ytw","Type":"NodeParagraph","Properties":{"id":"20240517103843-ea44ytw","updated":"20240517104046"},"Children":[{"Type":"NodeText","Data":"光在均匀介质（homogeneous medium）中进行传播是另一种重要的情况，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"均匀介质是指一个充满均匀分布的相同分子的空间"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240517104047-88g3k3h","Type":"NodeParagraph","Properties":{"id":"20240517104047-88g3k3h","updated":"20240517104536"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"在均匀介质中"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"，散射波会整齐排列，除了沿着最初的传播方向之外，它们会在所有方向上都会产生相消干涉。当原始波与所有的单分子散射波结合之后，最终的结果与原始波基本相同，只有相位速度和振幅（在某些情况下）会有所不同。"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"最后叠加的结果并不会表现出任何散射现象，因为散射现象已经被相消干涉有效抑制了"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240517104532-ugia75n","Type":"NodeParagraph","Properties":{"id":"20240517104532-ugia75n","updated":"20240517105028"},"Children":[{"Type":"NodeText","Data":"原始波和新波的相位速度之比，决定了介质的光学特性，这被称为折射率（index of refraction，IOR），通常使用字母"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n"},{"Type":"NodeText","Data":"来进行表示。"}]},{"ID":"20240517105028-jp3g39m","Type":"NodeParagraph","Properties":{"id":"20240517105028-jp3g39m","updated":"20240527144133"},"Children":[{"Type":"NodeText","Data":"有些介质是具有吸收性的（absorptive），它们会将部分光能转换为热量，这会导致光波的振幅随着距离呈指数级下降，这个下降率由"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"衰减率"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"（attenuation index）定义，使用希腊字母"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\kappa (kappa)"},{"Type":"NodeText","Data":"来进行表示。"}]},{"ID":"20240527144112-qi5hu0t","Type":"NodeParagraph","Properties":{"id":"20240527144112-qi5hu0t","updated":"20240527144130"},"Children":[{"Type":"NodeText","Data":"n和"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\kappa"},{"Type":"NodeText","Data":"通常会随波长的变化而变化；这两个数字在一起，完整定义了一个介质会如何影响给定波长的光，它们通常被组合成一个复数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n+i\\kappa"},{"Type":"NodeText","Data":"，称为"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"复折射率"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"（complex index of refraction）。"}]},{"ID":"20240527144152-a0rm6mz","Type":"NodeParagraph","Properties":{"id":"20240527144152-a0rm6mz","updated":"20240527144158"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527144152-zucfjp4.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.5：四个装有不同吸收性质液体的小容器。从左到右分别是：纯净水，石榴汁，茶，咖啡。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240527144158-sban1w8","Type":"NodeParagraph","Properties":{"id":"20240527144158-sban1w8","updated":"20240527144209"},"Children":[{"Type":"NodeText","Data":"上图展示了一些光线吸收的例子。"}]},{"ID":"20240527144230-255xp06","Type":"NodeParagraph","Properties":{"id":"20240527144230-255xp06","updated":"20240527144308"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"非均匀介质通常可以建模为嵌有散射粒子的均匀介质"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240527144310-4d7x2a5","Type":"NodeBlockquote","Properties":{"id":"20240527144310-4d7x2a5","updated":"20240527144404"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240527144347-kaznywy","Type":"NodeParagraph","Properties":{"id":"20240527144347-kaznywy","updated":"20240527144356"},"Children":[{"Type":"NodeText","Data":"相消干涉抑制了均匀介质中的散射现象，这是由分子的均匀排列所引起的；非均匀介质中的粒子排列并不均匀，从而会导致它们产生散射光波。分子分布中的任何局部变化，都将打破相消干涉的模式，从而允许散射光波进行传播；这种局部变化可以是一个不同分子类型的分子团，或者是气隙、气泡、密度变化等；在任何情况下，它都会像前面讨论的粒子那样，对光波进行散射，其散射性质同样取决于分子团的大小。即使是气体也可以这样进行建模，在气体情况下，“散射粒子”是由分子持续运动所引起的瞬态密度涨落（transient density fluctuation）。这个模型可以为气体建立一个具有意义的折射率n，这有利于理解它们的光学性质。图9.6展示了几种光线散射的例子。"}]},{"ID":"20240527144400-znmqa5k","Type":"NodeParagraph","Properties":{"id":"20240527144400-znmqa5k","updated":"20240527144404"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527144400-kerbgnt.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.6：从左到右分别是：水，加了几滴牛奶的水，加了大约10%牛奶的水，全脂牛奶，乳白色玻璃。大多数牛奶的散射粒子都要比可见光的波长大，因此它的散射主要是无色的，在中间的图像上有明显的淡蓝色。在最右侧图像中，乳白色玻璃中的散射粒子要比可见光的波长小，因此蓝光的散射强度要比红光强；同时由于明暗背景的分割，透射光在左边更加明显，而散射光则在右边更加明显。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240527144405-4pjbz89","Type":"NodeParagraph","Properties":{"id":"20240527144405-4pjbz89","updated":"20240527144457"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"散射和吸收现象都与尺度有关"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。在小场景中不产生任何明显散射的介质，在较大的尺度上也可能会有相当明显的散射现象。"}]},{"ID":"20240527144457-mrj62x6","Type":"NodeBlockquote","Properties":{"id":"20240527144457-mrj62x6","updated":"20240527144515"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240527144458-s31ipt1","Type":"NodeParagraph","Properties":{"id":"20240527144458-s31ipt1","updated":"20240527144508"},"Children":[{"Type":"NodeText","Data":"例如：当在房间内观察一杯水时，光在空气中的散射与在水中的吸收是几乎不可见的；然而在一个较大尺度的环境中，这两种效果可能都会十分显著，如图9.7所示。"}]},{"ID":"20240527144511-4ugn67k","Type":"NodeParagraph","Properties":{"id":"20240527144511-4ugn67k","updated":"20240527144515"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527144511-15nknlz.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.7：左图中：在超过几米的范围内，水会对光产生强烈的吸收作用，尤其是红光，因此整体看起来会很蓝。右图中：光在没有严重空气污染或者雾的情况下，也会在数英里尺度的空气中发生散射。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240527144516-anizo54","Type":"NodeParagraph","Properties":{"id":"20240527144516-anizo54","updated":"20240527144535"},"Children":[{"Type":"NodeText","Data":"在一般情况下，介质的外观由散射作用和吸收作用的某种组合所决定，如图9.8所示。"}]},{"ID":"20240527144538-kiyztz8","Type":"NodeParagraph","Properties":{"id":"20240527144538-kiyztz8","updated":"20240527144542"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527144538-3cvtgjb.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.8：具有不同吸收作用和散射 作用 组合的液体容器。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240527144543-5kg9jt7","Type":"NodeParagraph","Properties":{"id":"20240527144543-5kg9jt7","updated":"20240527144853"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"散射的程度决定了灰暗的程度，较高的散射会产生不透明的外观"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。固体介质和液体介质中的粒子尺寸，往往大于光的波长，并且倾向于均匀散射所有可见波长的光，因此，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"物体的颜色通常都是由吸收作用的波长依赖性所引起的"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。而"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"介质的亮度则是由光线散射和光线吸收这两种现象共同作用的结果。特别是白色，它是高散射和低吸收结合的结果。"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"}]},{"ID":"20240527144825-78yyaoy","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240527144825-78yyaoy","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.1.3 表面"}]},{"ID":"20240527144905-iukqces","Type":"NodeParagraph","Properties":{"id":"20240527144905-iukqces","updated":"20240527144924"},"Children":[{"Type":"NodeText","Data":"从光学角度来看，物体的表面（surface）是一个二维界面，它分隔了具有不同折射率的空间体积。"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"在一般的渲染情况下，由空气组成的外部空间，其折射率约为1.003，为简单起见，通常假设空气的折射率为1"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"；而内部空间的折射率则取决于构成物体的物质。"}]},{"ID":"20240527144924-fr8w63l","Type":"NodeParagraph","Properties":{"id":"20240527144924-fr8w63l","updated":"20240527144950"},"Children":[{"Type":"NodeText","Data":"当光波遇到一个表面的时候，该表面的两个因素会对结果产生重要的影响：两侧的物质和表面的几何形状。"}]},{"ID":"20240527145525-t96owy7","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240527145525-t96owy7","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"两侧物质"}]},{"ID":"20240527144952-8hy4uiu","Type":"NodeParagraph","Properties":{"id":"20240527144952-8hy4uiu","updated":"20240527145534"},"Children":[{"Type":"NodeText","Data":"假设此时的表面几何形状是一个完美的平面。我们将“外部”（入射方向或者入射波产生的那一侧）折射率表示为 "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n_1 "},{"Type":"NodeText","Data":" ，将“内部”（光波通过该表面后将发生传播的一侧）折射率表示为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n_2"},{"Type":"NodeText","Data":"。则："}]},{"ID":"20240527145127-tpi3fqz","Type":"NodeParagraph","Properties":{"id":"20240527145127-tpi3fqz","updated":"20240527145532"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527145127-jwuo32q.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.9：一个光波撞击一个平面，平面两侧物质的折射率分别为 n1 和 n2 。左侧图展示了入射波的侧视图，这个入射波从左上角进入，红色的强度代表了波的相位。表面下方的波间距与 (n1/n2) 成正比，本例中为0.5。相位沿着表面排列，因此间距的变化会弯曲（折射）透射波的方向。图中三角形的构造展示了Snell定律的推导过程。为了清晰起见，右上方的图显示了反射波的情况，它与入射波具有相同的波间距，因此其方向与表面法线具有相同的夹角。右下方展示了入射波、透射波和反射波方向的矢量图。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240527145301-9aqlsln","Type":"NodeParagraph","Properties":{"id":"20240527145301-9aqlsln","updated":"20240527145532"},"Children":[{"Type":"NodeText","Data":"反射波和入射波的方向，与表面法线之间具有相同的夹角"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_i"},{"Type":"NodeText","Data":"；透射波的方向会以"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_t"},{"Type":"NodeText","Data":"的角度进行弯曲（折射），它与"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{i}"},{"Type":"NodeText","Data":"的关系如下："}]},{"ID":"20240527145333-7a4kqhf","Type":"NodeMathBlock","Properties":{"id":"20240527145333-7a4kqhf","updated":"20240527145532"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\sin \\left(\\theta_{t}\\right)=\\frac{n_{1}}{n_{2}} \\sin \\left(\\theta_{i}\\right).\n\\tag{9.1}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240527145349-sek016k","Type":"NodeParagraph","Properties":{"id":"20240527145349-sek016k","updated":"20240527145532"},"Children":[{"Type":"NodeText","Data":"这个折射方程被称为Snell定律（折射定律），它被用于全局折射效应。"}]},{"ID":"20240527145232-51g1rzv","Type":"NodeParagraph","Properties":{"id":"20240527145232-51g1rzv","updated":"20240527145629"},"Children":[{"Type":"NodeText","Data":"折射也会发生在不透明物体的表面上。当不透明物体发生折射时，光会在物体内部进行散射和吸收。光会与物体的介质相互作用。"}]},{"ID":"20240527145629-fg1223i","Type":"NodeBlockquote","Properties":{"id":"20240527145629-fg1223i","updated":"20240527145638"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240527145631-hfqqqt3","Type":"NodeParagraph","Properties":{"id":"20240527145631-hfqqqt3","updated":"20240527145638"},"Children":[{"Type":"NodeText","Data":"对于金属而言，其内部包含了许多自由电子（不与分子结合的电子），它们会“吸收”折射光的能量，并将其重定向到反射波中，这就是为什么金属会具有较高的吸收率和较高的反射率的原因。"}]}]},{"ID":"20240527145641-dku8b88","Type":"NodeParagraph","Properties":{"id":"20240527145641-dku8b88","updated":"20240527145848"},"Children":[{"Type":"NodeText","Data":"上面讨论的表面折射现象需要折射率在小于单一波长的距离上发生突变，折射率的逐渐变化不会对光进行散射，而是会导致光路弯曲。"}]},{"ID":"20240527145857-q5pjm0z","Type":"NodeBlockquote","Properties":{"id":"20240527145857-q5pjm0z","updated":"20240610104455"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240527145858-xini6lf","Type":"NodeParagraph","Properties":{"id":"20240527145858-xini6lf","updated":"20240610104455"},"Children":[{"Type":"NodeText","Data":"就像折射时出现的不连续弯曲一样；"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"当空气密度因温度不同而发生变化的时在这个NDF发表3年后，G_2函数的解决方案才得以发表[355]候"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"，可以看到这种效应，例如海市蜃楼（mirage）和热变形（heat distortion，也叫做热浪）"}]},{"ID":"20240527145922-s8z89uw","Type":"NodeParagraph","Properties":{"id":"20240527145922-s8z89uw","updated":"20240527145925"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527145922-39nq3sv.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.10：一个由于折射率逐渐变化而导致光路弯曲的例子，图中所展示的情况是由温度变化引起的。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240527145916-0vu2nyo","Type":"NodeParagraph","Properties":{"id":"20240527145916-0vu2nyo","updated":"20240527145938"},"Children":[{"Type":"NodeText","Data":"即使是一个具有明确边界的物体，如果它被浸没在一个具有相同折射率的物质中，那么也将没有可见的表面。因为在没有折射率变化的情况下，就不会发生反射现象和折射现象。如下图"}]},{"ID":"20240527145943-a0uavdj","Type":"NodeParagraph","Properties":{"id":"20240527145943-a0uavdj","updated":"20240527145948"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527145943-bqxjc7v.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.11：玻璃杯里有很多装饰珠子，它的折射率与水的折射率是一样的。在水面以上，由于珠子的折射率与空气的折射率不同，因此有一个明显可见的表面。在水面以下，由于珠子表面两侧的折射率是相同的，因此这些表面是不可见的。由于这些珠子会吸收特定波长的光，因此我们能够看到这些珠子本身，并且它们会表现出不同的颜色。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240527145949-x8168f4","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240527145949-x8168f4","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"几何形状"}]},{"ID":"20240527150017-io58d0y","Type":"NodeParagraph","Properties":{"id":"20240527150017-io58d0y","updated":"20240527150129"},"Children":[{"Type":"NodeText","Data":"比波长小得多的不规则表面，对光的行为没有影响；而比波长大得多的不规则表面，虽然会使这个表面在宏观上看起来变得倾斜，但是并不会影响其微观局部的平坦性。"}]},{"ID":"20240527150134-l465pni","Type":"NodeParagraph","Properties":{"id":"20240527150134-l465pni","updated":"20240527150147"},"Children":[{"Type":"NodeText","Data":"只有位于1-100个波长范围内的不规则表面，才会导致这个表面与平面具有不同的外观表现，这种现象被称为"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"衍射"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"现象（diffraction）。"}]},{"ID":"20240527150242-r38x4vc","Type":"NodeParagraph","Properties":{"id":"20240527150242-r38x4vc","updated":"20240527150242"},"Children":[{"Type":"NodeText","Data":"在渲染中，我们通常会基于几何光学（geometrical optics），它忽略了光作为一种波所产生的效应，例如干涉和衍射。"}]},{"ID":"20240527150246-p3hq1fq","Type":"NodeBlockquote","Properties":{"id":"20240527150246-p3hq1fq","updated":"20240527150247"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240527150247-8q5ofqt","Type":"NodeParagraph","Properties":{"id":"20240527150247-8q5ofqt","updated":"20240527150247"},"Children":[{"Type":"NodeText","Data":"这相当于假设所有表面的不规则性，要么小于光的波长，要么比光的波长大得多（100倍以上）。"}]}]},{"ID":"20240527150248-l5e5amy","Type":"NodeParagraph","Properties":{"id":"20240527150248-l5e5amy","updated":"20240527150341"},"Children":[{"Type":"NodeText","Data":"在几何光学中，光会被建模为一条射线，而不是一种波，当一条射线与表面相交时，相交点的局部区域会被视为一个平面。从这里开始到9.11都会在几何光学领域进行讨论。"}]},{"ID":"20240527150410-rpzre6f","Type":"NodeParagraph","Properties":{"id":"20240527150410-rpzre6f","updated":"20240527150418"},"Children":[{"Type":"NodeText","Data":"比波长大得多的表面不规则性，会改变表面的局部朝向。当这些不规则性太小以致于无法进行渲染的时候（小于一个像素），我们则将其称为"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"微观几何图形"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"（microgeometry，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"微表面"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"）；表面的反射方向和折射方向取决于该表面的法线，而这些微表面会改变表面上不同点处的法线，从而改变光线的反射方向和折射方向。"}]},{"ID":"20240527150454-qoji683","Type":"NodeParagraph","Properties":{"id":"20240527150454-qoji683","updated":"20240527150552"},"Children":[{"Type":"NodeText","Data":"不规则表面上每一个点都只会在一个方向上反射光线，但是屏幕上每个像素都覆盖了许多点，因此这个表面的外观是由所有不同反射方向的光线的聚合结果决定的。"}]},{"ID":"20240527150557-bnqmkme","Type":"NodeParagraph","Properties":{"id":"20240527150557-bnqmkme","updated":"20240527150606"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527150557-o62ik2d.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.12：左侧展示了两个表面的照片，右侧使用示意图的形式，展示了它们所对应的微观几何结构。上方的表面拥有略微粗糙的微观几何形状，入射光线击中了表面上不同的点，每个点的法线方向略有差异，并在一个狭窄的锥形方向上被反射，其宏观效果是具有轻微模糊的反射。下方表面具有更加粗糙的微观几何形状，入射光线照射到的表面点，具有明显不同的法线方向，反射光线会以一个较宽的锥体进行扩散，从而导致宏观的反射效果变得更加模糊。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240527150607-a9migpd","Type":"NodeParagraph","Properties":{"id":"20240527150607-a9migpd","updated":"20240527150630"},"Children":[{"Type":"NodeText","Data":"在渲染中，我们并不会对微观几何形状进行明确的建模，而是会以一种统计的方式对其进行处理，将该表面视为一个具有微观结构法线的随机分布。"}]},{"ID":"20240527150648-qgijg2m","Type":"NodeParagraph","Properties":{"id":"20240527150648-qgijg2m","updated":"20240527150744"},"Children":[{"Type":"NodeText","Data":"因此，我们将表面建模为，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5); background-color: var(--b3-card-error-background);"},"TextMarkType":"text","TextMarkTextContent":"会在一个连续方向上（译者注：一定的立体角范围内），对光线进行反射和折射。其中这个连续方向的宽度（锥形范围的大小，或者是立体角的大小），以及反射细节和折射细节的模糊程度，取决于微观几何法线的统计方差，即表面微尺度的粗糙度"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5); background-color: var(--b3-card-error-background);\"}"},{"Type":"NodeText","Data":"（roughness）。"}]},{"ID":"20240527150854-2gw8l2b","Type":"NodeParagraph","Properties":{"id":"20240527150854-2gw8l2b","updated":"20240527150900"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527150854-tf0z0rn.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.13：从宏观上看，表面可以被视为在多个方向上，对光线进行反射和折射。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240527150901-233eq8h","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240527150901-233eq8h","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.1.4 次表面散射"}]},{"ID":"20240527150910-2z63dan","Type":"NodeParagraph","Properties":{"id":"20240527150910-2z63dan","updated":"20240527150959"},"Children":[{"Type":"NodeText","Data":"进入物体内部的折射光线，会继续与内部物质发生相互作用。"}]},{"ID":"20240527151001-srexh3m","Type":"NodeBlockquote","Properties":{"id":"20240527151001-srexh3m","updated":"20240527151009"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240527151001-voffshm","Type":"NodeParagraph","Properties":{"id":"20240527151001-voffshm","updated":"20240527151009"},"Children":[{"Type":"NodeText","Data":"前面我们提到，金属具有较高的吸收率和较高的反射率，即金属表面会反射大部分的入射光线，进入金属内部的折射光线也会被迅速吸收；相比之下，非金属物体则会表现出广泛的散射行为和吸收行为，这与我们在图9.8中所看到的液体容器类似。"}]}]},{"ID":"20240527151010-pcxy6tr","Type":"NodeParagraph","Properties":{"id":"20240527151010-pcxy6tr","updated":"20240527151034"},"Children":[{"Type":"NodeText","Data":"透明材料具有低散射和低吸收的特性，进入物体内部的任何折射光线，最终都会从物体中折射出来。关于透明物体的折射问题，Ref 14.5.2"}]},{"ID":"20240527151035-0p3fqy4","Type":"NodeParagraph","Properties":{"id":"20240527151035-0p3fqy4","updated":"20240527151049"},"Children":[{"Type":"NodeText","Data":"透射光线在经历多次散射和吸收之后，最终有一部分会从表面重新发射出来，并被人眼观察到，如下图"}]},{"ID":"20240527151052-xni38uo","Type":"NodeParagraph","Properties":{"id":"20240527151052-xni38uo","updated":"20240527151057"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527151052-a5bkxhg.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.14：折射光线在穿过物体时会被吸收。在这个例子中，大部分被吸收的都是波长较长的光线，留下的主要是波长较短的蓝光。另外，光线还会在物体内部的粒子中发生散射，最终有一些折射光线会散射出表面，例如图中以不同方向离开表面的蓝色箭头。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240527151058-axxbip7","Type":"NodeParagraph","Properties":{"id":"20240527151058-axxbip7","updated":"20240527151216"},"Children":[{"Type":"NodeText","Data":"这种"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"次表面散射（subsurface scatter）的光线，会以相对于入射点的不同距离从表面射出"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"，这个进出距离（entry-exit distances）的分布取决于材料中散射粒子的密度和性质，这些距离与着色尺度（像素的大小，以及着色样本之间的距离）之间的关系是很重要的。"}]},{"ID":"20240527151248-7m7q6bf","Type":"NodeParagraph","Properties":{"id":"20240527151248-7m7q6bf","updated":"20240527151306"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"如果这个进出距离比着色尺度要小，那么可以假定它们为零"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"，这样我们就可以将次表面散射与表面反射整合到同一个局部着色模型中，即"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"某个着色点上的出射光线，只依赖于该点的入射光线"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240527151302-suopcsv","Type":"NodeParagraph","Properties":{"id":"20240527151302-suopcsv","updated":"20240527151312"},"Children":[{"Type":"NodeText","Data":"由于次表面散射与表面反射具有明显不同的外观表现，因此可以很容易地将它们划分为单独的着色选项，"}]},{"ID":"20240527151314-g61ocez","Type":"NodeList","ListData":{},"Properties":{"id":"20240527151314-g61ocez","updated":"20240527151316"},"Children":[{"ID":"20240527151316-t024go0","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240527151316-t024go0","updated":"20240527151316"},"Children":[{"ID":"20240527151316-t26ixhh","Type":"NodeParagraph","Properties":{"id":"20240527151316-t26ixhh","updated":"20240527151316"},"Children":[{"Type":"NodeText","Data":"使用镜面项（specular term）控制表面反射现象，"}]}]},{"ID":"20240527151318-655jxqt","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240527151318-655jxqt"},"Children":[{"ID":"20240527151318-bc3olsu","Type":"NodeParagraph","Properties":{"id":"20240527151318-bc3olsu"},"Children":[{"Type":"NodeText","Data":"使用漫反射项（diffuse term）控制局部次表面散射（local subsurface scattering）现象。"}]}]}]},{"ID":"20240527151320-939lj2w","Type":"NodeParagraph","Properties":{"id":"20240527151320-939lj2w","updated":"20240527151351"},"Children":[{"Type":"NodeText","Data":"如果这个进出距离比着色尺度要大，那么就需要专门的渲染技术，来表现光线在某一点进入表面，并从另一点离开表面的视觉效果。Ref 14.6： 全局次表面散射"}]},{"ID":"20240527151359-xezkoah","Type":"NodeParagraph","Properties":{"id":"20240527151359-xezkoah","updated":"20240527151406"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527151359-gzcgysu.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.15：左图中，我们渲染了一个具有次表面散射的材质，图中的黄色圆圈和紫色圆圈代表了两种不同大小的采样区域。其中黄色圆圈代表了单个着色样本所覆盖的区域，大于次表面散射的距离，因此我们可以在渲染中忽略这些距离所带来的影响，并在局部着色模型中将次表面散射项视为漫反射项，如右图所示。如果我们向着靠近表面的方向进行移动，单个着色样本所覆盖的区域会变小，如左图中的紫色圆圈，与着色样本所覆盖的区域相比，此时次表面散射的距离很大，无法忽视这些距离所带来的影响，因此需要使用全局的着色模型和光照技术，来从这些着色样本中生成逼真的图像。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240527151406-3n6rfrk","Type":"NodeParagraph","Properties":{"id":"20240527151406-3n6rfrk","updated":"20240527151458"},"Children":[{"Type":"NodeText","Data":"值得注意的是，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"局部次表面散射技术和全局次表面散射技术模拟的是完全相同的物理现象"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。每种情况下的最佳选择（即到底使用哪种模型和技术），"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"不仅取决于材质的属性，还取决于观察的尺度"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240527151459-x4432w4","Type":"NodeBlockquote","Properties":{"id":"20240527151459-x4432w4","updated":"20240527151530"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240527151524-v39obq6","Type":"NodeParagraph","Properties":{"id":"20240527151524-v39obq6","updated":"20240527151530"},"Children":[{"Type":"NodeText","Data":"当渲染一个孩子在玩塑料玩具的场景时，我们很可能需要使用全局次表面散射技术来准确地渲染孩子的皮肤，而对于塑料玩具而言，可能一个局部的漫反射着色模型就足够了。这是因为皮肤中的散射距离，要比在塑料中的散射距离大得多，但是如果相机足够远的话，皮肤的散射距离也可能会小于一个像素，此时局部的着色模型对于儿童和玩具而言都是十分准确的。相反，在一个极端的特写镜头中，塑料也可能会表现出明显的非局部次表面散射现象，这时候就需要全局次表面散射技术来对玩具进行准确地渲染。"}]}]},{"ID":"20240527151533-iouzyt3","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240527151533-iouzyt3","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.2 相机"}]},{"ID":"20240527151537-mro2746","Type":"NodeParagraph","Properties":{"id":"20240527151537-mro2746","updated":"20240527151820"},"Children":[{"Type":"NodeText","Data":"在渲染的时候，我们会计算从表面着色点到相机位置的radiance。这模拟了一个简化了的成像系统，例如胶片相机、数码相机或者人眼。这些成像系统量化记录了单挑光线的亮度和颜色。"}]},{"ID":"20240527151833-kfke4cz","Type":"NodeParagraph","Properties":{"id":"20240527151833-kfke4cz","updated":"20240527151840"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527151833-dg5rn1u.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.16：每个相机成像模型中都包含了一个像素传感器阵列。图中的每根实线，都代表了传感器从场景中收集到的一组光线。每个子图中的窗口图像，展示了像素传感器上的单点样本所收集的光线。第一行图片展示了一个针孔相机模型；第二行图片展示了一个典型的渲染系统模型，即一个带有相机点 c 的针孔相机；第三行图片展示了一个更加物理正确的镜头相机，其焦点位于红色球体上，另外两个球体并不在焦点上。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240527151841-rd94gce","Type":"NodeParagraph","Properties":{"id":"20240527151841-rd94gce","updated":"20240527152333"},"Children":[{"Type":"NodeText","Data":"在渲染时，每个着色样本都对应了一条光线，即对应于传感器表面上的一个采样点。而抗锯齿的过程（章节5.4）则可以理解为，对每个离散传感器表面收集到的信号进行重建。然而，由于图形渲染并不会受到物理传感器的限制，因此我们可以对这个过程进行更加一般化的处理，即从离散的着色样本中，重建出连续的图像信号。"}]},{"ID":"20240527152551-v9d5d1o","Type":"NodeParagraph","Properties":{"id":"20240527152551-v9d5d1o","updated":"20240527152647"},"Children":[{"Type":"NodeText","Data":"对于大多数实践中所使用的相机，以及人眼来说，针孔相机都是一个糟糕的模型，其实用价值并不高。上图第三行展示了使用镜头的成像系统，这个模型中包含了一个镜头，这允许相机使用一个更大的光圈，大大增加了成像传感器所收集的光量。但是这也会导致相机的景深（depth of field）是有限的。太近或太远的物体都会被模糊。"}]},{"ID":"20240527152704-zgczp2i","Type":"NodeParagraph","Properties":{"id":"20240527152704-zgczp2i","updated":"20240527152705"},"Children":[{"Type":"NodeText","Data":"镜头除了会限制景深之外，还有一些其他的影响。传感器上的每个点（包括完美聚焦的点）都会接收一个锥形区域内的光线；而在理想化的模型中，每个着色样本都只会对应唯一的观察射线，这样处理有时候会引入数学奇异点（即无法定义的点）、数值不稳定性或者视觉瑕疵。"}]},{"ID":"20240527152707-j4cmayc","Type":"NodeParagraph","Properties":{"id":"20240527152707-j4cmayc","updated":"20240527152711"},"Children":[{"Type":"NodeText","Data":"当我们在渲染图像的时候，将真实的物理模型牢记于心，有助于我们识别和解决这些问题。"}]},{"ID":"20240527152713-it3rrai","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240527152713-it3rrai","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.3 The BRDF"}]},{"ID":"20240527152717-nci1jeo","Type":"NodeParagraph","Properties":{"id":"20240527152717-nci1jeo","updated":"20240527152736"},"Children":[{"Type":"NodeText","Data":"最终，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"基于物理的渲染可以归结为沿着一组观察射线，计算进入相机的radiance"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240527152737-6dbpvaf","Type":"NodeParagraph","Properties":{"id":"20240527152737-6dbpvaf","updated":"20240609101103"},"Children":[{"Type":"NodeText","Data":"对于一个给定的观察射线，我们需要计算的是"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"L_{i}(\\mathbf{c},-\\mathbf{v})"},{"Type":"NodeText","Data":"，其中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{c}"},{"Type":"NodeText","Data":"是相机的位置，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"-\\mathbf{v}"},{"Type":"NodeText","Data":"是沿着观察射线的方向。"}]},{"ID":"20240527152917-bml219n","Type":"NodeParagraph","Properties":{"id":"20240527152917-bml219n","updated":"20240527152917"},"Children":[{"Type":"NodeText","Data":"这里我们使用"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"-\\mathbf{v}"},{"Type":"NodeText","Data":"是由于两个符号约定："}]},{"ID":"20240527152919-lplymjp","Type":"NodeList","ListData":{},"Properties":{"id":"20240527152919-lplymjp","updated":"20240527152920"},"Children":[{"ID":"20240527152920-cqsxfpj","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240527152920-cqsxfpj","updated":"20240527152920"},"Children":[{"ID":"20240527152920-5t53pyn","Type":"NodeParagraph","Properties":{"id":"20240527152920-5t53pyn","updated":"20240527152920"},"Children":[{"Type":"NodeText","Data":"第一，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"L_{i}()"},{"Type":"NodeText","Data":"中的方向向量，总是指向远离给定点的方向，在这里就是指向远离相机位置的方向。"}]}]},{"ID":"20240527152922-4w0uceb","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240527152922-4w0uceb"},"Children":[{"ID":"20240527152922-5hhria8","Type":"NodeParagraph","Properties":{"id":"20240527152922-5hhria8"},"Children":[{"Type":"NodeText","Data":"第二，观察向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeText","Data":"总是会指向相机。"}]}]}]},{"ID":"20240527152908-0492ihk","Type":"NodeParagraph","Properties":{"id":"20240527152908-0492ihk","updated":"20240527153047"},"Children":[{"Type":"NodeText","Data":"在渲染中，场景通常会被建模为彼此之间具有介质的物体集合（“介质”一词实际上来自于拉丁语，它的意思是“在中间”）。"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"通常我们所讨论的介质是适量且相对干净的空气，它并不会对光线的radiance产生明显地影响，因此在渲染中可以被忽略"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。对光线的radiance产生影响的介质称为"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"参与介质"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"，Ref 14"}]},{"ID":"20240527153015-xaobhk3","Type":"NodeParagraph","Properties":{"id":"20240527153015-xaobhk3","updated":"20240527153130"},"Children":[{"Type":"NodeText","Data":"假设没有参与介质的存在，因此"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"进入相机的radiance与其观察方向上离开最近物体表明的radiance是相等的"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240527153130-o3z520e","Type":"NodeMathBlock","Properties":{"id":"20240527153130-o3z520e","updated":"20240527153137"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"L_{i}(\\mathbf{c},-\\mathbf{v})=L_{o}(\\mathbf{p}, \\mathbf{v})\n\\tag{9.2}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240527153137-70h6slm","Type":"NodeParagraph","Properties":{"id":"20240527153137-70h6slm","updated":"20240527153153"},"Children":[{"Type":"NodeText","Data":"其中，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{p}"},{"Type":"NodeText","Data":"是观察射线与最近物体表面的交点。"}]},{"ID":"20240527153152-76hzx3g","Type":"NodeParagraph","Properties":{"id":"20240527153152-76hzx3g","updated":"20240609102050"},"Children":[{"Type":"NodeText","Data":"现在我们的新目标变成了计算"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"L_{o}(\\mathbf{p}, \\mathbf{v})"},{"Type":"NodeText","Data":"，这里我们不考虑透明物体和全局次表面散射，这里关注的是局部反射现象，它将照射到当前着色点的光线，重新发射回外部，这些现象包括表面反射以及局部次表面散射，它们只依赖于入射光方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"和指向外部的观察方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeText","Data":"。"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"双向反射分布函数"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"（bidirectional reflectance distribution function，BRDF）"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"描述了着色点表面的局部反射系数"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"，记为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"f(\\mathbf{l}, \\mathbf{v})"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240609102041-064eyri","Type":"NodeParagraph","Properties":{"id":"20240609102041-064eyri","updated":"20240609102305"},"Children":[{"Type":"NodeText","Data":"更详细介绍"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"f(\\mathbf{l}, \\mathbf{v})"},{"Type":"NodeText","Data":"的文章："},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240609101901-t6e7t22","TextMarkBlockRefSubtype":"d","TextMarkTextContent":"基于物理着色：BRDF"}]},{"ID":"20240609102103-c8q2ze3","Type":"NodeBlockquote","Properties":{"id":"20240609102103-c8q2ze3","updated":"20240609102346"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240609102104-1nyzcze","Type":"NodeParagraph","Properties":{"id":"20240609102104-1nyzcze","updated":"20240609102108"},"Children":[{"Type":"NodeText","Data":"这篇文章表示"}]},{"ID":"20240609102254-6fxyf32","Type":"NodeParagraph","Properties":{"id":"20240609102254-6fxyf32","updated":"20240609102254"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240609102251-4m2omf6.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240609102257-h0cl5hb","Type":"NodeParagraph","Properties":{"id":"20240609102257-h0cl5hb","updated":"20240609102346"},"Children":[{"Type":"NodeText","Data":"简单理解即"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"f(\\mathbf{l}, \\mathbf{v})"},{"Type":"NodeText","Data":"是入射光l向实现方向v射出的能量。"}]}]},{"ID":"20240527153422-8oubde0","Type":"NodeParagraph","Properties":{"id":"20240527153422-8oubde0","updated":"20240609102308"},"Children":[{"Type":"NodeText","Data":"在原始推导中，BRDF是针对均匀表面进行定义的。也就是说，我们会"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"假设表面上各处的BRDF都是相同的"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240527153636-p28q3jz","Type":"NodeBlockquote","Properties":{"id":"20240527153636-p28q3jz","updated":"20240527153659"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240527153645-pl3issi","Type":"NodeParagraph","Properties":{"id":"20240527153645-pl3issi","updated":"20240527153659"},"Children":[{"Type":"NodeText","Data":"然而，对于现实世界中的物体（以及渲染场景中的物体）而言，很少会有表面具有完全相同的材质属性。即使是由单一材料组成的物体（例如银质雕像），其表面上也会有划痕、暗斑、污渍或者其他的一些变化，从而导致两个不同的着色点具有不同的视觉特性。从技术上来讲，根据空间位置捕获BRDF变化的函数，被称为空间变化的BRDF（spatially varying BRDF，SVBRDF）或者空间BRDF（spatial BRDF，SBRDF）。然而，这种情况在实践中非常普遍，因此通常还是会使用BRDF这个较短的术语来进行描述，我们会默认假定BRDF与表面位置有关。"}]}]},{"ID":"20240527153700-6ezjcvu","Type":"NodeParagraph","Properties":{"id":"20240527153700-6ezjcvu","updated":"20240527153809"},"Children":[{"Type":"NodeText","Data":"光线的入射方向和出射方向各有两个自由度。一种常用的参数化表示包括两个角度：相对于表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"的仰角"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta"},{"Type":"NodeText","Data":"，以及相对于表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"的方位角（即水平旋转）"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi"},{"Type":"NodeText","Data":"。在一般情况下，BRDF是一个包含四个标量变量的函数"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"。"}]},{"ID":"20240527153800-voo9u56","Type":"NodeParagraph","Properties":{"id":"20240527153800-voo9u56","updated":"20240527153830"},"Children":[{"Type":"NodeText","Data":"各向同性（Isotropic）BRDF是一个重要的特例，当光线入射方向和出射方向围绕表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"旋转的时候，各项同性BRDF会保持不变，并保持它们之间的相对角度不变。"}]},{"ID":"20240527153907-ao2g9pl","Type":"NodeList","ListData":{},"Properties":{"id":"20240527153907-ao2g9pl","updated":"20240527153925"},"Children":[{"ID":"20240527153908-52i6png","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240527153908-52i6png","updated":"20240527153925"},"Children":[{"ID":"20240527153917-b0kdezh","Type":"NodeParagraph","Properties":{"id":"20240527153917-b0kdezh","updated":"20240527153931"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240527153917-8uwz1pv.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240527153922-6nddflr","Type":"NodeParagraph","Properties":{"id":"20240527153922-6nddflr","style":"text-align: center;","updated":"20240527153925"},"Children":[{"Type":"NodeText","Data":"图9.17：BRDF输入参数。方位角 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi _i"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":" 和"},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":" \\phi_o"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":" 都是相对于给定切向量 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{t}"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":" 定义的。而在各向同性BRDF中，我们只需要考虑相对方位角 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":" 即可，不需要考虑参考切向量与"},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":" \\phi _i"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":" 、 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi_o"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":" 。"}]}]}]},{"ID":"20240527153853-4hwj3t3","Type":"NodeParagraph","Properties":{"id":"20240527153853-4hwj3t3","updated":"20240527154213"},"Children":[{"Type":"NodeText","Data":"各向同性BRDF是一个包含三个标量变量的函数，因为我们只需要光线绕表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"的旋转角度，或者相机的旋转角度"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi"},{"Type":"NodeText","Data":"即可。也就是说，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"如果将一个具有均匀各向同性材质的物体放置在转盘上，并旋转它的话，在给定的光线和相机条件下，这个物体表面在所有旋转角度上看起来都是相同的"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240527154215-y29puhs","Type":"NodeParagraph","Properties":{"id":"20240527154215-y29puhs","updated":"20240527154314"},"Children":[{"Type":"NodeText","Data":"由于这里忽略了荧光（fluorescence）和磷光（phosphorescence）现象，因此可以假设给定波长的入射光会以相同的波长反射出来。"}]},{"ID":"20240527154323-6w44d65","Type":"NodeParagraph","Properties":{"id":"20240527154323-6w44d65","updated":"20240527154328"},"Children":[{"Type":"NodeText","Data":"反射光的光量会根据其波长发生变化，可以使用以下两种方法来进行模拟："}]},{"ID":"20240527154329-g0rotfh","Type":"NodeList","ListData":{},"Properties":{"id":"20240527154329-g0rotfh","updated":"20240527154344"},"Children":[{"ID":"20240527154330-xdf4qoq","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240527154330-xdf4qoq","updated":"20240527154344"},"Children":[{"ID":"20240527154330-2j9q3ka","Type":"NodeParagraph","Properties":{"id":"20240527154330-2j9q3ka","updated":"20240527154344"},"Children":[{"Type":"NodeText","Data":"第一种是将波长视为BRDF的额外输入变量。"}]}]},{"ID":"20240527154337-6ifys2r","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240527154337-6ifys2r","updated":"20240527154343"},"Children":[{"ID":"20240527154337-vs2t23b","Type":"NodeParagraph","Properties":{"id":"20240527154337-vs2t23b","updated":"20240527154343"},"Children":[{"Type":"NodeText","Data":"第二种则是将BRDF视为会返回一个光谱分布的值。"}]}]}]},{"ID":"20240527154346-u6xc4x2","Type":"NodeParagraph","Properties":{"id":"20240527154346-u6xc4x2","updated":"20240527154453"},"Children":[{"Type":"NodeText","Data":"第一种可能用于离线渲染，实时渲染总会使用第二种。由于实时渲染器一般将光谱分布表示为一个RGB三元组，意味着BRDF会返回一个RGB值。"}]},{"ID":"20240527154453-esq8tq8","Type":"NodeParagraph","Properties":{"id":"20240527154453-esq8tq8","updated":"20240527154522"},"Children":[{"Type":"NodeText","Data":"将BRDF项合并到反射方程："}]},{"ID":"20240527154523-nox37rm","Type":"NodeMathBlock","Properties":{"id":"20240527154523-nox37rm","updated":"20240527154529"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"L_{o}(\\mathbf{p}, \\mathbf{v})=\\int_{\\mathbf{l} \\in \\Omega} f(\\mathbf{l}, \\mathbf{v}) L_{i}(\\mathbf{p}, \\mathbf{l})(\\mathbf{n} \\cdot \\mathbf{l}) d \\mathbf{l}\n\\tag{9.3}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240527154529-wf7mygv","Type":"NodeParagraph","Properties":{"id":"20240527154529-wf7mygv","updated":"20240527154914"},"Children":[{"Type":"NodeText","Data":"积分符号的下标"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l} \\in \\Omega"},{"Type":"NodeText","Data":"意味着是，我们对位于表面单位半球（以着色点为球心，以表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"为半球方向）上的入射光方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"进行积分。"}]},{"ID":"20240527154904-y79fvfi","Type":"NodeParagraph","Properties":{"id":"20240527154904-y79fvfi","updated":"20240527154956"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"请注意，入射光方向"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"会在半球范围内进行连续扫描，也就是说，它并不是某个特定的“光线方向”。"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"这个想法的核心是："},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"来自任何入射方向的光线，都会（通常会）产生一些radiance"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。我们用"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"d\\mathbf{l}"},{"Type":"NodeText","Data":"来表示入射光方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"周围单位立体角的微分（有关立体角的内容在章节8.1.1讨论过）。"}]},{"ID":"20240527154945-bxapec0","Type":"NodeParagraph","Properties":{"id":"20240527154945-bxapec0","updated":"20240527155148"},"Children":[{"Type":"NodeText","Data":"总而言之，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"反射方程表明，出射的radiance等于入射radiance乘以BRDF项，再乘以表面法线"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"和入射光方向"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"点积的积分（其中入射光方向"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"来自半球范围"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\Omega"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"）"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240527155132-v5o8xoj","Type":"NodeParagraph","Properties":{"id":"20240527155132-v5o8xoj","updated":"20240528170847"},"Children":[{"Type":"NodeText","Data":"后面我们省略从"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"L_i()"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"L_o()"},{"Type":"NodeText","Data":"和反射方程中省略表面着色点"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{p}"},{"Type":"NodeText","Data":"，即"}]},{"ID":"20240528170848-d6zmrcr","Type":"NodeMathBlock","Properties":{"id":"20240528170848-d6zmrcr","updated":"20240528170855"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"L_{o}(\\mathbf{v})=\\int_{\\mathbf{l} \\in \\Omega} f(\\mathbf{l}, \\mathbf{v}) L_{i}(\\mathbf{l})(\\mathbf{n} \\cdot \\mathbf{l}) d \\mathbf{l}\n\\tag{9.4}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240528170842-6xmvbux","Type":"NodeParagraph","Properties":{"id":"20240528170842-6xmvbux","updated":"20240528171025"},"Children":[{"Type":"NodeText","Data":"计算反射方程时通常会使用球坐标"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"\\phi"},{"Type":"NodeText","Data":"和"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"\\theta"},{"Type":"NodeText","Data":"来对半球进行参数化，此时微分立体角"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"d\\mathbf{l}"},{"Type":"NodeText","Data":"就等于"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\sin \\theta_{i} d \\theta_{i} d \\phi_{i}"},{"Type":"NodeText","Data":"，可以推导出二重积分："}]},{"ID":"20240528171025-5nacreo","Type":"NodeMathBlock","Properties":{"id":"20240528171025-5nacreo","updated":"20240528171446"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"L_{o}\\left(\\theta_{o}, \\phi_{o}\\right)=\\int_{\\phi_{i}=0}^{2 \\pi} \\int_{\\theta_{i}=0}^{\\pi / 2} f\\left(\\theta_{i}, \\phi_{i}, \\theta_{o}, \\phi_{o}\\right) L\\left(\\theta_{i}, \\phi_{i}\\right) \\cos \\theta_{i} \\sin \\theta_{i} d \\theta_{i} d \\phi_{i}\n\\tag{9.5}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240528170945-yi88n5a","Type":"NodeParagraph","Properties":{"id":"20240528170945-yi88n5a","updated":"20240528171210"},"Children":[{"Type":"NodeText","Data":"怎么推倒的？相关链接"},{"Type":"NodeTextMark","TextMarkType":"block-ref","TextMarkBlockRefID":"20240528171058-xlrodlt","TextMarkBlockRefSubtype":"d","TextMarkTextContent":"半球积分"},{"Type":"NodeText","Data":"，这篇文章可以帮助理解如何进行参数化以及进行半球积分。"}]},{"ID":"20240528171320-13r8eum","Type":"NodeParagraph","Properties":{"id":"20240528171320-13r8eum","updated":"20240528171421"},"Children":[{"Type":"NodeText","Data":"有些情况使用不同的参数化表示会更方便，使用仰角的余弦值"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mu_{i}=\\cos \\theta_{i} , \\mu_{o}=\\cos \\theta_{o}"},{"Type":"NodeText","Data":"，此时"}]},{"ID":"20240528171424-d8djqwy","Type":"NodeMathBlock","Properties":{"id":"20240528171424-d8djqwy","updated":"20240528171430"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"L_{o}\\left(\\mu_{o}, \\phi_{o}\\right)=\\int_{\\phi_{i}=0}^{2 \\pi} \\int_{\\mu_{i}=0}^{1} f\\left(\\mu_{i}, \\phi_{i}, \\mu_{o}, \\phi_{o}\\right) L\\left(\\mu_{i}, \\phi_{i}\\right) \\mu_{i} d \\mu_{i} d \\phi_{i}\n\\tag{9.6}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240528171430-va5pa3l","Type":"NodeParagraph","Properties":{"id":"20240528171430-va5pa3l","updated":"20240528171539"},"Children":[{"Type":"NodeText","Data":"BRDF仅在光线方向和观察方向都位于表面上方时才有定义。对于光线方向在表面下方的情况，可以通过将BRDF乘以零，或者首先不计算这些方向的BRDF来避免这种情况。"}]},{"ID":"20240528171617-axq5eft","Type":"NodeParagraph","Properties":{"id":"20240528171617-axq5eft","updated":"20240528171841"},"Children":[{"Type":"NodeText","Data":"当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n} \\cdot \\mathbf{v}"},{"Type":"NodeText","Data":"为负时（理论永远不会发生，实践中顶点法线插值和法线映射等操作可能产生），可以将可以将"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n} \\cdot \\mathbf{v}"},{"Type":"NodeText","Data":"的值限制到0，或者使用"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n} \\cdot \\mathbf{v}"},{"Type":"NodeText","Data":"的绝对值，但都会有一些瑕疵，寒霜引擎是使用"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n} \\cdot \\mathbf{v}"},{"Type":"NodeText","Data":"的绝对值再加上一个很小的数字（0.0001），此外还可以\"soft clamp\"，意味着随着"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n} ,\\mathbf{v}"},{"Type":"NodeText","Data":"之间的夹角超过90^{\\circ}时，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n} \\cdot \\mathbf{v}"},{"Type":"NodeText","Data":"的值会逐渐趋于0。"}]},{"ID":"20240528171843-dp54mx0","Type":"NodeParagraph","Properties":{"id":"20240528171843-dp54mx0","updated":"20240528171854"},"Children":[{"Type":"NodeText","Data":"物理定律对任何BRDF都有两个约束："}]},{"ID":"20240528171854-5nmqzhf","Type":"NodeList","ListData":{},"Properties":{"id":"20240528171854-5nmqzhf","updated":"20240528172459"},"Children":[{"ID":"20240528171857-gi3dqva","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240528171857-gi3dqva","updated":"20240528171857"},"Children":[{"ID":"20240528171857-iyor6xv","Type":"NodeParagraph","Properties":{"id":"20240528171857-iyor6xv","updated":"20240528172053"},"Children":[{"Type":"NodeText","Data":"第一个是Helmholtz互易性（Helmholtz reciprocity），意味着交换入射角和出射角后，其函数值相同，即："}]},{"ID":"20240528172119-zka8l0q","Type":"NodeMathBlock","Properties":{"id":"20240528172119-zka8l0q","updated":"20240528172316"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"f(\\mathbf{l}, \\mathbf{v})=f(\\mathbf{v}, \\mathbf{l})\n\\tag{9.7}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240528172317-i9prh6y","Type":"NodeParagraph","Properties":{"id":"20240528172317-i9prh6y","updated":"20240528172424"},"Children":[{"Type":"NodeText","Data":"实践中用于渲染的BRDF经常违反这个约束，但是不会出现明显的瑕疵，在确定某种BRDF物理上是否可信时，这个约束是一个有效的鉴别工具"}]}]},{"ID":"20240528172424-ysmves5","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240528172424-ysmves5","updated":"20240528172459"},"Children":[{"ID":"20240528172424-jplrw8a","Type":"NodeParagraph","Properties":{"id":"20240528172424-jplrw8a","updated":"20240528172453"},"Children":[{"Type":"NodeText","Data":"第二个是能量守恒定律即出射的能量不能大于入射的能量（这里不包含自发光表面，它将作为一个特殊情况进行处理）。离线渲染算法（例如path tracing）需要能量守恒来保证收敛性；而对于实时渲染来说，我们并不需要严格保证能量守恒，但是近似的能量守恒还是很重要的。"}]},{"ID":"20240528172458-fz8mwuc","Type":"NodeParagraph","Properties":{"id":"20240528172458-fz8mwuc","updated":"20240528172459"},"Children":[{"Type":"NodeText","Data":"使用一个明显违背能量守恒的BRDF对表面进行渲染，它会看起来过亮，不太真实。"}]}]}]},{"ID":"20240528171717-1lzwn5s","Type":"NodeParagraph","Properties":{"id":"20240528171717-1lzwn5s","updated":"20240528174103"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"定向半球反射率"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"（directional-hemispherical reflectance）"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"R(\\mathbf{l})"},{"Type":"NodeText","Data":"是一个与BRDF有关的函数，它可以用来"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"衡量BRDF的能量守恒程度"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"。对于一个给定方向的入射光线，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"R(\\mathbf{l})"},{"Type":"NodeText","Data":"测量了这个入射光线被反射到半球方向内的数量。本质上，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"R(\\mathbf{l})"},{"Type":"NodeText","Data":"测量了给定入射方向上的能量损失。这个函数的输入是入射方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"，"},{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"R(\\mathbf{l})"},{"Type":"NodeText","Data":"的定义如下：​"}]},{"ID":"20240528172725-6p1shf8","Type":"NodeMathBlock","Properties":{"id":"20240528172725-6p1shf8","updated":"20240528172808"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"R(\\mathbf{l})=\\int_{\\mathbf{v} \\in \\Omega} f(\\mathbf{l}, \\mathbf{v})(\\mathbf{n} \\cdot \\mathbf{v}) d \\mathbf{v}\n\\tag{9.8}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240528172808-c9c7r89","Type":"NodeParagraph","Properties":{"id":"20240528172808-c9c7r89","updated":"20240528172829"},"Children":[{"Type":"NodeText","Data":"这里的观察方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeText","Data":"，就像反射方程中的入射光方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"一样，它扫过了整个半球范围，并不是代表单一的观察方向。"}]},{"ID":"20240528172822-92eyjcg","Type":"NodeParagraph","Properties":{"id":"20240528172822-92eyjcg","updated":"20240528174109"},"Children":[{"Type":"NodeText","Data":"还有一个与"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"R(\\mathbf{l})"},{"Type":"NodeText","Data":"类似，但是某种意义上相反的函数——"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"半球定向反射率"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"R(\\mathbf{v})"},{"Type":"NodeText","Data":"（hemispherical-directional reflectance），其定义与"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"R(\\mathbf{l})"},{"Type":"NodeText","Data":"类似："}]},{"ID":"20240528173726-dtv6lt5","Type":"NodeMathBlock","Properties":{"id":"20240528173726-dtv6lt5","updated":"20240528174044"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"R(\\mathbf{v})=\\int_{\\mathbf{l} \\in \\Omega} f(\\mathbf{l}, \\mathbf{v})(\\mathbf{n} \\cdot \\mathbf{l}) d \\mathbf{l} \\tag{9.9}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240528174045-69drmjs","Type":"NodeParagraph","Properties":{"id":"20240528174045-69drmjs","updated":"20240528174302"},"Children":[{"Type":"NodeText","Data":"假如BRDF满足互易性，那么半球定向反射率和定向半球反射率实际上是相等的。在二者可交换使用时可以使用定向反照率（directional albedo）来作为两个反射率的统称。"}]},{"ID":"20240528174302-xuhrbdb","Type":"NodeParagraph","Properties":{"id":"20240528174302-xuhrbdb","updated":"20240528174345"},"Children":[{"Type":"NodeText","Data":"由于能量守恒，因此定向半球反射率"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"R(\\mathbf{l})"},{"Type":"NodeText","Data":"的值必须始终在 "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":" [0,1] "},{"Type":"NodeText","Data":" 范围内。反射率为0代表着所有的入射光线都被吸收，或者以其他方式丢失；反射率为1代表着所有的入射光线都会被反射。"}]},{"ID":"20240528174342-o1e5nfx","Type":"NodeParagraph","Properties":{"id":"20240528174342-o1e5nfx","updated":"20240528175038"},"Children":[{"Type":"NodeText","Data":"与BRDF一样，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"R(\\mathbf{l})"},{"Type":"NodeText","Data":"的值也会随着波长的变化而变化，因此"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"R(\\mathbf{l})"},{"Type":"NodeText","Data":"被表示为一个RGB向量，以便用于渲染。由于RGB的每个分量（红、绿、蓝）都被限制在[0,1]的范围内，因此"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"R(\\mathbf{l})"},{"Type":"NodeText","Data":"也可以被认为是一个颜色。"}]},{"ID":"20240528175039-2seg05z","Type":"NodeBlockquote","Properties":{"id":"20240528175039-2seg05z","updated":"20240528175045"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240528175040-jmo6xev","Type":"NodeParagraph","Properties":{"id":"20240528175040-jmo6xev","updated":"20240528175045"},"Children":[{"Type":"NodeText","Data":"这个约束不适用于BRDF。BRDF作为一个分布函数，如果其描述的分布高度是不均匀的话，那么它在某些方向上，可以具有任意高的值（例如高光中心）。"}]}]},{"ID":"20240528175046-dwyt3kd","Type":"NodeParagraph","Properties":{"id":"20240528175046-dwyt3kd","updated":"20240528175057"},"Children":[{"Type":"NodeText","Data":"对BRDF能量守恒的要求是，对于所有可能的入射方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}，R(\\mathbf{l})"},{"Type":"NodeText","Data":"都不大于1。"}]},{"ID":"20240528175055-qs0pp3y","Type":"NodeParagraph","Properties":{"id":"20240528175055-qs0pp3y","updated":"20240528175243"},"Children":[{"Type":"NodeText","Data":"最简单的BRDF是Lambertian。尽管Lambertian BRDF很简单，但是它经常用于实时渲染中，以表示局部次表面散射（尽管它正在被更加精确的模型所取代，详见章节9.9）。Lambertian表面的定向半球反射率也是一个常数，将方程9.8中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"f(\\mathbf{l}, \\mathbf{v})"},{"Type":"NodeText","Data":"项作为一个常数，可以计算得到定向半球反射率"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"R(\\mathbf{l})"},{"Type":"NodeText","Data":"，并将其作为BRDF:"}]},{"ID":"20240528175244-8x7da0i","Type":"NodeMathBlock","Properties":{"id":"20240528175244-8x7da0i","updated":"20240528175702"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"R(\\mathbf{l})=\\pi f(\\mathbf{l}, \\mathbf{v})\n\\tag{9.10}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240528175251-wei8bg2","Type":"NodeParagraph","Properties":{"id":"20240528175251-wei8bg2","updated":"20240528175712"},"Children":[{"Type":"NodeText","Data":"Lambertian BRDF的恒定反射率通常被称为"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"漫反射颜色"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"（diffuse）"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"c_{diff}"},{"Type":"NodeText","Data":"，或者"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"反照率"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"（albedo）"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\rho"},{"Type":"NodeText","Data":"。在本章节中，为了强调它与次表面散射现象的联系，我们将这个量称为次表面反照率（subsurface albedo）"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\rho_{ss}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240528175705-74mzpwp","Type":"NodeParagraph","Properties":{"id":"20240528175705-74mzpwp","updated":"20240528175734"},"Children":[{"Type":"NodeText","Data":"由方程9.10可以推出："}]},{"ID":"20240528175734-w8l8mme","Type":"NodeMathBlock","Properties":{"id":"20240528175734-w8l8mme","updated":"20240528175739"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"f(\\mathbf{l}, \\mathbf{v})=\\frac{\\rho_{\\mathrm{ss}}}{\\pi} \\tag{9.11}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240528175739-hp80eb4","Type":"NodeParagraph","Properties":{"id":"20240528175739-hp80eb4","updated":"20240528175817"},"Children":[{"Type":"NodeText","Data":"其中包含了"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"1/\\pi"},{"Type":"NodeText","Data":"项（保证"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"R(l)在[0,1]"},{"Type":"NodeText","Data":"），这是因为对余弦项在整个半球范围内进行积分的结果是"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\pi"},{"Type":"NodeText","Data":"，这些项经常出现在BRDF中。"}]},{"ID":"20240528175818-q9joxri","Type":"NodeBlockquote","Properties":{"id":"20240528175818-q9joxri","updated":"20240601153943"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240601153919-cg95qbt","Type":"NodeParagraph","Properties":{"id":"20240601153919-cg95qbt","updated":"20240601153943"},"Children":[{"Type":"NodeText","Data":"反照率albedo是一个行星物理学术语，用于描述天体的反射能力，其数学定义是反射辐射和入射辐射之比，是一个无量纲量。而反射率reflectance用于表示某一种波长光线的反射辐射和入射辐射之比。当"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":"只存在漫反射，不存在镜面反射时，albedo才等于diffuse"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"，其取值范围在[0,1]之间。"}]}]},{"ID":"20240601154016-dfu4dq2","Type":"NodeParagraph","Properties":{"id":"20240601154016-dfu4dq2","updated":"20240601154022"},"Children":[{"Type":"NodeText","Data":"理解BRDF的一种方法是保持输入方向不变，将其可视化，如图9.18所示。"}]},{"ID":"20240601154025-5rvo3xz","Type":"NodeParagraph","Properties":{"id":"20240601154025-5rvo3xz","updated":"20240601154048"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"20230611105147"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/20230611105147-20240601154025-bce7por.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.18：BRDF的一些例子。图中右侧的绿色实线代表了入射光线的方向，中间的白色实线代表了表面法线，绿色虚线代表了理想状态下的反射方向。在第一行中，左侧展示了一个Lambertian BRDF（一个简单半球）；中间展示了在Lambertian项中添加了Blinn-Phong高光的结果；右侧展示了Cook-Torrance BRDF  \\[285, 1779\\] ，值得注意的是，镜面高光并不是最强的反射方向。在第二行中，左侧是Ward各向异性模型的特写，在这种情况下，反射方向是一个倾斜的镜面波瓣；中间展示了Hapke/Lommel-Seeliger“月面（lunar surface）”BRDF  \\[664\\] ，它具有强烈的后反射；右侧展示了 Lommel-Seeliger散射，尘埃表面会将光线散射到掠射角上（grazing angle）。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240601154049-myscl0l","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240601154049-myscl0l","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.4 光照"}]},{"ID":"20240601154208-vst3tsx","Type":"NodeParagraph","Properties":{"id":"20240601154208-vst3tsx","updated":"20240601155622"},"Children":[{"Type":"NodeText","Data":"反射方程（方程9.4）中的"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"L_i(\\mathbf{l})"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":" 项（入射radiance），代表了从场景其他部分照射到着色点表面的光线。全局光照（global illumination）算法通过模拟光线在场景中的传播和反射，来计算这个"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"L_i(\\mathbf{l})"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color5);"},"TextMarkType":"text","TextMarkTextContent":" 项，这些算法会使用到渲染方程（rendering equation）"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color5);\"}"},{"Type":"NodeText","Data":"，其中反射方程就是渲染方程的一个特殊例子。有关全局光照的内容将在第11章进行讨论，而在本章节（第9章）和下一章（第10章）中，我们将关注局部光照（local illumination），它使用反射方程来计算每个表面点的局部着色情况。在这些局部光照算法中，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"L_i(\\mathbf{l})"},{"Type":"NodeText","Data":"项是默认已知的，因此不需要进行计算。"}]},{"ID":"20240601154434-1s5l0on","Type":"NodeParagraph","Properties":{"id":"20240601154434-1s5l0on","updated":"20240601154511"},"Children":[{"Type":"NodeText","Data":"这里假定使用有限形式的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"L_i(\\mathbf{l})"},{"Type":"NodeText","Data":"，它仅由方向光和精确光源组成。"}]},{"ID":"20240601154515-8xkxjcd","Type":"NodeBlockquote","Properties":{"id":"20240601154515-8xkxjcd","updated":"20240601154523"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240601154515-y4un3hg","Type":"NodeParagraph","Properties":{"id":"20240601154515-y4un3hg","updated":"20240601154523"},"Children":[{"Type":"NodeText","Data":"在现实场景中，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"L_i(\\mathbf{l})"},{"Type":"NodeText","Data":"包括了来自各个方向的非零radiance，无论这些radiance是直接从光源发射出的，还是从其他表面反射出的。"}]}]},{"ID":"20240601154524-o0z6z4y","Type":"NodeParagraph","Properties":{"id":"20240601154524-o0z6z4y","updated":"20240601155806"},"Children":[{"Type":"NodeText","Data":"取一个很小很远的面光源，并定义向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}_{c}"},{"Type":"NodeText","Data":"指向该面光源的几何中心；同时，我们将该面光源的颜色"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{c}_{light}"},{"Type":"NodeText","Data":"定义为：从正对"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"（\\mathbf{n}=\\mathbf{l}_{c}）"},{"Type":"NodeText","Data":"该光源的白色Lambertian表面所反射出的radiance。"}]},{"ID":"20240601155807-pbkr0bh","Type":"NodeParagraph","Properties":{"id":"20240601155807-pbkr0bh","updated":"20240601160023"},"Children":[{"Type":"NodeText","Data":"由此可以推导出方向光的一种极限情况，即保持光源颜色"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{c}_{light}"},{"Type":"NodeText","Data":"不变的情况下，将面光源的大小缩小到零，此时反射方程可以简化为一个BRDF计算，拥有更低的成本："}]},{"ID":"20240601160023-ib6i0ji","Type":"NodeMathBlock","Properties":{"id":"20240601160023-ib6i0ji","updated":"20240601160219"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"L_{o}(\\mathbf{v})=\\pi f\\left(\\mathbf{l}_{c}, \\mathbf{v}\\right) \\mathbf{c}_{\\text {light }}\\left(\\mathbf{n} \\cdot \\mathbf{l}_{c}\\right)\n\\tag{9.12}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240601160159-iplklpb","Type":"NodeParagraph","Properties":{"id":"20240601160159-iplklpb","updated":"20240601160225"},"Children":[{"Type":"NodeText","Data":"上述方程中的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\left(\\mathbf{n} \\cdot \\mathbf{l}_{c}\\right)"},{"Type":"NodeText","Data":"通常会被限制到0，从而避免表面下方的光线对这个着色点产生贡献："}]},{"ID":"20240601160225-3yide15","Type":"NodeMathBlock","Properties":{"id":"20240601160225-3yide15","updated":"20240601160229"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"L_{o}(\\mathbf{v})=\\pi f\\left(\\mathbf{l}_{c}, \\mathbf{v}\\right) \\mathbf{c}_{\\text {light }}\\left(\\mathbf{n} \\cdot \\mathbf{l}_{c}\\right)^{+}\n\\tag{9.13}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240601160229-90iofrs","Type":"NodeParagraph","Properties":{"id":"20240601160229-90iofrs","updated":"20240601160304"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"x^{+}"},{"Type":"NodeText","Data":"代表了将x限制到0。"}]},{"ID":"20240601160305-b46lokw","Type":"NodeParagraph","Properties":{"id":"20240601160305-b46lokw","updated":"20240601160328"},"Children":[{"Type":"NodeText","Data":"当场景中存在多个光源的时候，我们可以多次计算方程9.12，并对结果求和，即："}]},{"ID":"20240601160330-gow3z8r","Type":"NodeMathBlock","Properties":{"id":"20240601160330-gow3z8r","updated":"20240601160334"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"L_{o}(\\mathbf{v})=\\pi \\sum_{i=1}^{n} f\\left(\\mathbf{l}_{c_{i}}, \\mathbf{v}\\right) \\mathbf{c}_{\\text {light }_{i}}\\left(\\mathbf{n} \\cdot \\mathbf{l}_{c_{i}}\\right)^{+}\n\\tag{9.14}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240601160334-6wt95bd","Type":"NodeParagraph","Properties":{"id":"20240601160334-6wt95bd","updated":"20240601160358"},"Children":[{"Type":"NodeText","Data":"其中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}_{c_{i}}"},{"Type":"NodeText","Data":"代表了第i个光源的方向，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{c}_{\\text {light }_{i}}"},{"Type":"NodeText","Data":"代表了第i个光源的颜色。"}]},{"ID":"20240601160356-bf3oqqn","Type":"NodeParagraph","Properties":{"id":"20240601160356-bf3oqqn","updated":"20240601160700"},"Children":[{"Type":"NodeText","Data":"方程9.14中的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\pi"},{"Type":"NodeText","Data":"，会和BRDF中经常出现的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"1/\\pi"},{"Type":"NodeText","Data":"相抵消（例如方程9.11）。这种抵消可以将除法操作移出着色器，并且使得着色方程更加易于阅读。"}]},{"ID":"20240601160701-bisjby3","Type":"NodeParagraph","Properties":{"id":"20240601160701-bisjby3","updated":"20240601160707"},"Children":[{"Type":"NodeText","Data":"通常情况下，BRDF在使用之前需要乘以"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\pi"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240601160707-2q18lhw","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240601160707-2q18lhw","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.5 菲涅尔反射"}]},{"ID":"20240601160715-3s10xsm","Type":"NodeParagraph","Properties":{"id":"20240601160715-3s10xsm","updated":"20240601160822"},"Children":[{"Type":"NodeText","Data":"物体的表面是指周围介质（通常是空气）与内部物质之间的分界面，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"光与两种物质之间的平面分界面的相互作用，遵循菲涅尔方程"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"（Fresnel equation）。"}]},{"ID":"20240601160813-86zrikr","Type":"NodeParagraph","Properties":{"id":"20240601160813-86zrikr","updated":"20240601161114"},"Children":[{"Type":"NodeText","Data":"根据几何光学的假设，菲涅尔方程需要一个平面分界面才能生效；也就是说，我们会假设这个表面在1-100倍光线波长的范围内不存在任何不规则性。"}]},{"ID":"20240601161115-1yfghz5","Type":"NodeBlockquote","Properties":{"id":"20240601161115-1yfghz5","updated":"20240601161119"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240601161115-vymkuj0","Type":"NodeParagraph","Properties":{"id":"20240601161115-vymkuj0","updated":"20240601161119"},"Children":[{"Type":"NodeText","Data":"小于这个范围的不规则性对光线没有影响，而大于这个范围的不规则性，会明显改变表面的倾斜程度，但是并不影响表面局部的平坦性。"}]}]},{"ID":"20240601161040-19umxqo","Type":"NodeParagraph","Properties":{"id":"20240601161040-19umxqo","updated":"20240601161206"},"Children":[{"Type":"NodeText","Data":"照射到平面上的光线会分为反射和折射两个部分。反射光线的方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"（\\mathbf{r}_i）"},{"Type":"NodeText","Data":"与表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"之间的夹角，入射光线方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"（\\mathbf{l}）"},{"Type":"NodeText","Data":"和表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"之间的夹角，这两个夹角是完全相同的，记为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_i"},{"Type":"NodeText","Data":"。反射向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{r}_i"},{"Type":"NodeText","Data":"可以由表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"和入射光方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"计算得出："}]},{"ID":"20240601161206-6qb6s7s","Type":"NodeMathBlock","Properties":{"id":"20240601161206-6qb6s7s","updated":"20240601161219"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{r}_{i}=2(\\mathbf{n} \\cdot \\mathbf{l}) \\mathbf{n}-1 \\tag{9.15}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240601161253-07xx0m2","Type":"NodeParagraph","Properties":{"id":"20240601161253-07xx0m2","updated":"20240602161424"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240601161253-uxpvoqq.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240601161256-zu3y93s","Type":"NodeParagraph","Properties":{"id":"20240601161256-zu3y93s","updated":"20240601161304"},"Children":[{"Type":"NodeText","Data":"如图9.19所示。反射光的光量（入射光的一部分）由菲涅尔反射率（Fresnel reflectance）F来描述，它取决于入射角度"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_i"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240601161305-lqwlyow","Type":"NodeParagraph","Properties":{"id":"20240601161305-lqwlyow","updated":"20240601161447"},"Children":[{"Type":"NodeText","Data":"反射和折射会受到表面两侧物质折射率的影响，我们将继续使用前面讨论时所用到过的一些符号表示。"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"n_1"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"代表了表面“上方”物质的折射率，即入射光和反射光传播的那一侧；"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"n_2"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"代表了表面“下方”物质的折射率，即折射光传播的那一侧"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240601161438-al1a9cp","Type":"NodeParagraph","Properties":{"id":"20240601161438-al1a9cp","updated":"20240601161506"},"Children":[{"Type":"NodeText","Data":"菲涅尔方程描述了F对入射角度"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_i"},{"Type":"NodeText","Data":"、折射率"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n_1，n_2"},{"Type":"NodeText","Data":"的依赖关系"}]},{"ID":"20240601161507-20js8f8","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240601161507-20js8f8","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.5.1 外反射"}]},{"ID":"20240601161514-m1kh0lz","Type":"NodeParagraph","Properties":{"id":"20240601161514-m1kh0lz","updated":"20240601161836"},"Children":[{"Type":"NodeText","Data":"外反射（external reflection）是指"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n_1 \u003c n_2"},{"Type":"NodeText","Data":"的情况，也就是说，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"光线是从折射率较低的那一侧表面发出来的"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240601161838-eutmr7m","Type":"NodeBlockquote","Properties":{"id":"20240601161838-eutmr7m","updated":"20240601161850"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240601161841-kzr3azj","Type":"NodeParagraph","Properties":{"id":"20240601161841-kzr3azj","updated":"20240601161850"},"Children":[{"Type":"NodeText","Data":"在大多数情况下，表面的这一侧都是空气，其折射率约为1.003。为了简单起见，我们假设"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n_1 =1。"}]}]},{"ID":"20240601161850-8729jmi","Type":"NodeParagraph","Properties":{"id":"20240601161850-8729jmi","updated":"20240601161856"},"Children":[{"Type":"NodeText","Data":"光线从物体内部传播到空气中的反射过程被称为内反射（internal reflection）。"}]},{"ID":"20240601161856-9yrfx7p","Type":"NodeParagraph","Properties":{"id":"20240601161856-9yrfx7p","updated":"20240601162037"},"Children":[{"Type":"NodeText","Data":"对于一种给定的物质，菲涅尔方程可以被解释为一个仅依赖于入射光角度的反射率函数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F\\left(\\theta_{i}\\right)"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240601162038-zuqgmlz","Type":"NodeBlockquote","Properties":{"id":"20240601162038-zuqgmlz","updated":"20240601162049"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240601162042-5w2fcg7","Type":"NodeParagraph","Properties":{"id":"20240601162042-5w2fcg7","updated":"20240601162049"},"Children":[{"Type":"NodeText","Data":"原则上来说，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F\\left(\\theta_{i}\\right)"},{"Type":"NodeText","Data":"的值会在可见光谱上连续变化，但是出于渲染目的，这个函数的输出会被视为一个RGB向量。"}]}]},{"ID":"20240601162100-y2lthof","Type":"NodeParagraph","Properties":{"id":"20240601162100-y2lthof","updated":"20240601162106"},"Children":[{"Type":"NodeText","Data":"函数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F\\left(\\theta_{i}\\right)"},{"Type":"NodeText","Data":"具有以下特征："}]},{"ID":"20240601162126-2nn3vvn","Type":"NodeList","ListData":{},"Properties":{"id":"20240601162126-2nn3vvn","updated":"20240601162143"},"Children":[{"ID":"20240601162126-0bsbqcd","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240601162126-0bsbqcd","updated":"20240601162143"},"Children":[{"ID":"20240601162126-pyr17gb","Type":"NodeParagraph","Properties":{"id":"20240601162126-pyr17gb","updated":"20240601162143"},"Children":[{"Type":"NodeText","Data":"当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{i}=0^{\\circ}"},{"Type":"NodeText","Data":"，即当光线垂直于表面（"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}=\\mathbf{n}"},{"Type":"NodeText","Data":"）时，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F\\left(\\theta_{i}\\right)"},{"Type":"NodeText","Data":"的值反映了物质本身的属性。这个特殊值"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"，可以被认为是物质特有的镜面颜色。我们将"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{i}=0^{\\circ}"},{"Type":"NodeText","Data":"的情况称为法线反射（normal incidence）（或者是法向入射，垂直入射等）。"}]}]}]},{"ID":"20240601162146-76adz5b","Type":"NodeList","ListData":{},"Properties":{"id":"20240601162146-76adz5b","updated":"20240601162206"},"Children":[{"ID":"20240601162154-09quebp","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240601162154-09quebp","updated":"20240601162206"},"Children":[{"ID":"20240601162154-gcoo7i6","Type":"NodeParagraph","Properties":{"id":"20240601162154-gcoo7i6","updated":"20240601162206"},"Children":[{"Type":"NodeText","Data":"随着"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{i}"},{"Type":"NodeText","Data":"的不断增大，入射光线会以越来越大的掠射角度照射到表面上，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F\\left(\\theta_{i}\\right)"},{"Type":"NodeText","Data":"的值将不断增加，当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{i}=90^{\\circ}"},{"Type":"NodeText","Data":"时，对于任何频率的入射光，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F\\left(\\theta_{i}\\right)"},{"Type":"NodeText","Data":"都会输出1（即白色）。"}]}]}]},{"ID":"20240601162232-02jjh2q","Type":"NodeParagraph","Properties":{"id":"20240601162232-02jjh2q","updated":"20240601162249"},"Children":[{"Type":"NodeText","Data":"下图展示了击中物质的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F\\left(\\theta_{i}\\right)"},{"Type":"NodeText","Data":"函数"}]},{"ID":"20240601162252-jsv7b3r","Type":"NodeParagraph","Properties":{"id":"20240601162252-jsv7b3r","updated":"20240601162256"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240601162252-parte80.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.20：三种物质外反射的菲涅尔反射率 F ，从左到右分别是：玻璃、铜、铝。第一行是 F 作为波长和入射角的函数的三维示意图。第二行展示了在不同入射角下， F 的光谱值转换为 RGB 颜色通道的曲线。其中玻璃的三个通道曲线是完全一致的，因为它的菲涅尔反射是无色的。在第三行中，RGB通道曲线是根据入射角的正弦值进行绘制的，以解释 图9.21 所示的透视缩减。第三行图片中 x 轴还展示了菲涅尔反射的 RGB 颜色。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240601162257-6fvaae3","Type":"NodeParagraph","Properties":{"id":"20240601162257-6fvaae3","updated":"20240601162430"},"Children":[{"Type":"NodeText","Data":"在镜面反射（mirror reflection）的情况下，光线的出射角与入射角完全相同，这意味着与表面呈掠射角度的入射光线（"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{i}"},{"Type":"NodeText","Data":"的值接近90◦），其出射光线也与表面呈掠射角度，并最终进入相机或者眼睛，因此反射率的增加主要会出现在物体的边缘处。"}]},{"ID":"20240601162431-ju5xqer","Type":"NodeParagraph","Properties":{"id":"20240601162431-ju5xqer","updated":"20240601162441"},"Children":[{"Type":"NodeText","Data":"此外，从相机的视角来看，表面反射率增加最剧烈的部分会被透视缩短（foreshortened），因此这部分所占用的像素数量相对较少。"}]},{"ID":"20240601162508-anpxx9d","Type":"NodeParagraph","Properties":{"id":"20240601162508-anpxx9d","updated":"20240601162545"},"Children":[{"Type":"NodeText","Data":"下图展示了为什么图9.20都是使用"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\sin \\left(\\theta_{i}\\right)"},{"Type":"NodeText","Data":"作为参数进行绘制的："}]},{"ID":"20240601162545-y1g4g49","Type":"NodeParagraph","Properties":{"id":"20240601162545-y1g4g49","updated":"20240601162545"}},{"ID":"20240601162549-4rfq8p6","Type":"NodeParagraph","Properties":{"id":"20240601162549-4rfq8p6","updated":"20240601162610"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240601162549-axl7hxf.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.21：远离眼睛的斜面会被透视缩短。这种透视缩短与按照视角方向 v 和表面法线 n 之间夹角的正弦值，来对表面点进行投影是一致的（对于镜面反射而言，这个夹角与入射角相同）。因此，在 图9.20 和 图9.22 中，菲涅尔反射率曲线是根据入射角的正弦值进行绘制的。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240601162610-u6hd7g8","Type":"NodeParagraph","Properties":{"id":"20240601162610-u6hd7g8","updated":"20240602153447"},"Children":[{"Type":"NodeText","Data":"从现在开始，为了强调所涉及的向量，我们使用符号"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F(\\mathbf{n}, \\mathbf{l})"},{"Type":"NodeText","Data":"而不是"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F\\left(\\theta_{i}\\right)"},{"Type":"NodeText","Data":"来表示菲涅尔函数。回想一下，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{i}"},{"Type":"NodeText","Data":"是表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"和入射光方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"之间的夹角。当菲涅尔函数被整合为BRDF的一部分时，通常会使用一个不同的向量来代替表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"，Ref 9.8."}]},{"ID":"20240602153409-lgwaqra","Type":"NodeParagraph","Properties":{"id":"20240602153409-lgwaqra","updated":"20240602153505"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"在掠射角度处反射率剧烈增加的现象，通常被称为菲涅尔效应"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240602153505-2lmszzy","Type":"NodeParagraph","Properties":{"id":"20240602153505-2lmszzy","updated":"20240602153747"},"Children":[{"Type":"NodeText","Data":"除了非常复杂之外，菲涅尔方程还有一些其他的特性，这些特性使得菲涅尔方程很难直接用于渲染。它需要在可见光谱上采样折射率值，这些值可能会是复数。图9.20中的曲线展示了一种基于特征高光颜色F_0的简化方法。"}]},{"ID":"20240602153727-2tfjcw9","Type":"NodeParagraph","Properties":{"id":"20240602153727-2tfjcw9","updated":"20240602153727"},"Children":[{"Type":"NodeText","Data":"Schlick [1568]给出了菲涅尔反射率的近似值，如下所示："}]},{"ID":"20240602153731-q81sc52","Type":"NodeMathBlock","Properties":{"id":"20240602153731-q81sc52","updated":"20240602153747"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"F(\\mathbf{n}, \\mathbf{l}) \\approx F_{0}+\\left(1-F_{0}\\right)\\left(1-(\\mathbf{n} \\cdot \\mathbf{l})^{+}\\right)^{5}\n\\tag{9.16}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240602153736-4usyib2","Type":"NodeParagraph","Properties":{"id":"20240602153736-4usyib2","updated":"20240602153813"},"Children":[{"Type":"NodeText","Data":"这个函数实际上就是在白色和F_0之间进行RGB插值，尽管它很简单，但是这个近似还是相当准确的。"}]},{"ID":"20240602153854-zsl1ubh","Type":"NodeParagraph","Properties":{"id":"20240602153854-zsl1ubh","updated":"20240602153854"},"Children":[{"Type":"NodeText","Data":"图9.22展示了几种偏离Schlick曲线的物质，它们（第二行）在变白之前会表现出明显的“下降”。"}]},{"ID":"20240602153901-pt8tfid","Type":"NodeParagraph","Properties":{"id":"20240602153901-pt8tfid","updated":"20240602153906"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240602153901-q70iv5l.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.22：展示了Schlick的菲涅耳反射率近似值，与六种物质外反射精确值之间的对比。前三种物质与 图9.20 中所展示的相同，从左到右分别是：玻璃、铜、铝；下面三种物质分别是：铬、铁和锌。每种物质都有一个RGB通道曲线图，其中实线代表了精确的菲涅尔方程，虚线代表了Schlick近似。每个曲线图下面有两个颜色条，其中上面的颜色条代表了精确菲涅耳方程的结果，下面的颜色条代表了Schlick近似的结果。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240602153907-yci0j9w","Type":"NodeParagraph","Properties":{"id":"20240602153907-yci0j9w","updated":"20240602153942"},"Children":[{"Type":"NodeText","Data":"当我们使用Schlick近似时，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"是控制菲涅尔反射的唯一参数。"}]},{"ID":"20240602154018-d2dxmbq","Type":"NodeList","ListData":{},"Properties":{"id":"20240602154018-d2dxmbq","updated":"20240609100300"},"Children":[{"ID":"20240602154019-f6i4hjc","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240602154019-f6i4hjc","updated":"20240609100300"},"Children":[{"ID":"20240602154019-xa9lb51","Type":"NodeParagraph","Properties":{"id":"20240602154019-xa9lb51","updated":"20240609100300"},"Children":[{"Type":"NodeText","Data":"因为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"在[0,1]中有一个定义良好的有效值范围，很容易使用标准的颜色选择界面进行设置，并且可以使用为颜色设计的纹理格式来进行纹理化操作。"}]}]},{"ID":"20240602154024-hh66tzu","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240602154024-hh66tzu"},"Children":[{"ID":"20240602154024-383exrj","Type":"NodeParagraph","Properties":{"id":"20240602154024-383exrj","updated":"20240602154031"},"Children":[{"Type":"NodeText","Data":"此外，还可以使用许多现实世界材料的属性来作为F_0的参考值。"}]}]},{"ID":"20240602154032-ho15rl8","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240602154032-ho15rl8","updated":"20240602154326"},"Children":[{"ID":"20240602154032-aahqilr","Type":"NodeParagraph","Properties":{"id":"20240602154032-aahqilr","updated":"20240602154124"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"也可以通过折射率计算得出，通常假设空气折射率的近似值"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n_1 = 1"},{"Type":"NodeText","Data":"，用"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n"},{"Type":"NodeText","Data":"代替"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n_2"},{"Type":"NodeText","Data":"，来表示物体的折射率。简化之后可以获得如下方程："}]},{"ID":"20240602154125-vq40cxn","Type":"NodeMathBlock","Properties":{"id":"20240602154125-vq40cxn","updated":"20240602154146"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"F_{0}=\\left(\\frac{n-1}{n+1}\\right)^{2}\n\\tag{9.17}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240602154147-b8xpjeb","Type":"NodeParagraph","Properties":{"id":"20240602154147-b8xpjeb","updated":"20240602154244"},"Children":[{"Type":"NodeText","Data":"在一些应用中[732, 947]使用了Schlick近似的更一般形式："}]},{"ID":"20240602154245-uh003o4","Type":"NodeMathBlock","Properties":{"id":"20240602154245-uh003o4","updated":"20240602154251"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"F(\\mathbf{n}, \\mathbf{l}) \\approx F_{0}+\\left(F_{90}-F_{0}\\right)\\left(1-(\\mathbf{n} \\cdot \\mathbf{l})^{+}\\right)^{\\frac{1}{p}}\n\\tag{9.18}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240602154253-2gm9vgb","Type":"NodeParagraph","Properties":{"id":"20240602154253-2gm9vgb","updated":"20240602154326"},"Children":[{"Type":"NodeText","Data":"这个方程可以让我们控制菲涅尔曲线在90^{\\circ}时所过渡到的颜色，以及过渡的“速度”。"}]}]}]},{"ID":"20240602153942-xflbl9o","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240602153942-xflbl9o","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.5.2 典型的菲涅尔反射值"}]},{"ID":"20240602154342-dh5jwvk","Type":"NodeParagraph","Properties":{"id":"20240602154342-dh5jwvk","updated":"20240602154509"},"Children":[{"Type":"NodeText","Data":"物质根据光学特性可分为三大类：电介质（dielectric） / 绝缘体（insulator），金属（metal） / 导体（conductor），半导体（semiconductor）。"}]},{"ID":"20240602154510-89qrlw1","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240602154510-89qrlw1","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"电介质的菲涅尔反射率"}]},{"ID":"20240602154520-kadncbe","Type":"NodeParagraph","Properties":{"id":"20240602154520-kadncbe","updated":"20240602154549"},"Children":[{"Type":"NodeText","Data":"电介质具有相当低的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"值，通常为0.06或者更低。法线反射时的低反射率，会使得菲涅尔效应在电介质中尤为明显。"}]},{"ID":"20240602154600-tg80xo3","Type":"NodeParagraph","Properties":{"id":"20240602154600-tg80xo3","updated":"20240602154608"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240602154600-tuz83r0.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"表9.1：各种电介质的外反射 F\\_0 值。每个值都以线性值、纹理值（非线性编码的8 bit无符号整数）和色板的形式给出。如果给定的 F\\_0 值是一个范围，那么色板展示是该范围的中间颜色。回想一下，这些都是镜面颜色，例如：宝石通常具有十分鲜艳的颜色，但是这些颜色是由于物质内部的光线吸收而产生的，与菲涅尔反射无关。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240602154609-dajjzr7","Type":"NodeParagraph","Properties":{"id":"20240602154609-dajjzr7","updated":"20240602154656"},"Children":[{"Type":"NodeText","Data":"对于未知的电介质而言，0.04是一个合理的默认值（译者注：metallic工作流中，非金属的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"值一般为0.04），这与大多数常见材料的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"值相差不大。"}]},{"ID":"20240602154656-58dute4","Type":"NodeParagraph","Properties":{"id":"20240602154656-58dute4","updated":"20240602154931"},"Children":[{"Type":"NodeText","Data":"一旦光线进入了电介质内部，那么它就有可能会被进一步散射或者吸收。Ref 9.9"}]},{"ID":"20240602154931-ecptd0w","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240602154931-ecptd0w","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"金属的菲涅尔反射率"}]},{"ID":"20240602154941-taq4gxh","Type":"NodeParagraph","Properties":{"id":"20240602154941-taq4gxh","updated":"20240602155007"},"Children":[{"Type":"NodeText","Data":"金属的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"值普遍很高，几乎都在0.5以上。"}]},{"ID":"20240602155009-v0qf5qw","Type":"NodeParagraph","Properties":{"id":"20240602155009-v0qf5qw","updated":"20240602155013"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240602155009-8ltvr4e.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"表9.2：各种金属（和一种合金）的外反射 F\\_0 值，按照反射亮度的顺序进行排序。黄金的实际红色分量略微超出了sRGB色域，图中展示的是clamp后的值。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240602155101-yddwqyj","Type":"NodeParagraph","Properties":{"id":"20240602155101-yddwqyj","updated":"20240602155204"},"Children":[{"Type":"NodeText","Data":"这里我们给出了RGB各个分量的详细数值，因为许多金属都具有彩色的菲涅尔反射。"}]},{"ID":"20240602155205-tw6ptur","Type":"NodeBlockquote","Properties":{"id":"20240602155205-tw6ptur","updated":"20240602155206"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240602155206-4xst9kd","Type":"NodeParagraph","Properties":{"id":"20240602155206-4xst9kd","updated":"20240602155206"},"Children":[{"Type":"NodeText","Data":"黄金的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"值有些不太寻常，它有着非常强烈的反射颜色，其红色通道值略高于1（刚刚超出sRGB/Rec.709色域），其蓝色通道值则特别低（表9.2中唯一一个显著低于0.5的）。"}]}]},{"ID":"20240602155207-l00l3r2","Type":"NodeParagraph","Properties":{"id":"20240602155207-l00l3r2","updated":"20240602155242"},"Children":[{"Type":"NodeText","Data":"金属会立即吸收任何透射光线，因此它们并不会表现出任何的次表面散射或者透明度。金属的所有可见颜色都来自于其"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"值。"}]},{"ID":"20240602155243-iiypsu2","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240602155243-iiypsu2","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"半导体的菲涅尔反射率"}]},{"ID":"20240602155257-23lexfs","Type":"NodeParagraph","Properties":{"id":"20240602155257-23lexfs","updated":"20240602155323"},"Children":[{"Type":"NodeText","Data":"半导体的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"值介于最亮的电介质和最暗的金属之间，实践中很少需要渲染这样的物质。"}]},{"ID":"20240602155325-hqs8gnr","Type":"NodeBlockquote","Properties":{"id":"20240602155325-hqs8gnr","updated":"20240602155340"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240602155325-33b3lix","Type":"NodeParagraph","Properties":{"id":"20240602155325-33b3lix","updated":"20240602155340"},"Children":[{"Type":"NodeText","Data":"因为大多数场景没有散落的晶体硅块。"}]}]},{"ID":"20240602155341-2x1hm9l","Type":"NodeParagraph","Properties":{"id":"20240602155341-2x1hm9l","updated":"20240602155355"},"Children":[{"Type":"NodeText","Data":"出于实践目的，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"应当避免使用0.2-0.45之间的"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"F_0"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"值"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"，除非您有意尝试建模一个奇异的或者非真实的材质。"}]},{"ID":"20240602155559-1v7jb8f","Type":"NodeParagraph","Properties":{"id":"20240602155559-1v7jb8f","updated":"20240602155603"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240602155559-77y3ifu.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"表9.3：图中展示了代表性半导体（晶体形式的硅）的 F\\_0 值，以及与明亮的电介质（金刚石）和较暗的金属（钛）的对比。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240602155604-xikaa4o","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240602155604-xikaa4o","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"水中的菲涅尔反射率"}]},{"ID":"20240602155610-w3477ix","Type":"NodeParagraph","Properties":{"id":"20240602155610-w3477ix","updated":"20240602155720"},"Children":[{"Type":"NodeText","Data":"如果不能假设"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n_1=1"},{"Type":"NodeText","Data":"（空气的n为1），那么9.17中的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n"},{"Type":"NodeText","Data":"需要替换为相对折射率"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n_1/n_2"},{"Type":"NodeText","Data":"即："}]},{"ID":"20240602155721-esfr4lp","Type":"NodeMathBlock","Properties":{"id":"20240602155721-esfr4lp","updated":"20240602155727"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"F_{0}=\\left(\\frac{n_{1}-n_{2}}{n_{1}+n_{2}}\\right)^{2}\n\\tag{9.19}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240602155842-cyzjqn2","Type":"NodeParagraph","Properties":{"id":"20240602155842-cyzjqn2","updated":"20240602155921"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240602155842-bwnyy5o.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"表9.4：各种物质在空气和水中的 F\\_0 值的比较。正如 方程9.19 所期望的那样，折射率接近水的电介质所受到的影响最大。相比之下，金属几乎没有受到什么影响。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240602155922-jn3ubgr","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240602155922-jn3ubgr","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"参数化的菲涅尔值"}]},{"ID":"20240602160013-s8ny6t1","Type":"NodeParagraph","Properties":{"id":"20240602160013-s8ny6t1","updated":"20240602160106"},"Children":[{"Type":"NodeText","Data":"一个常用的参数化是将镜面颜色（specular color）"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"和漫反射颜色（diffuse color）"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\rho_{ss}"},{"Type":"NodeText","Data":"结合在一起。这种参数化利用了如下的观察结果：金属材质没有漫反射颜色，而电介质可能存在的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"值是一个有限集合。"}]},{"ID":"20240602160117-4c12zld","Type":"NodeParagraph","Properties":{"id":"20240602160117-4c12zld","updated":"20240602160208"},"Children":[{"Type":"NodeText","Data":"这种参数化表示包含一个RGB表面颜色"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{c}_{surf}"},{"Type":"NodeText","Data":"和一个标量参数m，这个参数被称为“metallic”或者“metalness”，即金属度。"}]},{"ID":"20240602160223-77d52oo","Type":"NodeBlockquote","Properties":{"id":"20240602160223-77d52oo","updated":"20240602160356"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240602160343-pbef5ot","Type":"NodeParagraph","Properties":{"id":"20240602160343-pbef5ot","updated":"20240602160356"},"Children":[{"Type":"NodeText","Data":"如果m=1，则说明该材质是金属，则将"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{c}_{surf}"},{"Type":"NodeText","Data":"设置为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\rho_{ss}"},{"Type":"NodeText","Data":"设置为黑色；如果m=0，则说明该材质是非金属，则将介电值（常数，或者由其他附加参数进行控制）设置为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{c}_{surf}"},{"Type":"NodeText","Data":"设置为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\rho_{ss}"},{"Type":"NodeText","Data":"。"}]}]},{"ID":"20240602160357-nwlkuhl","Type":"NodeParagraph","Properties":{"id":"20240602160357-nwlkuhl","updated":"20240602160500"},"Children":[{"Type":"NodeText","Data":"Burley添加了一个额外的标量“镜面（specular）”参数，来将电介质的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F_0"},{"Type":"NodeText","Data":"值控制在一个有限的范围内[214]。（虚幻引擎也用这个）"}]},{"ID":"20240602160956-s0zzfyy","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240602160956-s0zzfyy","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.5.3 内反射"}]},{"ID":"20240602161002-qus953s","Type":"NodeParagraph","Properties":{"id":"20240602161002-qus953s","updated":"20240602161027"},"Children":[{"Type":"NodeText","Data":"当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n_1 \u003e n_2"},{"Type":"NodeText","Data":"的时候，就会发生内反射，也就是说，当光线在透明物体的内部传播，并“从内部”打到物体表面上时，就会发生内反射，如图9.23所示。"}]},{"ID":"20240602161030-qz7a5km","Type":"NodeParagraph","Properties":{"id":"20240602161030-qz7a5km","updated":"20240602161041"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240602161030-4y4y9ds.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.23：平面上的内反射，其中 n1 \u003e n2"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240602161041-pyh8bvu","Type":"NodeParagraph","Properties":{"id":"20240602161041-pyh8bvu","updated":"20240602161507"},"Children":[{"Type":"NodeText","Data":"Snell定律表明，对于内反射，有"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\sin \\theta_{t}\u003e\\sin \\theta_{i}"},{"Type":"NodeText","Data":"；由于"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{t},\\theta_{i}"},{"Type":"NodeText","Data":"都在"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"0^{\\circ}-90^{\\circ}"},{"Type":"NodeText","Data":"之间，因此也意味着"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{t}\u003e\\theta_{i}"},{"Type":"NodeText","Data":"，外反射角度大小正好相反，那么二者为什么不同呢？"}]},{"ID":"20240602161343-z8lad7c","Type":"NodeParagraph","Properties":{"id":"20240602161343-z8lad7c","updated":"20240602161536"},"Children":[{"Type":"NodeText","Data":"在外反射中，对于0-1之间的任意一个"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\sin \\theta_{i}"},{"Type":"NodeText","Data":"，都存在一个有效的（较小的）"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\sin \\theta_{t}"},{"Type":"NodeText","Data":"值。"}]},{"ID":"20240602161537-83juweh","Type":"NodeParagraph","Properties":{"id":"20240602161537-83juweh","updated":"20240602161633"},"Children":[{"Type":"NodeText","Data":"但是内反射则不是这样的，在内反射中存在一个临界角"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{c}"},{"Type":"NodeText","Data":"，对于大于这个临界角的入射角"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{i}"},{"Type":"NodeText","Data":"，根据Snell定律我们能推导出表明"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\sin \\theta_{t}\u003e1"},{"Type":"NodeText","Data":"，即"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{t}\u003e 90^{\\circ}"},{"Type":"NodeText","Data":"，这是不可能发生的。在这种情况下，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{t}"},{"Type":"NodeText","Data":"实际上是不存在的，即"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"当"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\theta_{i}\u003e\\theta_{c}"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"的时候，不会发生光线透射，入射光将会被全部反射。这种现象被称为全内反射（total internal reflection）。"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"}]},{"ID":"20240602161625-65ll6te","Type":"NodeParagraph","Properties":{"id":"20240602161625-65ll6te","updated":"20240602161734"},"Children":[{"Type":"NodeText","Data":"菲涅尔方程是对称的，也就是说入射向量和透射向量是可以相互交换的，并且反射率保持不变。结合Snell定律，这种对称性意味着，内反射的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F\\left(\\theta_{i}\\right)"},{"Type":"NodeText","Data":"曲线将类似于外反射曲线的“压缩”版本。即内外反射的F_0的值是相同的，但是内反射曲线会在临界角"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta_{c}"},{"Type":"NodeText","Data":"处就提前达到完美反射，而外反射曲线则会在"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"90^{\\circ}"},{"Type":"NodeText","Data":"处才达到完美反射，如图9.24所示。"}]},{"ID":"20240602161738-o6iqe89","Type":"NodeParagraph","Properties":{"id":"20240602161738-o6iqe89","updated":"20240602161744"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240602161738-pqu9c2d.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.24：玻璃-空气界面内外反射率曲线的比较。在临界角 \\theta\\_{c} 处，内反射率曲线趋于1.0。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240602161744-zhgfm7e","Type":"NodeParagraph","Properties":{"id":"20240602161744-zhgfm7e","updated":"20240602161802"},"Children":[{"Type":"NodeText","Data":"内反射只会发生在电介质中，因为金属和半导体会迅速吸收在其内部传播的任何光线。"}]},{"ID":"20240602161808-qul6b6o","Type":"NodeParagraph","Properties":{"id":"20240602161808-qul6b6o","updated":"20240602161812"},"Children":[{"Type":"NodeText","Data":"由于电介质的折射率都在实数范围内，因此通过折射率或者F_0来计算内反射临界角是很简单的："}]},{"ID":"20240602161812-bufb4lt","Type":"NodeMathBlock","Properties":{"id":"20240602161812-bufb4lt","updated":"20240602161816"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\sin \\theta_{c}=\\frac{n_{2}}{n_{1}}=\\frac{1-\\sqrt{F_{0}}}{1+\\sqrt{F_{0}}}\n\\tag{9.20}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240602161816-z5jrmje","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240602161816-z5jrmje","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.6 微观几何"}]},{"ID":"20240602161958-c9lu0ou","Type":"NodeParagraph","Properties":{"id":"20240602161958-c9lu0ou","updated":"20240606075705"},"Children":[{"Type":"NodeText","Data":"每个可见的表面点上都包含了许多微表面法线（microsurface normal），这些法线将入射光向着不同方向进行反射。由于单个微表面的朝向在某种程度上来说是随机的，因此可以将它们建模为某种统计分布（目前不考虑波动光学）。"}]},{"ID":"20240606075713-bhkhm0n","Type":"NodeParagraph","Properties":{"id":"20240606075713-bhkhm0n","updated":"20240606075713"},"Children":[{"Type":"NodeText","Data":"对于大多数表面而言，其微观几何的表面法线是一个连续分布，而在宏观的表面法线处则存在一个很强的峰值。这种分布的“紧密程度”是由表面粗糙度所决定的。表面越粗糙，微观几何表面的法线分布就会越“分散”。"}]},{"ID":"20240606075717-wmo189x","Type":"NodeParagraph","Properties":{"id":"20240606075717-wmo189x","updated":"20240606075830"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"增加微观尺度的粗糙度，其宏观的视觉效果就是反射的环境细节会变得更加模糊"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。在一个小且明亮的光源下，这种模糊会导致范围更宽、颜色更暗的高光。而那些来自粗糙表面的反射光线则会更暗，因为光线会被发散到了一个更宽的锥形方向上。"}]},{"ID":"20240606075740-fwguya6","Type":"NodeParagraph","Properties":{"id":"20240606075740-fwguya6","updated":"20240606075746"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240606075740-ynzbygc.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.25：从可见的宏观表面细节逐渐过渡到微观尺度。图像序列按照从上到下，从左到右排布。每个图像中的表面形状和光源都是固定的，只有表面细节的尺度发生了变化。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240606075818-6qnqwsu","Type":"NodeParagraph","Properties":{"id":"20240606075818-6qnqwsu","updated":"20240606075818"},"Children":[{"Type":"NodeText","Data":"图9.25展示了单个微观尺度表面细节的聚合反射，是如何产生宏观可见反射的。这一组图像展示了一个由单一光源照亮的曲面，每个曲面上的凸起大小逐渐减小，直到最后一张图像中的表面凸起比单个像素还要小得多。许多个微小高光以一种统计模式，最终聚合成了宏观的高光。"}]},{"ID":"20240606075819-f204ysq","Type":"NodeBlockquote","Properties":{"id":"20240606075819-f204ysq","updated":"20240606075823"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240606075819-2hmjre0","Type":"NodeParagraph","Properties":{"id":"20240606075819-2hmjre0","updated":"20240606075823"},"Children":[{"Type":"NodeText","Data":"例如：外围单个高光的相对稀疏程度在聚合之后，就变成了远离高光中心点的相对暗度。"}]}]},{"ID":"20240606075823-p4zkh8n","Type":"NodeParagraph","Properties":{"id":"20240606075823-p4zkh8n","updated":"20240606075917"},"Children":[{"Type":"NodeText","Data":"对于大多数表面而言，微尺度表面法线的分布是各向同性的，这意味着它是旋转对称的，不具备任何固有的方向属性。"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"而有一些表面则具有各向异性（anisotropic）的微观结构，这样的表面具有各向异性的表面法线分布，这会导致反射和高光的定向模糊"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"，如图9.26所示。"}]},{"ID":"20240606075905-gnpnhlt","Type":"NodeParagraph","Properties":{"id":"20240606075905-gnpnhlt","updated":"20240606075923"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240606075905-qk78g9t.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.26：左边是一个各向异性的表面（拉丝金属），请注意反射的定向模糊。右图是一个相似表面的显微照片，请注意表面细节的方向性。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240606075923-5kjsvr3","Type":"NodeParagraph","Properties":{"id":"20240606075923-5kjsvr3","updated":"20240606075942"},"Children":[{"Type":"NodeText","Data":"有一些表面具有高度结构化的微观几何形状，这产生了各种微观尺度的法线分布和表面外观。"}]},{"ID":"20240606075943-pbs3dz5","Type":"NodeBlockquote","Properties":{"id":"20240606075943-pbs3dz5","updated":"20240606075948"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240606075944-jxb8jcr","Type":"NodeParagraph","Properties":{"id":"20240606075944-jxb8jcr","updated":"20240606075948"},"Children":[{"Type":"NodeText","Data":"纤维织物就是一个常见的例子——天鹅绒和绸缎的独特外观，就是由它们的微观几何结构所决定的[78]。有关纤维织物的模型，将在章节9.10中进行讨论。"}]}]},{"ID":"20240606075950-huts21g","Type":"NodeParagraph","Properties":{"id":"20240606075950-huts21g","updated":"20240606080101"},"Children":[{"Type":"NodeText","Data":"虽然多重表面法线是微观几何对反射率的主要影响因素，但是其他影响因素有时候也很重要。其中"}]},{"ID":"20240606080103-dih15qu","Type":"NodeList","ListData":{},"Properties":{"id":"20240606080103-dih15qu","updated":"20240606080108"},"Children":[{"ID":"20240606080105-cs3ujda","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240606080105-cs3ujda","updated":"20240606080108"},"Children":[{"ID":"20240606080105-zq3jh8o","Type":"NodeParagraph","Properties":{"id":"20240606080105-zq3jh8o","updated":"20240606080108"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"遮蔽（shadowing）是指部分微尺度表面细节对光源的遮挡，使得光线无法照射到另一部分表面上"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"，如图9.27左侧所示。"}]}]},{"ID":"20240606080107-fsn6qyt","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240606080107-fsn6qyt"},"Children":[{"ID":"20240606080107-ox8ymut","Type":"NodeParagraph","Properties":{"id":"20240606080107-ox8ymut"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"遮挡（masking）是指微尺度表面细节对相机的遮挡，使得相机无法看见一些表面"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"，如图9.27中间所示。"}]}]}]},{"ID":"20240606080112-fm2bbxe","Type":"NodeParagraph","Properties":{"id":"20240606080112-fm2bbxe","updated":"20240606080118"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240606080112-4xh4bvf.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.27：微观结构的几何效应。左侧：黑色虚线箭头代表了被其他微观几何遮蔽（遮挡了光线）的区域。中间：红色虚线箭头表示被其他微观几何遮挡（遮挡相机视线）的区域。右侧：展示了光线在微尺度结构之间的相互反射。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240606080119-6j6j55p","Type":"NodeParagraph","Properties":{"id":"20240606080119-6j6j55p","updated":"20240606080239"},"Children":[{"Type":"NodeText","Data":"如果微观几何的高度与表面法线之间存在相关性的话，那么shadowing和masking就能够有效地改变表面的法线分布。"}]},{"ID":"20240606080244-f63jz7d","Type":"NodeBlockquote","Properties":{"id":"20240606080244-f63jz7d","updated":"20240606080301"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240606080244-fmjoqx1","Type":"NodeParagraph","Properties":{"id":"20240606080244-fmjoqx1","updated":"20240606080252"},"Children":[{"Type":"NodeText","Data":"例如：想象这样的一个表面，该表面上凸起的部分因为风化或者其他过程而变得十分光滑，而凹陷的部分仍然十分粗糙。在掠射视角下，表面的凹陷部分往往会被shadowing或者masking，从而生成一个十分光滑的表面。如图9.28所示。"}]},{"ID":"20240606080256-s4085mq","Type":"NodeParagraph","Properties":{"id":"20240606080256-s4085mq","updated":"20240606080301"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240606080256-zhqp7qa.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.28：图示的微观几何在高度和表面法线之间具有很强的相关性，其中凸起的区域是光滑的，而凹陷的区域是粗糙的。在上面的图像中，光线以接近宏观表面法线的角度照射到表面上。在这个入射角度上，许多入射光线都可以到达粗糙的凹坑，这些光线会在不同的方向上散射。而在下面的图像中，光线以一个掠射角度照射到表面上。Shadowing遮蔽了大部分凹坑，因此只有很少的光线能够照射到它们，大多数光线都被表面的光滑部分反射回来。在这种情况下，表面粗糙度很大程度上取决于光线的入射角度。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240606080302-l6abk1l","Type":"NodeParagraph","Properties":{"id":"20240606080302-l6abk1l","updated":"20240606080732"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"对于所有的表面类型而言，不规则表面的可见尺寸会随着光线入射角"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\theta_i"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"与表面法线之间夹角的增加而减小。"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"在极端的掠射角度下，这种效应可以将观察到的不规则表面尺寸，减小到比光的波长还要短，从而使得这些不规则表面对于光线的传播行为没有任何影响。这两种效应与菲涅尔效应相结合，使得表面看起来具有很高的反射率，就像镜子一样，因为此时的观察角度和光线角度接近"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"90^{\\circ}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240606080727-u3knfsw","Type":"NodeParagraph","Properties":{"id":"20240606080727-u3knfsw","updated":"20240606080807"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"被微尺度表面细节遮挡的光线并不会消失，它可能会被反射到其他的微观几何上"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。光线在最终到达眼睛之前，可能会经历多次这种类型的反射，图9.27右侧就展示了这种相互反射现象。"}]},{"ID":"20240606080802-b9pmz1c","Type":"NodeParagraph","Properties":{"id":"20240606080802-b9pmz1c","updated":"20240606080813"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240606080802-zjnti2f.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.29：微尺度粗糙度引起的逆反射。左右两幅图都展示了一个粗糙表面，它们具有较低的菲涅尔反射率和较高的漫反射率，因此次表面反射在视觉上就变得十分重要。左图中，观察方向和光照方向是相似的，微观几何中明亮的部分也是最可见的部分，从而形成了明亮的材质外观。右图中，观察方向和光照方向的差别很大，在这种情况下，明亮的区域被遮挡在视野之外，而可见区域则位于阴影中，从而形成了更暗的材质外观。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240606080804-dksegnv","Type":"NodeParagraph","Properties":{"id":"20240606080804-dksegnv","updated":"20240606081105"},"Children":[{"Type":"NodeText","Data":"由于光线在每次反弹时都会被菲涅尔反射衰减，因此电介质中的相互反射往往都不易察觉（subtle）。而"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"在金属材质中，这种多次弹射是任何可见的漫反射的来源，这是因为金属没有次表面散射现象。有色金属的多次反射颜色要比一次反射的更深，因为它们是光线与表面多次相互作用的结果"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240606081105-y4oeu9a","Type":"NodeParagraph","Properties":{"id":"20240606081105-y4oeu9a","updated":"20240606081141"},"Children":[{"Type":"NodeText","Data":"在某些情况下，微尺度的表面细节也会对次表面反射率产生影响。如果微观几何的不规则性大于次表面散射发生距离的话，那么shadowing和masking就会导致"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"逆反射（retroreflection）效应，即光线被优先反射回入射方向"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240606081141-vrqxx8d","Type":"NodeParagraph","Properties":{"id":"20240606081141-vrqxx8d","updated":"20240606081201"},"Children":[{"Type":"NodeText","Data":"这种效应的发生原因是：当观察方向和光照方向相差很大时，shadowing和masking会遮挡被光线照射到的区域，如图9.29所示。"}]},{"ID":"20240606081203-xjteefp","Type":"NodeParagraph","Properties":{"id":"20240606081203-xjteefp","updated":"20240606081207"},"Children":[{"Type":"NodeText","Data":"逆反射往往会使粗糙表面表现出平坦的外观，如图9.30所示。"}]},{"ID":"20240606081209-nk8i2zt","Type":"NodeParagraph","Properties":{"id":"20240606081209-nk8i2zt","updated":"20240606081215"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240606081209-ykcwblm.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.30：由于微尺度表面的粗糙度，这两个物体表现出了非Lambertian的、逆反射的材质外观。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240606081216-1ufk0qz","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240606081216-1ufk0qz","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.7 微表面理论"}]},{"ID":"20240606081349-xyg4qh9","Type":"NodeParagraph","Properties":{"id":"20240606081349-xyg4qh9","updated":"20240606081411"},"Children":[{"Type":"NodeText","Data":"有关微观几何对反射率影响的数学分析，被称为微表面理论（microfacet theory）。该理论的基础是，将微观几何建模为一组微表面的集合。"}]},{"ID":"20240606081410-2jqot2g","Type":"NodeParagraph","Properties":{"id":"20240606081410-2jqot2g","updated":"20240606081505"},"Children":[{"Type":"NodeText","Data":"每个微表面都是平坦的，它具有一个微表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{m }"},{"Type":"NodeText","Data":"；"}]},{"ID":"20240606081510-3ye29h6","Type":"NodeParagraph","Properties":{"id":"20240606081510-3ye29h6","updated":"20240606081510"},"Children":[{"Type":"NodeText","Data":"这些微表面会根据micro-"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"BRDFf_{\\mu}(\\mathbf{l}, \\mathbf{v}, \\mathbf{m})"},{"Type":"NodeText","Data":"来对光线进行分别反射，将所有微表面的反射率加起来，就是整个表面的BRDF。"}]},{"ID":"20240606081434-cksxwoy","Type":"NodeParagraph","Properties":{"id":"20240606081434-cksxwoy","updated":"20240606081531"},"Children":[{"Type":"NodeText","Data":"通常的做法是将每个微表面都当成一个完美的菲涅尔镜面，这会产生镜面的微表面BRDF，用于模拟表面反射。"}]},{"ID":"20240606081533-u80kywr","Type":"NodeBlockquote","Properties":{"id":"20240606081533-u80kywr","updated":"20240606081542"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240606081533-fs5e2x1","Type":"NodeParagraph","Properties":{"id":"20240606081533-fs5e2x1","updated":"20240606081542"},"Children":[{"Type":"NodeText","Data":"当然，其他选择也是可行的，例如：漫反射的micro-BRDF可以用于生成一些局部的次表面散射模型[574, 657, 709, 1198, 1337]；衍射的micro-BRDF可以用于创建一个结合几何光学和波动光学效果的着色模型[763]。"}]}]},{"ID":"20240606081543-zs74rm2","Type":"NodeParagraph","Properties":{"id":"20240606081543-zs74rm2","updated":"20240606081629"},"Children":[{"Type":"NodeText","Data":"微表面模型的一个重要性质是微表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{m }"},{"Type":"NodeText","Data":"的统计分布。这个分布是由表面的"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"法线分布函数"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"（normal distribution function，NDF）所定义的。这里我们将使用"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"D(\\mathbf{m})"},{"Type":"NodeText","Data":"来表示方程中的NDF项。"}]},{"ID":"20240606081607-mkd3tom","Type":"NodeParagraph","Properties":{"id":"20240606081607-mkd3tom","updated":"20240606081635"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240606081635-tg11h14.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240606081638-slbbdec","Type":"NodeParagraph","Properties":{"id":"20240606081638-slbbdec","style":"text-align: center; width: 100%; flex: 0 0 auto;","updated":"20240606081843"},"Children":[{"Type":"NodeText","Data":"图9.31：微表面结构的侧视图。左侧：我们可以对 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center; width: 100%; flex: 0 0 auto;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"D(\\mathbf{m})(\\mathbf{n} \\cdot \\mathbf{m})"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center; width: 100%; flex: 0 0 auto;\"}"},{"Type":"NodeText","Data":" 进行积分，将微表面区域投影到宏表面平面上，可以得到宏表面的面积（在这个侧视图中则体现为长度），按照约定是1。右侧：对 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center; width: 100%; flex: 0 0 auto;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"D(\\mathbf{m})(\\mathbf{v} \\cdot \\mathbf{m}) "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center; width: 100%; flex: 0 0 auto;\"}"},{"Type":"NodeText","Data":"进行积分，将微表面区域投影到垂直于观察方向 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center; width: 100%; flex: 0 0 auto;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center; width: 100%; flex: 0 0 auto;\"}"},{"Type":"NodeText","Data":" 的平面上，可以获得宏表面在该平面上的投影，即 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center; width: 100%; flex: 0 0 auto;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\cos \\theta_{o} "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center; width: 100%; flex: 0 0 auto;\"}"},{"Type":"NodeText","Data":"或者 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center; width: 100%; flex: 0 0 auto;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"(\\mathbf{v} \\cdot \\mathbf{n})"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center; width: 100%; flex: 0 0 auto;\"}"},{"Type":"NodeText","Data":" 。"},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center; width: 100%; flex: 0 0 auto;","style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"当多个微表面的投影相互重叠的时候，背面微表面的负投影区域会和对应的正面微表面的正投影区域相互抵消"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\" parent-style=\"text-align: center; width: 100%; flex: 0 0 auto;\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240606081653-3kf39jl","Type":"NodeParagraph","Properties":{"id":"20240606081653-3kf39jl","updated":"20240606081927"},"Children":[{"Type":"NodeText","Data":"NDF项"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"D(\\mathbf{m})"},{"Type":"NodeText","Data":"是微表面法线在微观几何区域上的统计分布。在整个微表面法线球面上对"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"D(\\mathbf{m})"},{"Type":"NodeText","Data":"进行积分，即可获得这个微表面的面积[708]。更加有用的是，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"对"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"D(\\mathbf{m})(\\mathbf{n} \\cdot \\mathbf{m})"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"进行积分，即将"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"D(\\mathbf{m})"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"投影到宏表面平面上，所得到的宏表面面片的面积为1（按照约定）"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"，如图9.31左侧所示。换句话说，投影"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"D(\\mathbf{m})(\\mathbf{n} \\cdot \\mathbf{m})"},{"Type":"NodeText","Data":"是归一化的："}]},{"ID":"20240606081922-13805p1","Type":"NodeMathBlock","Properties":{"id":"20240606081922-13805p1","updated":"20240606081935"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\int_{\\mathbf{m} \\in \\Theta} D(\\mathbf{m})(\\mathbf{n} \\cdot \\mathbf{m}) d \\mathbf{m}=1\n\\tag{9.21}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240606081935-4g7xguh","Type":"NodeParagraph","Properties":{"id":"20240606081935-4g7xguh","updated":"20240606083253"},"Children":[{"Type":"NodeText","Data":"本章节之前的积分，都是在以"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"为中心的半球内进行的，使用符号"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\Omega"},{"Type":"NodeText","Data":"来表示；而这里是对整个球面的法线进行积分，因此使用符号"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\Theta"},{"Type":"NodeText","Data":"来表示。"}]},{"ID":"20240606083247-nqyb0sh","Type":"NodeParagraph","Properties":{"id":"20240606083247-nqyb0sh","updated":"20240606083353"},"Children":[{"Type":"NodeText","Data":"。在实践中，图形学中所使用的微观结构模型大多数是高度场（heightfield），这意味着"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"在"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\Omega"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"以外的所有方向"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\mathbf{m }"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"上，"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"D(\\mathbf{m})=0"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。但是，方程9.21对于非高度场的微观结构也是有效的。"}]},{"ID":"20240606083353-3kvkzwn","Type":"NodeParagraph","Properties":{"id":"20240606083353-3kvkzwn","updated":"20240606083406"},"Children":[{"Type":"NodeText","Data":"更一般地说，微表面（microsurface）和宏表面（macrosurface）在垂直于观察方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v }"},{"Type":"NodeText","Data":"的平面上的投影是相等的，即："}]},{"ID":"20240606083406-gsuh0wa","Type":"NodeMathBlock","Properties":{"id":"20240606083406-gsuh0wa","updated":"20240609093008"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\int_{\\mathbf{m} \\in \\Theta} D(\\mathbf{m})(\\mathbf{v} \\cdot \\mathbf{m}) d \\mathbf{m}=\\mathbf{v} \\cdot \\mathbf{n}\n\\tag{9.22}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240606083411-yl5otga","Type":"NodeParagraph","Properties":{"id":"20240606083411-yl5otga","updated":"20240606083611"},"Children":[{"Type":"NodeText","Data":"方程9.21和方程9.22 强制要求"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"D(\\mathbf{m})"},{"Type":"NodeText","Data":"必须是一个合法的NDF。"}]},{"ID":"20240606083612-igwuk6b","Type":"NodeParagraph","Properties":{"id":"20240606083612-igwuk6b","updated":"20240606084126"},"Children":[{"Type":"NodeText","Data":"从直观上来看，NDF就好像是微表面法线的直方图。它在微表面法线更可能指向的方向上，具有更高的值。大多数表面的NDF都在宏观表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"处，具有很强的峰值。"}]},{"ID":"20240606084126-bp6npd9","Type":"NodeParagraph","Properties":{"id":"20240606084126-bp6npd9","updated":"20240606084142"},"Children":[{"Type":"NodeText","Data":"让我们再看一下图9.31的右侧子图。虽然有许多微表面的投影相互重叠了，但是对于渲染而言，我们只关心能够被相机看见的那些微表面，即在每个重叠集合中最接近相机的那个微表面。"}]},{"ID":"20240606084215-hvuslwz","Type":"NodeParagraph","Properties":{"id":"20240606084215-hvuslwz","updated":"20240606084225"},"Children":[{"Type":"NodeText","Data":"根据这个事实，可以提出另一种方法，来将投影后的微表面区域与宏观区域联系起来："},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"可见微表面的投影面积之和 = 宏表面的投影面积"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240606084226-5assgwu","Type":"NodeParagraph","Properties":{"id":"20240606084226-5assgwu","updated":"20240606084309"},"Children":[{"Type":"NodeText","Data":"我们可以通过定义遮挡函数（masking function）"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{1}(\\mathbf{m}, \\mathbf{v})"},{"Type":"NodeText","Data":"，以数学的方式来表达这一点，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"G_{1}(\\mathbf{m}, \\mathbf{v})"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"给出了沿观察方向"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"，具有法线"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\mathbf{m}"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"的可见微表面的比例"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240606084244-odsdgwv","Type":"NodeParagraph","Properties":{"id":"20240606084244-odsdgwv","updated":"20240606084412"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{1}(\\mathbf{m}, \\mathbf{v})D(\\mathbf{m})(\\mathbf{n} \\cdot \\mathbf{m})^+"},{"Type":"NodeText","Data":"的球面积分，则给出了在垂直于观察方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v }"},{"Type":"NodeText","Data":"的平面上，宏表面的投影面积，即："}]},{"ID":"20240606084410-x5nzsmh","Type":"NodeMathBlock","Properties":{"id":"20240606084410-x5nzsmh","updated":"20240606094635"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\int_{\\in \\Theta} G_{1}(\\mathbf{m}, \\mathbf{v}) D(\\mathbf{m})(\\mathbf{v} \\cdot \\mathbf{m})^{+} d \\mathbf{m}=\\mathbf{v} \\cdot \\mathbf{n}\n\\tag{9.23}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240606084424-ssnfw17","Type":"NodeParagraph","Properties":{"id":"20240606084424-ssnfw17","updated":"20240606084621"},"Children":[{"Type":"NodeText","Data":"图9.32展示了方程所描述的过程。与方程9.22有所不同的是，方程9.23中的点积被限制到0，位于背面的微表面是不可见的，所以在这种情况下它们并不会被计算在内。向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{1}(\\mathbf{m}, \\mathbf{v}) D(\\mathbf{m})"},{"Type":"NodeText","Data":"与可见法线的分布（distribution of visible normal）有关[708]。"}]},{"ID":"20240606084720-33hu39z","Type":"NodeParagraph","Properties":{"id":"20240606084720-33hu39z","updated":"20240606084721"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240606084720-7mqozgx.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240606084724-wqijq2j","Type":"NodeParagraph","Properties":{"id":"20240606084724-wqijq2j","style":"text-align: center;","updated":"20240606084727"},"Children":[{"Type":"NodeText","Data":"图9.32：对可见微表面（亮红色）的投影面积进行积分，能够得到垂直于观察方向 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":" 的平面上的宏表面投影面积。"}]},{"ID":"20240606084727-k0557af","Type":"NodeParagraph","Properties":{"id":"20240606084727-k0557af","updated":"20240609093402"},"Children":[{"Type":"NodeText","Data":"虽然方程9.23对"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{1}(\\mathbf{m}, \\mathbf{v})"},{"Type":"NodeText","Data":"施加了一些约束，但是却无法唯一地决定它。对于给定的微表面法线分布"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"D(\\mathbf{m})"},{"Type":"NodeText","Data":"[708]，存在无数个masking函数满足约束条件。这是因为"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"D(\\mathbf{m})"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"并不能完全决定微表面的全部细节，它仅仅告诉了我们有多少个微表面的法线指向了这个方向，但是却没有告诉我们这些法线具体的排列方式"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240609093628-gn29co0","Type":"NodeParagraph","Properties":{"id":"20240609093628-gn29co0","updated":"20240609093743"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"assets/0708_JCGT_2014_Understanding_the_Masking-Shadowing_Function_in_Microfacet-Based_BRDFs-20240609093628-n7fii75.pdf","TextMarkTextContent":"[0708]Understanding_the_Masking-Shadowing_Function_in_Microfacet-Based_BRDFs"},{"Type":"NodeText","Data":"这篇论文证明了Smith masking函数是唯一一个可能既服从方程9.23，又具有法线-masking独立性的函数。"}]},{"ID":"20240609093630-t0n2uqw","Type":"NodeBlockquote","Properties":{"id":"20240609093630-t0n2uqw","updated":"20240609093827"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240609093805-33o9b0t","Type":"NodeParagraph","Properties":{"id":"20240609093805-33o9b0t","updated":"20240609093827"},"Children":[{"Type":"NodeText","Data":"法线-masking独立性: 意味着函数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{1}(\\mathbf{m}, \\mathbf{v})"},{"Type":"NodeText","Data":"并不依赖于微表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{m}"},{"Type":"NodeText","Data":"的方向，只要这个"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{m}"},{"Type":"NodeText","Data":"不朝向背面即可，即只要"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{m} \\cdot \\mathbf{v} \\ge 0"},{"Type":"NodeText","Data":"即可。"}]}]},{"ID":"20240609093827-gzpi8c5","Type":"NodeParagraph","Properties":{"id":"20240609093827-gzpi8c5","updated":"20240609093842"}},{"ID":"20240609093842-p3am4aw","Type":"NodeParagraph","Properties":{"id":"20240609093842-p3am4aw","updated":"20240609095923"},"Children":[{"Type":"NodeText","Data":"Smith "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{1}"},{"Type":"NodeText","Data":"函数的数学形式如下："}]},{"ID":"20240609093848-ai4aga3","Type":"NodeMathBlock","Properties":{"id":"20240609093848-ai4aga3","updated":"20240609093856"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"G_{1}(\\mathbf{m}, \\mathbf{v})=\\frac{\\chi^{+}(\\mathbf{m} \\cdot \\mathbf{v})}{1+\\Lambda(\\mathbf{v})}\n\\tag{9.24}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240609093842-75x67u1","Type":"NodeParagraph","Properties":{"id":"20240609093842-75x67u1","updated":"20240609093845"},"Children":[{"Type":"NodeText","Data":"其中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\chi^{+}"},{"Type":"NodeText","Data":"是正特征函数："}]},{"ID":"20240609093904-zdcgg6k","Type":"NodeMathBlock","Properties":{"id":"20240609093904-zdcgg6k","updated":"20240609093907"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\chi^{+}(x)=\\left\\{\\begin{array}{ll}1, \u0026 \\text { where } x\u003e0, \\\\ 0, \u0026 \\text { where } x \\leq 0 .\\end{array}\\right.\n\\tag{9.25}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240609093842-d1l501q","Type":"NodeParagraph","Properties":{"id":"20240609093842-d1l501q","updated":"20240609100010"},"Children":[{"Type":"NodeText","Data":"每个NDF的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\Lambda（lambda）"},{"Type":"NodeText","Data":"函数都是不同的。Walter[1833]和Heitz[708]描述了为给定NDF推导"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\Lambda"},{"Type":"NodeText","Data":"的过程。"}]},{"ID":"20240609093907-64lwx4y","Type":"NodeParagraph","Properties":{"id":"20240609093907-64lwx4y","updated":"20240609093941"},"Children":[{"Type":"NodeText","Data":"Smith masking函数确实存在一些缺点。"}]},{"ID":"20240609093948-gx1kxpa","Type":"NodeList","ListData":{},"Properties":{"id":"20240609093948-gx1kxpa","updated":"20240609094001"},"Children":[{"ID":"20240609093952-iwprj9k","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609093952-iwprj9k","updated":"20240609093952"},"Children":[{"ID":"20240609093952-mjoukmr","Type":"NodeParagraph","Properties":{"id":"20240609093952-mjoukmr","updated":"20240609093952"},"Children":[{"Type":"NodeText","Data":"从理论的角度来看，它的函数需求与实际的表面结构并不一致[708]，甚至可能在物理上无法实现[657]。"}]}]},{"ID":"20240609093952-0p7dc85","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240609093952-0p7dc85","updated":"20240609094001"},"Children":[{"ID":"20240609093952-6be0ewy","Type":"NodeParagraph","Properties":{"id":"20240609093952-6be0ewy","updated":"20240609094001"},"Children":[{"Type":"NodeText","Data":"从实践的角度来看，虽然它对随机表面的模拟是相当准确的，但是对于法线方向和masking之间具有较强依赖性的表面（如图9.28所展示的表面），尤其是当该表面具有一些重复结构的时候（例如大多数织物），Smith masking函数的准确性预计会下降。"}]}]}]},{"ID":"20240609094000-53jvvnz","Type":"NodeParagraph","Properties":{"id":"20240609094000-53jvvnz","updated":"20240609094027"},"Children":[{"Type":"NodeText","Data":"但是目前（2024年6月9日09:40:17）还是大多数渲染程序的最佳选择。"}]},{"ID":"20240609094027-8yopfjk","Type":"NodeParagraph","Properties":{"id":"20240609094027-8yopfjk","updated":"20240609094116"},"Children":[{"Type":"NodeText","Data":"对于一个给定给定微观几何描述，包含如下几部分：micro-BRDF项"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"f_{\\mu}(\\mathbf{l}, \\mathbf{v}, \\mathbf{m})"},{"Type":"NodeText","Data":"，法线分布函数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"D(\\mathbf{m})"},{"Type":"NodeText","Data":"，以及遮挡函数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{1}(\\mathbf{m}, \\mathbf{v})"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240609094112-guf0r16","Type":"NodeParagraph","Properties":{"id":"20240609094112-guf0r16","updated":"20240609094138"},"Children":[{"Type":"NodeText","Data":"据此可以推导出宏表面的BRDF[708, 1833]："}]},{"ID":"20240609094138-c5yez2k","Type":"NodeMathBlock","Properties":{"id":"20240609094138-c5yez2k","updated":"20240609094854"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"f(\\mathbf{l}, \\mathbf{v})=\\int_{\\mathbf{m} \\in \\Omega} f_{\\mu}(\\mathbf{l}, \\mathbf{v}, \\mathbf{m}) G_{2}(\\mathbf{l}, \\mathbf{v}, \\mathbf{m}) D(\\mathbf{m}) \\frac{(\\mathbf{m} \\cdot \\mathbf{l})^{+}}{|\\mathbf{n} \\cdot \\mathbf{l}|} \\frac{(\\mathbf{m} \\cdot \\mathbf{v})^{+}}{|\\mathbf{n} \\cdot \\mathbf{v}|} d \\mathbf{m}.\n\\tag{9.26}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240609094144-7598b4c","Type":"NodeParagraph","Properties":{"id":"20240609094144-7598b4c","updated":"20240609094949"},"Children":[{"Type":"NodeText","Data":"此积分在以法线 "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":" 为中心的半球"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\Omega"},{"Type":"NodeText","Data":"上进行的，从而避免计算从表面下方照射来的光线贡献。其中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{2}(\\mathbf{l}, \\mathbf{v}, \\mathbf{m})"},{"Type":"NodeText","Data":"，来代替遮挡函数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{1}(\\mathbf{m}, \\mathbf{v})"},{"Type":"NodeText","Data":"。这个函数是从"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{1}"},{"Type":"NodeText","Data":"中推导出来的。给出了在两个方向上具有法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{m}"},{"Type":"NodeText","Data":"的可见微表面的比例，这两个方向分别是观察方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeText","Data":"和光线方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"。通过引入"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{2}"},{"Type":"NodeText","Data":"函数，方程9.26使得BRDF能够同时考虑shadowing和masking对着色的影响，但是并没有考虑微表面之间的相互反射，这样的BRDF看起来要比真实情况暗一些。"}]},{"ID":"20240609094309-thjp10y","Type":"NodeParagraph","Properties":{"id":"20240609094309-thjp10y","updated":"20240609095047"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{2}"},{"Type":"NodeText","Data":"函数有几个版本："}]},{"ID":"20240609095048-uhysdw8","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240609095048-uhysdw8","updated":"20240609095340"},"Children":[{"ID":"20240609095113-zn5e5pw","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240609095113-zn5e5pw","updated":"20240609095340"},"Children":[{"ID":"20240609095113-rhvaq41","Type":"NodeParagraph","Properties":{"id":"20240609095113-rhvaq41","updated":"20240609095119"},"Children":[{"Type":"NodeText","Data":"最简单的是可分离形式："}]},{"ID":"20240609095119-1zx3mbk","Type":"NodeMathBlock","Properties":{"id":"20240609095119-1zx3mbk","updated":"20240609095156"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"G_{2}(\\mathbf{l}, \\mathbf{v}, \\mathbf{m})=G_{1}(\\mathbf{v}, \\mathbf{m}) G_{1}(\\mathbf{l}, \\mathbf{m}).\n\\tag{9.27}\n"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240609095150-v30woj8","Type":"NodeParagraph","Properties":{"id":"20240609095150-v30woj8","updated":"20240609095202"},"Children":[{"Type":"NodeText","Data":"这种形式的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{2}"},{"Type":"NodeText","Data":"函数相当于假设shadowing和masking是两个不相关的事件，但是在现实中它们并非如此，并且这种假设会导致使用该"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{2}"},{"Type":"NodeText","Data":"函数的BRDF过暗。"}]},{"ID":"20240609095331-7hcd7aa","Type":"NodeBlockquote","Properties":{"id":"20240609095331-7hcd7aa","updated":"20240609095340"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240609095332-1y00u8e","Type":"NodeParagraph","Properties":{"id":"20240609095332-1y00u8e","updated":"20240609095340"},"Children":[{"Type":"NodeText","Data":"举一个极端的例子，当观察方向与光线方向相同时，在这种情况下，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{2}"},{"Type":"NodeText","Data":"应当等于"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{1}"},{"Type":"NodeText","Data":"，因为没有任何一个可见的微表面被shadowing，但是根据方程9.27，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{2}"},{"Type":"NodeText","Data":"将等于"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{1} ^2"},{"Type":"NodeText","Data":"。"}]}]}]}]},{"ID":"20240609095105-7f0l8hn","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240609095105-7f0l8hn","updated":"20240609095550"},"Children":[{"ID":"20240609095237-ynezna9","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240609095237-ynezna9","updated":"20240609095550"},"Children":[{"ID":"20240609095237-t1ba47l","Type":"NodeParagraph","Properties":{"id":"20240609095237-t1ba47l","updated":"20240609095317"},"Children":[{"Type":"NodeText","Data":"如果微表面是一个高度场的话（在渲染中通常会使用高度场来作为微表面模型），那么每当观察方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeText","Data":"和光线方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"之间的相对方位角"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi"},{"Type":"NodeText","Data":"等于"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"0^{\\circ}"},{"Type":"NodeText","Data":"时（如图9.17中的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi"},{"Type":"NodeText","Data":"），"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{2}(\\mathbf{l}, \\mathbf{v}, \\mathbf{m})"},{"Type":"NodeText","Data":"应当等于"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\min(G_{1}(\\mathbf{v}, \\mathbf{m}),G_{1}(\\mathbf{l}, \\mathbf{m}))"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240609095319-6gzipht","Type":"NodeMathBlock","Properties":{"id":"20240609095319-6gzipht","updated":"20240609095327"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{aligned}{}\nG_{2}(\\mathbf{l}, \\mathbf{v}, \\mathbf{m})\u0026=\\lambda(\\phi) G_{1}(\\mathbf{v}, \\mathbf{m}) G_{1}(\\mathbf{l}, \\mathbf{m})\\\\\n\u0026+(1-\\lambda(\\phi)) \\min \\left(G_{1}(\\mathbf{v}, \\mathbf{m}), G_{1}(\\mathbf{l}, \\mathbf{m})\\right)\n\\end{aligned}{}\n\\tag{9.28}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240609095414-3xczjr3","Type":"NodeParagraph","Properties":{"id":"20240609095414-3xczjr3","updated":"20240609095506"},"Children":[{"Type":"NodeText","Data":"其中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\lambda(\\phi)"},{"Type":"NodeText","Data":"是某种随着角"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi"},{"Type":"NodeText","Data":"的增大，从0逐渐增加到1的函数。可以使用标准差为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"15^{\\circ}"},{"Type":"NodeText","Data":"的高斯分布函数[Ashikmin, 78]："}]},{"ID":"20240609095446-jkc3v22","Type":"NodeMathBlock","Properties":{"id":"20240609095446-jkc3v22","updated":"20240609095508"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\lambda(\\phi)=1-e^{-7.3 \\phi^{2}}\n\\tag{9.29}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240609095509-84cchiz","Type":"NodeParagraph","Properties":{"id":"20240609095509-84cchiz","updated":"20240609095540"},"Children":[{"Type":"NodeText","Data":"也有不同的选择[van Ginneken, 534]："}]},{"ID":"20240609095540-czf6y8o","Type":"NodeMathBlock","Properties":{"id":"20240609095540-czf6y8o","updated":"20240609095550"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\lambda(\\phi)=\\frac{4.41 \\phi}{4.41 \\phi+1}\n\\tag{9.30}"},{"Type":"NodeMathBlockCloseMarker"}]}]}]},{"ID":"20240609095551-lag3xts","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240609095551-lag3xts","updated":"20240609095802"},"Children":[{"ID":"20240609095553-6x4oryw","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240609095553-6x4oryw","updated":"20240609095802"},"Children":[{"ID":"20240609095553-ricxyac","Type":"NodeParagraph","Properties":{"id":"20240609095553-ricxyac","updated":"20240609095606"},"Children":[{"Type":"NodeText","Data":"无论观察方向和光线方向是否对齐，在给定表面点上的shadowing和masking仍然是相关的，这还有另一个原因，即二者都与表面点相对于曲面其他部分的高度有关。"}]},{"ID":"20240609095631-m0s5760","Type":"NodeParagraph","Properties":{"id":"20240609095631-m0s5760","updated":"20240609095637"},"Children":[{"Type":"NodeText","Data":"如果使用Smith masking函数的话，那么二者的相关性可以用Smith高度相关的masking-shadowing函数来精确地解释："}]},{"ID":"20240609095638-v30a7fb","Type":"NodeMathBlock","Properties":{"id":"20240609095638-v30a7fb","updated":"20240609095644"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"G_{2}(\\mathbf{l}, \\mathbf{v}, \\mathbf{m})=\\frac{\\chi^{+}(\\mathbf{m} \\cdot \\mathbf{v}) \\chi^{+}(\\mathbf{m} \\cdot \\mathbf{l})}{1+\\Lambda(\\mathbf{v})+\\Lambda(\\mathbf{l})}\n\\tag{9.31}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240609095705-2c7lhj4","Type":"NodeParagraph","Properties":{"id":"20240609095705-2c7lhj4","updated":"20240609095738"},"Children":[{"Type":"NodeText","Data":"Heitz也同样给个出来结合方向相关性和高度相关性的Smith "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G__esc_newline_2"},{"Type":"NodeText","Data":"函数："}]},{"ID":"20240609095739-5ir9q5a","Type":"NodeMathBlock","Properties":{"id":"20240609095739-5ir9q5a","updated":"20240609095749"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"G_{2}(\\mathbf{l}, \\mathbf{v}, \\mathbf{m})=\\frac{\\chi^{+}(\\mathbf{m} \\cdot \\mathbf{v}) \\chi^{+}(\\mathbf{m} \\cdot \\mathbf{l})}{1+\\max (\\Lambda(\\mathbf{v}), \\Lambda(\\mathbf{l}))+\\lambda(\\mathbf{v}, \\mathbf{l}) \\min (\\Lambda(\\mathbf{v}), \\Lambda(\\mathbf{l}))}\n\\tag{9.32}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240609095754-9n5ax12","Type":"NodeParagraph","Properties":{"id":"20240609095754-9n5ax12","updated":"20240609095802"},"Children":[{"Type":"NodeText","Data":"其中的函数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\lambda(\\mathbf{v}, \\mathbf{l})"},{"Type":"NodeText","Data":"可以是一个经验函数，如方程9.29和方程9.30所描述的函数，也可以是一个专门为给定的NDF 推导出来的函数"}]}]}]},{"ID":"20240609095749-k7hpl1d","Type":"NodeParagraph","Properties":{"id":"20240609095749-k7hpl1d","updated":"20240609095907"},"Children":[{"Type":"NodeText","Data":"这些方案中Heitz [708]推荐了Smith函数的高度相关形式（方程9.31），因为它与高度不相关形式的Smith函数，具有相似的开销和更好的准确性。"}]},{"ID":"20240609100019-d91veg9","Type":"NodeParagraph","Properties":{"id":"20240609100019-d91veg9","updated":"20240609100045"},"Children":[{"Type":"NodeText","Data":"方程9.26中描述的微表面BRDF不会直接用于渲染，而是在给定micro-"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"BRDFf_{\\mu}"},{"Type":"NodeText","Data":"的情况下，推导出一个封闭形式的解（精确解或者近似解）。"}]},{"ID":"20240609100045-u82qwdz","Type":"NodeParagraph","Properties":{"id":"20240609100045-u82qwdz","updated":"20240609100051"},"Children":[{"Type":"NodeText","Data":"我们将在下一小节中，展示这种派生类型的第一个例子。"}]},{"ID":"20240609100053-2aslus1","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240609100053-2aslus1","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.8 表面反射的BRDF模型"}]},{"ID":"20240609100100-w49lr8d","Type":"NodeParagraph","Properties":{"id":"20240609100100-w49lr8d","updated":"20240609100235"},"Children":[{"Type":"NodeText","Data":"除了少数例外情况，在基于物理的渲染中所使用的镜面BRDF项，都来源于微表面理论。在镜面反射的情况下，每个微表面都是一个完美光滑的菲涅尔镜面。"}]},{"ID":"20240609100428-8llxvxa","Type":"NodeBlockquote","Properties":{"id":"20240609100428-8llxvxa","updated":"20240609100740"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240609100740-28c1d47","Type":"NodeParagraph","Properties":{"id":"20240609100740-28c1d47","updated":"20240609100740"},"Children":[{"Type":"NodeText","Data":"这样的镜面会将每束入射光线，都反射到一个单一的反射方向上。"}]}]},{"ID":"20240609100839-ojy5k00","Type":"NodeParagraph","Properties":{"id":"20240609100839-ojy5k00","updated":"20240609102528"},"Children":[{"Type":"NodeText","Data":"意味着除非观察方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeText","Data":"刚好与光线的出射方向平行，不然每个表面的micro-BRDF"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"f_{\\mu}(\\mathbf{l}, \\mathbf{v}, \\mathbf{m})"},{"Type":"NodeText","Data":"都等于零。而对于给定的观察方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeText","Data":"和光线入射方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"，这种情况相当于微表面的法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{m}"},{"Type":"NodeText","Data":"，与"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}和\\mathbf{l}"},{"Type":"NodeText","Data":"的中间向量对齐，这个中间向量被称为半向量（half vector）"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{h}"},{"Type":"NodeText","Data":"，如图9.33所示。"}]},{"ID":"20240609102533-phr16p8","Type":"NodeParagraph","Properties":{"id":"20240609102533-phr16p8","updated":"20240609102533"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240609102533-ax6dxxz.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240609102538-dhxfqh5","Type":"NodeParagraph","Properties":{"id":"20240609102538-dhxfqh5","style":"text-align: center;","updated":"20240609102546"},"Children":[{"Type":"NodeText","Data":"图9.33：半向量 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{h}"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":" 与观察方向 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":" 和光线入射方向 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":" 的夹角 （用红色表示） 相等。"}]},{"ID":"20240609102548-nz9dg9g","Type":"NodeParagraph","Properties":{"id":"20240609102548-nz9dg9g","updated":"20240609102900"},"Children":[{"Type":"NodeText","Data":"半向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{h}"},{"Type":"NodeText","Data":"是通过将观察方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeText","Data":"和光线入射方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"相加，并将结果进行归一化计算而来的："}]},{"ID":"20240609102900-n5cw2wf","Type":"NodeMathBlock","Properties":{"id":"20240609102900-n5cw2wf","updated":"20240609102906"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{h}=\\frac{1+\\mathbf{v}}{\\|\\mathbf{l}+\\mathbf{v}\\|}\n\\tag{9.33}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240609102906-jxvjloh","Type":"NodeParagraph","Properties":{"id":"20240609102906-jxvjloh","updated":"20240609103145"},"Children":[{"Type":"NodeText","Data":"菲涅尔镜面的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"micro-BRDFf_{\\mu}(\\mathbf{l}, \\mathbf{v}, \\mathbf{m})"},{"Type":"NodeText","Data":"对于所有"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{m} \\ne \\mathbf{h}"},{"Type":"NodeText","Data":"时的情况都为零，当我们从方程9.26中推导高光微表面模型的时候，这个事实是十分方便的，因为它将原本的积分形式退化为了在"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{m} = \\mathbf{h}"},{"Type":"NodeText","Data":"处，对被积函数进行求值。这样就做可以得到高光BRDF项："}]},{"ID":"20240609103001-a7sphvl","Type":"NodeMathBlock","Properties":{"id":"20240609103001-a7sphvl","updated":"20240609103433"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"f_{\\text {spec }}(\\mathbf{l}, \\mathbf{v})=\\frac{F(\\mathbf{h}, \\mathbf{l}) G_{2}(\\mathbf{l}, \\mathbf{v}, \\mathbf{h}) D(\\mathbf{h})}{4|\\mathbf{n} \\cdot \\mathbf{l}||\\mathbf{n} \\cdot \\mathbf{v}|}\n\\tag{9.34}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240609103009-8m09c9s","Type":"NodeParagraph","Properties":{"id":"20240609103009-8m09c9s","updated":"20240609103216"},"Children":[{"Type":"NodeText","Data":"我们使用符号"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"f_{\\text {spec }}"},{"Type":"NodeText","Data":"来表示方程9.34中的BRDF项，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"代表了它模拟了表面反射（镜面反射）现象。在一个完整的BRDF实现中，它可能还会加上一个用于模拟次表面（漫反射）着色的额外项"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240609103217-69yqdhs","Type":"NodeParagraph","Properties":{"id":"20240609103217-69yqdhs","updated":"20240609103408"},"Children":[{"Type":"NodeText","Data":"有关这个推导的详细过程，可以在Walter等人[1833]、Heitz [708]和Hammon [657]的出版物中找到。"}]},{"ID":"20240609103410-97k3x06","Type":"NodeParagraph","Properties":{"id":"20240609103410-97k3x06","updated":"20240610100137"},"Children":[{"Type":"NodeText","Data":"可以如下理解方程9.34中的各项："}]},{"ID":"20240610100138-14r55r4","Type":"NodeParagraph","Properties":{"id":"20240610100138-14r55r4","updated":"20240610100152"},"Children":[{"Type":"NodeText","Data":"只有那些法线与半向量碰巧对齐（"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{m} = \\mathbf{h}"},{"Type":"NodeText","Data":"）的微表面，才能正确地将光线从入射方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"反射到观察方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeText","Data":"上，如图9.34所示。"}]},{"ID":"20240610100155-4cslgkn","Type":"NodeParagraph","Properties":{"id":"20240610100155-4cslgkn","updated":"20240610100155"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240610100155-t8w3ifi.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240610100159-w8174hz","Type":"NodeParagraph","Properties":{"id":"20240610100159-w8174hz","style":"text-align: center;","updated":"20240610100217"},"Children":[{"Type":"NodeText","Data":"图9.34：由微表面构成的表面。只有微表面法线与半向量"},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{h} "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":"对齐的那部分（图中红色的微表面），才会参与从入射方向"},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"l﻿ "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":"到观察方向"},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":" \\mathbf{v} "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":"的光线反射。"}]},{"ID":"20240610100207-qylstdi","Type":"NodeList","ListData":{},"Properties":{"id":"20240610100207-qylstdi","updated":"20240610100417"},"Children":[{"ID":"20240610100309-sk78c6o","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240610100309-sk78c6o","updated":"20240610100309"},"Children":[{"ID":"20240610100309-j1i8ssk","Type":"NodeParagraph","Properties":{"id":"20240610100309-j1i8ssk","updated":"20240610100315"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"D(\\mathbf{h})"},{"Type":"NodeText","Data":"：反射光线的数量取决于微表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{m}"},{"Type":"NodeText","Data":"与半向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{h}"},{"Type":"NodeText","Data":"的对齐程度，这个值是通过"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"D(\\mathbf{h})"},{"Type":"NodeText","Data":"项给出的"}]}]},{"ID":"20240610100316-e99per1","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240610100316-e99per1"},"Children":[{"ID":"20240610100316-hu0l479","Type":"NodeParagraph","Properties":{"id":"20240610100316-hu0l479","updated":"20240610100334"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{2}(\\mathbf{l}, \\mathbf{v}, \\mathbf{h})"},{"Type":"NodeText","Data":"："},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_{2}(\\mathbf{l}, \\mathbf{v}, \\mathbf{h})"},{"Type":"NodeText","Data":"给出了从光线入射方向和相机观察方向都可见的微表面比例"}]}]},{"ID":"20240610100336-at2cpy7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240610100336-at2cpy7","updated":"20240610100417"},"Children":[{"ID":"20240610100336-zm50ita","Type":"NodeParagraph","Properties":{"id":"20240610100336-zm50ita","updated":"20240610100417"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F(\\mathbf{h}, \\mathbf{l})"},{"Type":"NodeText","Data":"："},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"F(\\mathbf{h}, \\mathbf{l})"},{"Type":"NodeText","Data":"给出了每个微表面反射光线的比例。这里在计算菲涅尔函数的时候，使用了半向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{h}"},{"Type":"NodeText","Data":"来代替表面法线"}]}]}]},{"ID":"20240610100253-vp9fkmr","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240610100253-vp9fkmr","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"9.8.1 法线分布函数"}]},{"ID":"20240610100603-dwn2kz9","Type":"NodeParagraph","Properties":{"id":"20240610100603-dwn2kz9","updated":"20240610100626"},"Children":[{"Type":"NodeText","Data":"法线分布函数（normal distribution function，NDF）对于要渲染的表面外观具有十分重要的影响。"}]},{"ID":"20240610100627-8bc6jpe","Type":"NodeList","ListData":{},"Properties":{"id":"20240610100627-8bc6jpe","updated":"20240610100638"},"Children":[{"ID":"20240610100628-ghx6jep","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240610100628-ghx6jep","updated":"20240610100628"},"Children":[{"ID":"20240610100628-vu7c121","Type":"NodeParagraph","Properties":{"id":"20240610100628-vu7c121","updated":"20240610100632"},"Children":[{"Type":"NodeText","Data":"NDF的形状（将其绘制在微平面法线的球体上）决定了反射光锥（镜面波瓣）的宽度和形状，反过来又决定了高光的大小和形状。"}]}]},{"ID":"20240610100633-mrvcuha","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240610100633-mrvcuha","updated":"20240610100638"},"Children":[{"ID":"20240610100633-zss5c8k","Type":"NodeParagraph","Properties":{"id":"20240610100633-zss5c8k","updated":"20240610100638"},"Children":[{"Type":"NodeText","Data":"NDF影响了表面粗糙度的整体感知，以及一些更加微妙的视觉表现，例如高光是否具有明显的边缘，还是具有一个模糊（haze）的边缘。"}]}]}]},{"ID":"20240610100638-8qvi7c2","Type":"NodeParagraph","Properties":{"id":"20240610100638-8qvi7c2","updated":"20240610100853"},"Children":[{"Type":"NodeText","Data":"然而，镜面波瓣（specular lobe）并不是NDF形状的简单复制。"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"镜面波瓣（也就是高光形状）被扭曲的程度还取决于表面曲率和观察视角"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240610100737-bg6udn1","Type":"NodeParagraph","Properties":{"id":"20240610100737-bg6udn1","updated":"20240610100741"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240610100737-6hokiwb.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"图9.35：最左边的图像是使用非物理的Phong反射模型渲染而来的，这个模型的镜面波瓣关于光线的反射向量旋转对称，类似这种的BRDF在早期的计算机图形学中被经常使用。中间的图像使用基于物理的微表面BRDF进行渲染。第一行左侧和第一行中间的图片，展示了一个以掠射角度进行光照的平面，其中第一行左侧展示了一个不正确的圆形高光，而第一行中间展示的是微表面BRDF所特有的延伸高光，这个效果是与现实相符的，如右边的照片所示。高光形状的差异在下面两个渲染球体上则要不易察觉得多，因为在这种球面的情况下，表面曲率才是是高光形状的主要影响因素。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240610100742-q0of985","Type":"NodeParagraph","Properties":{"id":"20240610100742-q0of985","updated":"20240610100845"},"Children":[{"Type":"NodeText","Data":"当从掠射视角观察平面的时候，这种畸变（distortion）会尤其强烈。"}]},{"ID":"20240610100853-bwezbhv","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240610100853-bwezbhv","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"各向同性法线分布函数"}]},{"ID":"20240610100910-jaa2jv2","Type":"NodeParagraph","Properties":{"id":"20240610100910-jaa2jv2","updated":"20240610101138"},"Children":[{"Type":"NodeText","Data":"在渲染中所使用的大多数NDF都是各向同性的（isotropic），即"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"关于宏表面法线"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"旋转对称"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。在这种情况下，NDF的变量只有一个，即宏表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"与微表面法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{m}"},{"Type":"NodeText","Data":"之间的夹角"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":" \\theta _m"},{"Type":"NodeText","Data":"。在理想情况下，NDF可以写成一个关于"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":" \\cos \\theta _m"},{"Type":"NodeText","Data":"的表达式，可以通过计算"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}和\\mathbf{m}"},{"Type":"NodeText","Data":"之间的点乘来快速获得"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":" \\cos \\theta _m"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240610102548-l4ef7bs","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240610102548-l4ef7bs","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"Beckmann NDF"}]},{"ID":"20240610101110-s2kidkl","Type":"NodeParagraph","Properties":{"id":"20240610101110-s2kidkl","updated":"20240610102556"},"Children":[{"Type":"NodeText","Data":"Beckmann NDF [124]是光学界开发的、第一个微表面模型中所使用的法线分布函数，其归一化分布数学形式如下："}]},{"ID":"20240610101211-491yoc1","Type":"NodeMathBlock","Properties":{"id":"20240610101211-491yoc1","updated":"20240610102556"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"D(\\mathbf{m})=\\frac{\\chi^{+}(\\mathbf{n} \\cdot \\mathbf{m})}{\\pi \\alpha_{b}^{2}(\\mathbf{n} \\cdot \\mathbf{m})^{4}} \\exp \\left(\\frac{(\\mathbf{n} \\cdot \\mathbf{m})^{2}-1}{\\alpha_{b}^{2}(\\mathbf{n} \\cdot \\mathbf{m})^{2}}\\right)\n\\tag{9.35}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610101217-gn5umj2","Type":"NodeParagraph","Properties":{"id":"20240610101217-gn5umj2","updated":"20240610102556"},"Children":[{"Type":"NodeText","Data":"其中的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\chi^{+}(\\mathbf{n} \\cdot \\mathbf{m})"},{"Type":"NodeText","Data":"项确保了所有指向宏表面下方的微表面法线的NDF值为0，这个性质告诉我们，与我们将在本小节所讨论的其他所有NDF一样，这个NDF描述了一个高度场微表面。"}]},{"ID":"20240610101308-jlhpz6r","Type":"NodeParagraph","Properties":{"id":"20240610101308-jlhpz6r","updated":"20240610102556"},"Children":[{"Type":"NodeText","Data":"方程中的参数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{b}"},{"Type":"NodeText","Data":"控制了表面的粗糙度，它与微观几何表面的均方根（root mean square，RMS）斜率成正比，即"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\alpha_{b} = 0"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"代表了一个完全光滑的表面"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240610101435-tmej70n","Type":"NodeParagraph","Properties":{"id":"20240610101435-tmej70n","updated":"20240610102556"},"Children":[{"Type":"NodeText","Data":"Beckmann NDF是形状不变的，可以写成如下形式[708]："}]},{"ID":"20240610101733-bxvm83c","Type":"NodeMathBlock","Properties":{"id":"20240610101733-bxvm83c","updated":"20240610102556"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"D(\\mathbf{m})=\\frac{\\chi^{+}(\\mathbf{n} \\cdot \\mathbf{m})}{\\alpha^{2}(\\mathbf{n} \\cdot \\mathbf{m})^{4}} g\\left(\\frac{\\sqrt{1-(\\mathbf{n} \\cdot \\mathbf{m})^{2}}}{\\alpha(\\mathbf{n} \\cdot \\mathbf{m})}\\right)\n\\tag{9.36}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610101743-bra1fr9","Type":"NodeParagraph","Properties":{"id":"20240610101743-bra1fr9","updated":"20240610102556"},"Children":[{"Type":"NodeText","Data":"其中的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"g"},{"Type":"NodeText","Data":"代表了一个任意的单变量函数。"}]},{"ID":"20240610101756-2l2vwm2","Type":"NodeParagraph","Properties":{"id":"20240610101756-2l2vwm2","updated":"20240610102556"},"Children":[{"Type":"NodeText","Data":"对于一个任意的各向同性NDF，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\Lambda "},{"Type":"NodeText","Data":"函数取决于两个变量：第一个变量是粗糙度"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha"},{"Type":"NodeText","Data":"，第二个变量是计算"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"  \\Lambda "},{"Type":"NodeText","Data":"的向量入射角"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"（\\mathbf{v}或者\\mathbf{l}）"},{"Type":"NodeText","Data":"。然而，对于形状不变的NDF而言，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"  \\Lambda "},{"Type":"NodeText","Data":"函数只依赖于变量a："}]},{"ID":"20240610101844-x8pgts3","Type":"NodeMathBlock","Properties":{"id":"20240610101844-x8pgts3","updated":"20240610102556"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"a=\\frac{\\mathbf{n} \\cdot \\mathbf{s}}{\\alpha \\sqrt{1-(\\mathbf{n} \\cdot \\mathbf{s})^{2}}}\n\\tag{9.37}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610101953-v64ndvl","Type":"NodeParagraph","Properties":{"id":"20240610101953-v64ndvl","updated":"20240610102556"},"Children":[{"Type":"NodeText","Data":"其中的向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{s}"},{"Type":"NodeText","Data":"代表了观察方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeText","Data":"或者光线方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"，在这种情况下，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"  \\Lambda "},{"Type":"NodeText","Data":"函数只依赖于一个变量，这十分利于实现，因为单变量函数可以更加容易地使用近似曲线来进行拟合，并且可以在一维数组中打表。"}]},{"ID":"20240610102006-ej4h792","Type":"NodeParagraph","Properties":{"id":"20240610102006-ej4h792","updated":"20240610102556"},"Children":[{"Type":"NodeText","Data":"Beckmann NDF的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\Lambda"},{"Type":"NodeText","Data":"函数为："}]},{"ID":"20240610102400-aq7jfkd","Type":"NodeMathBlock","Properties":{"id":"20240610102400-aq7jfkd","updated":"20240610102556"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\Lambda(a)=\\frac{\\operatorname{erf}(a)-1}{2}+\\frac{1}{2 a \\sqrt{\\pi}} \\exp \\left(-a^{2}\\right)\n\\tag{9.38}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610102404-0mba7cw","Type":"NodeParagraph","Properties":{"id":"20240610102404-0mba7cw","updated":"20240610102556"},"Children":[{"Type":"NodeText","Data":"其计算开销很高，因为包含了误差项"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{erf}"},{"Type":"NodeText","Data":"，因此通常使用近似值："}]},{"ID":"20240610102436-sor6url","Type":"NodeMathBlock","Properties":{"id":"20240610102436-sor6url","updated":"20240610102556"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\Lambda(a) \\approx\\left\\{\\begin{array}{ll}\\frac{1-1.259 a+0.396 a^{2}}{3.535 a+2.181 a^{2}}, \u0026 \\text { where } a\u003c1.6, \\\\ 0, \u0026 \\text { where } a \\geq 1.6 .\\end{array}\\right.\n\\tag{9.39}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610102440-teqrwy0","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240610102440-teqrwy0","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"Blinn-Phong NDF"}]},{"ID":"20240610102607-uyu272k","Type":"NodeParagraph","Properties":{"id":"20240610102607-uyu272k","updated":"20240610102624"},"Children":[{"Type":"NodeText","Data":"Blinn-Phong NDF是由Blinn [159]提出的，作为对Phong着色模型（非基于物理的）的一个修改[1414]："}]},{"ID":"20240610102625-c7q22ru","Type":"NodeMathBlock","Properties":{"id":"20240610102625-c7q22ru","updated":"20240610102629"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"D(\\mathbf{m})=\\chi^{+}(\\mathbf{n} \\cdot \\mathbf{m}) \\frac{\\alpha_{p}+2}{2 \\pi}(\\mathbf{n} \\cdot \\mathbf{m})^{\\alpha_{p}}\n\\tag{9.40}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610102629-gx62ci8","Type":"NodeParagraph","Properties":{"id":"20240610102629-gx62ci8","updated":"20240610102659"},"Children":[{"Type":"NodeText","Data":"方程中的幂次"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{p}"},{"Type":"NodeText","Data":"是Phong NDF的粗糙度参数，较高的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{p}"},{"Type":"NodeText","Data":"代表了较为光滑的表面，而较低的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{p}"},{"Type":"NodeText","Data":"则代表较为粗糙的表面。"}]},{"ID":"20240610102700-mrklc99","Type":"NodeBlockquote","Properties":{"id":"20240610102700-mrklc99","updated":"20240610102714"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240610102701-5uveujm","Type":"NodeParagraph","Properties":{"id":"20240610102701-5uveujm","updated":"20240610102714"},"Children":[{"Type":"NodeText","Data":"我们可以将"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{p}"},{"Type":"NodeText","Data":"的值设置得任意高，从而创建一个极其光滑的表面，而一个完美的镜面则需要令 "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{p} =\\infty"},{"Type":"NodeText","Data":"。通过将"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{p}"},{"Type":"NodeText","Data":"设置为0，可以得到一个随机程度最大的曲面（即均匀NDF）。"}]}]},{"ID":"20240610102715-rs375o4","Type":"NodeParagraph","Properties":{"id":"20240610102715-rs375o4","updated":"20240610102844"},"Children":[{"Type":"NodeText","Data":"参数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{p}"},{"Type":"NodeText","Data":"不便于直接进行操作，因为它的视觉效果是高度非均匀的：当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{p}"},{"Type":"NodeText","Data":"较小时，它对数值变化十分敏感，一点点很小的数值变化，就会在视觉效果上产生很大的变化；当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{p}"},{"Type":"NodeText","Data":"较大时，它对数值变化则不太敏感，一个很大的数值变化，才能让视觉效果发生一点点变化。"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"因此，"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\alpha_{p}"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"通常是通过一个非线性映射，从用户控制的参数推导出来的，例如"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\alpha_{p} = m^s"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"，其中s是一个介于0-1之间的参数，"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"m"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"是"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\alpha_{p}"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"在给定应用程序中的最大上界"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240610102844-lghw23o","Type":"NodeParagraph","Properties":{"id":"20240610102844-lghw23o","updated":"20240610102908"},"Children":[{"Type":"NodeText","Data":"Blinn-Phong NDF并不是形状不变的，其"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"  \\Lambda "},{"Type":"NodeText","Data":"函数不存在解析形式。"}]},{"ID":"20240610102908-6h4uayt","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240610102908-6h4uayt","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"GGX分布"}]},{"ID":"20240610102945-jz8fhas","Type":"NodeParagraph","Properties":{"id":"20240610102945-jz8fhas","updated":"20240610102945"},"Children":[{"Type":"NodeText","Data":"GGX分布的数学表达形式如下："}]},{"ID":"20240610103011-21rfrpx","Type":"NodeMathBlock","Properties":{"id":"20240610103011-21rfrpx","updated":"20240610102945"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"D(\\mathbf{m})=\\frac{\\chi^{+}(\\mathbf{n} \\cdot \\mathbf{m}) \\alpha_{g}^{2}}{\\pi\\left(1+(\\mathbf{n} \\cdot \\mathbf{m})^{2}\\left(\\alpha_{g}^{2}-1\\right)\\right)^{2}}\n\\tag{9.41}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610103015-c6w2ern","Type":"NodeParagraph","Properties":{"id":"20240610103015-c6w2ern","updated":"20240610102945"},"Children":[{"Type":"NodeText","Data":"参数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_g"},{"Type":"NodeText","Data":"由用户控制。"}]},{"ID":"20240610103102-2j3jrbs","Type":"NodeBlockquote","Properties":{"id":"20240610103102-2j3jrbs","updated":"20240610102945"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240610103102-sguul3r","Type":"NodeParagraph","Properties":{"id":"20240610103102-sguul3r","updated":"20240610103113"},"Children":[{"Type":"NodeText","Data":"在Disney原则着色模型中，Burley [214]通过"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{g}=r^{2}"},{"Type":"NodeText","Data":"，将粗糙度控制暴露给用户，其中r是用户可以控制的粗糙度参数，其取值范围在0-1之间。将r作为一个滑动条值暴露出来，意味着其视觉效果的变化更加线性，大多数使用GGX分布的应用都采用了这种映射方式。"}]}]},{"ID":"20240610103113-i84hfpx","Type":"NodeParagraph","Properties":{"id":"20240610103113-i84hfpx","updated":"20240610102945"},"Children":[{"Type":"NodeText","Data":"GGX分布是形状不变的，其"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\Lambda"},{"Type":"NodeText","Data":"比较简单："}]},{"ID":"20240610103130-1i3xqxk","Type":"NodeMathBlock","Properties":{"id":"20240610103130-1i3xqxk","updated":"20240610102945"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\Lambda(a)=\\frac{-1+\\sqrt{1+\\frac{1}{a^{2}}}}{2}\n\\tag{9.42}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610103251-swc2l4m","Type":"NodeParagraph","Properties":{"id":"20240610103251-swc2l4m","updated":"20240610102945"},"Children":[{"Type":"NodeText","Data":"由于GGX分布和Smith masking-shadowing函数的流行，因此人们一直致力于优化这两者的组合。"}]},{"ID":"20240610103258-zulwwl8","Type":"NodeParagraph","Properties":{"id":"20240610103258-zulwwl8","updated":"20240610102945"},"Children":[{"Type":"NodeText","Data":"Lagarde观察到[960]，在GGX中使用高度相关的Smith"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"  G_2 "},{"Type":"NodeText","Data":"函数（方程9.31），在与镜面微表面BRDF的分母（方程9.34）结合时，有几项会被消掉，合并后的项可以简化为如下形式："}]},{"ID":"20240610103309-fos4h6q","Type":"NodeMathBlock","Properties":{"id":"20240610103309-fos4h6q","updated":"20240610102945"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\frac{G_{2}(\\mathbf{l}, \\mathbf{v})}{4|\\mathbf{n} \\cdot \\mathbf{l}||\\mathbf{n} \\cdot \\mathbf{v}|}=\\frac{0.5}{\\mu_{o} \\sqrt{\\alpha^{2}+\\mu_{i}\\left(\\mu_{i}-\\alpha^{2} \\mu_{i}\\right)}+\\mu_{i} \\sqrt{\\alpha^{2}+\\mu_{o}\\left(\\mu_{o}-\\alpha^{2} \\mu_{o}\\right)}}\n\\tag{9.43}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610103315-sjf4a0i","Type":"NodeParagraph","Properties":{"id":"20240610103315-sjf4a0i","updated":"20240610102945"},"Children":[{"Type":"NodeText","Data":"其中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mu_{i}=(\\mathbf{n} \\cdot \\mathbf{l})^{+}"},{"Type":"NodeText","Data":"，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mu_{o}=(\\mathbf{n} \\cdot \\mathbf{v})^{+}"},{"Type":"NodeText","Data":"\n"}]},{"ID":"20240610103420-mqshwsa","Type":"NodeParagraph","Properties":{"id":"20240610103420-mqshwsa","updated":"20240610102945"},"Children":[{"Type":"NodeText","Data":"Karis [861]提出了在GGX中使用的Smith"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"   G_1 "},{"Type":"NodeText","Data":"函数的近似形式："}]},{"ID":"20240610103517-4868zls","Type":"NodeMathBlock","Properties":{"id":"20240610103517-4868zls","updated":"20240610102945"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"G_{1}(\\mathbf{s}) \\approx \\frac{2(\\mathbf{n} \\cdot \\mathbf{s})}{(\\mathbf{n} \\cdot \\mathbf{s})(2-\\alpha)+\\alpha},\n\\tag{9.44}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610103721-rlphbf9","Type":"NodeParagraph","Properties":{"id":"20240610103721-rlphbf9","updated":"20240610103727"},"Children":[{"Type":"NodeText","Data":"方程9.44中的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{s}"},{"Type":"NodeText","Data":"，可以用向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"或者向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeText","Data":"进行替换。"}]},{"ID":"20240610103727-exboe4s","Type":"NodeParagraph","Properties":{"id":"20240610103727-exboe4s","updated":"20240610103743"},"Children":[{"Type":"NodeText","Data":"Hammon表明[657]，这种近似形式的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"   G_1 "},{"Type":"NodeText","Data":"函数，可以对由高度相关的Smith"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"G_2 "},{"Type":"NodeText","Data":"函数和镜面微表面BRDF分母组成的组合项进行有效地近似："}]},{"ID":"20240610103737-08zmbjf","Type":"NodeMathBlock","Properties":{"id":"20240610103737-08zmbjf","updated":"20240610103750"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\frac{G_{2}(\\mathbf{l}, \\mathbf{v})}{4|\\mathbf{n} \\cdot \\mathbf{l}||\\mathbf{n} \\cdot \\mathbf{v}|} \\approx \\frac{0.5}{\\operatorname{lerp}(2|\\mathbf{n} \\cdot \\mathbf{l}||\\mathbf{n} \\cdot \\mathbf{v}|,|\\mathbf{n} \\cdot \\mathbf{l}|+|\\mathbf{n} \\cdot \\mathbf{v}|, \\alpha)},\n\\tag{9.45}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610103750-731wyne","Type":"NodeParagraph","Properties":{"id":"20240610103750-731wyne","updated":"20240610103807"},"Children":[{"Type":"NodeText","Data":"其中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\operatorname{lerp}(x, y, s)=x(1-s)+y s"},{"Type":"NodeText","Data":"\n"}]},{"ID":"20240610103754-w2xywk5","Type":"NodeParagraph","Properties":{"id":"20240610103754-w2xywk5","updated":"20240610103823"},"Children":[{"Type":"NodeText","Data":"当比较图9.36中的GGX分布和Beckmann分布时，很明显二者具有完全不同的形状。GGX的峰值比Beckmann更窄，而围绕这些峰值的“尾巴”则更长。"}]},{"ID":"20240610103827-3e5mp6b","Type":"NodeParagraph","Properties":{"id":"20240610103827-3e5mp6b","updated":"20240610103827"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240610103827-s9mrbp0.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240610103830-lksd5nh","Type":"NodeParagraph","Properties":{"id":"20240610103830-lksd5nh","style":"text-align: center;","updated":"20240610103840"},"Children":[{"Type":"NodeText","Data":"图9.36：左上角：Blinn-Phong分布（蓝色虚线）和Beckmann分布（绿色实线）的对比图，参数"},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":" \\alpha_{b} "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":"在0.025-0.2范围内，并使用了参数关系 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{p}=2 \\alpha_{b}^{-2}-2 "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":"进行粗糙度的转换。右上角：GGX分布（红色实线）和Beckmann分布（绿色实线）的对比图，其中参数"},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":" \\alpha_{b} "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":"的值与左图中的完全相同。通过人眼调节参数"},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":" \\alpha_{g} "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":"的值，来匹配高光大小。底部渲染图中的球体也使用了相同的数值，其中第一行使用了Beckmann NDF，第二行则使用了GGX分布。"}]},{"ID":"20240610103843-z9x24r9","Type":"NodeParagraph","Properties":{"id":"20240610103843-z9x24r9","updated":"20240610103925"},"Children":[{"Type":"NodeText","Data":"在图9.36底部的渲染图中，我们可以看到，GGX较长的拖尾在高光的核心区域周围，产生了一个模糊（haze）或者微光（glow）外观。"}]},{"ID":"20240610104007-4kghg5l","Type":"NodeParagraph","Properties":{"id":"20240610104007-4kghg5l","updated":"20240610104012"},"Children":[{"Type":"NodeText","Data":"真实世界中的许多材质都具有类似的模糊高光，其尾部通常还要比GGX分布的尾部更长，如下图："}]},{"ID":"20240610104122-xjlh5pm","Type":"NodeParagraph","Properties":{"id":"20240610104122-xjlh5pm","updated":"20240610104124"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"20230611105924"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/20230611105924-20240610104122-txuji1t.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240610104137-tfsq8ej","Type":"NodeParagraph","Properties":{"id":"20240610104137-tfsq8ej","style":"text-align: center;","updated":"20240610104149"},"Children":[{"Type":"NodeText","Data":"图9.37：MERL数据库中各种NDF对金属铬的匹配程度。左侧图中展示了相对于夹角"},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":" \\theta _m "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":"的镜面峰值，三条曲线分别代表金属铬（黑色）、GGX分布（红色，其中 "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{g}= 0.006  "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":")，Beckmann分布（绿色，其中"},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":" \\alpha_{g}= 0.013 "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":"），Blinn-Phong分布（蓝色虚线，其中"},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":" n = 12000 "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":"）。右侧展示了金属铬、GGX分布，Beckmann分布的高光渲染结果。 [214]"}]},{"ID":"20240610104245-vkajsgp","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240610104245-vkajsgp","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"GTR分布"}]},{"ID":"20240610104141-tgufcqq","Type":"NodeParagraph","Properties":{"id":"20240610104141-tgufcqq","updated":"20240610104253"},"Children":[{"Type":"NodeText","Data":"Burley [214]提出了广义的Trowbridge-Reitz （GTR） NDF，其目标是对NDF的形状进行更多的控制，尤其是分布的拖尾，其数学表达如下："}]},{"ID":"20240610104223-q1mgipb","Type":"NodeMathBlock","Properties":{"id":"20240610104223-q1mgipb","updated":"20240610104253"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"D(\\mathbf{m})=\\frac{k(\\alpha, \\gamma)}{\\pi\\left(1+(\\mathbf{n} \\cdot \\mathbf{m})^{2}\\left(\\alpha_{g}^{2}-1\\right)\\right)^{\\gamma}}\n\\tag{9.46}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610104227-fscy429","Type":"NodeParagraph","Properties":{"id":"20240610104227-fscy429","updated":"20240610104325"},"Children":[{"Type":"NodeText","Data":"参数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\gamma"},{"Type":"NodeText","Data":"控制了尾部的形状：当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\gamma=2"},{"Type":"NodeText","Data":"时，GTR分布与GGX分布完全相同；当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\gamma"},{"Type":"NodeText","Data":"值减小时，分布的尾部会变长；当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\gamma"},{"Type":"NodeText","Data":"值增大时，分布的尾部会变短。当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\gamma"},{"Type":"NodeText","Data":"值较大时，GTR分布类似于Beckmann分布。"}]},{"ID":"20240610104326-41f66lu","Type":"NodeParagraph","Properties":{"id":"20240610104326-41f66lu","updated":"20240610104355"},"Children":[{"Type":"NodeText","Data":"方程中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"k(\\alpha, \\gamma)"},{"Type":"NodeText","Data":"项是归一化系数，其数学表达式为："}]},{"ID":"20240610104355-yp2knta","Type":"NodeMathBlock","Properties":{"id":"20240610104355-yp2knta","updated":"20240610104400"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"k(\\alpha, \\gamma)=\\left\\{\\begin{array}{ll}\\frac{(\\gamma-1)\\left(\\alpha^{2}-1\\right)}{\\left(1-\\left(\\alpha^{2}\\right)^{(1-\\gamma)}\\right)}, \u0026 \\text { where } \\gamma \\neq 1 \\text { and } \\alpha \\neq 1 \\\\ \\frac{\\left(\\alpha^{2}-1\\right)}{\\ln \\left(\\alpha^{2}\\right)}, \u0026 \\text { where } \\gamma=1 \\text { and } \\alpha \\neq 1 \\\\ 1, \u0026 \\text { where } \\alpha=1 .\\end{array}\\right.\n\\tag{9.47}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610104400-t7upifk","Type":"NodeParagraph","Properties":{"id":"20240610104400-t7upifk","updated":"20240610104530"},"Children":[{"Type":"NodeText","Data":"GTR分布并不是形状不变的，这使得寻找它的Smith"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"   G_2 "},{"Type":"NodeText","Data":"函数变得相当复杂。在这个NDF发表3年后，G_2函数的解决方案才得以发表[355]。这个"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"  G_2 "},{"Type":"NodeText","Data":"函数的解相当复杂，它只给出了某些"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\gamma"},{"Type":"NodeText","Data":"值对应的解析解表（而其他中间值则必须使用插值获得）。GTR的另一个问题是参数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha和\\gamma"},{"Type":"NodeText","Data":"，会以一种很不直观的方式影响人们所感知到的粗糙度和“微光”效果。"}]},{"ID":"20240610104419-h4n8umm","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20240610104419-h4n8umm","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"Student t分布和指数幂分布"}]},{"ID":"20240610104543-v1dq996","Type":"NodeParagraph","Properties":{"id":"20240610104543-v1dq996","updated":"20240610104810"},"Children":[{"Type":"NodeText","Data":"在撰写本文的时候，它们才刚刚发布，因此尚不清楚它们在应用程序中的实用性。"}]},{"ID":"20240610104811-zwep04b","Type":"NodeParagraph","Properties":{"id":"20240610104811-zwep04b","updated":"20240610104841"}},{"ID":"20240610104840-od3wgm6","Type":"NodeParagraph","Properties":{"id":"20240610104840-od3wgm6","updated":"20240610104855"},"Children":[{"Type":"NodeText","Data":"为了更好地对被测材质进行模拟，一种替代方案是"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"使用多个镜面波瓣，而不是增加单个NDF的复杂性"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240610104843-r7spbyr","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240610104843-r7spbyr","updated":"20240610105907"},"Children":[{"Type":"NodeText","Data":"各向异性法线分布函数"}]},{"ID":"20240610104915-2htjz8p","Type":"NodeParagraph","Properties":{"id":"20240610104915-2htjz8p","updated":"20240610104931"},"Children":[{"Type":"NodeText","Data":"虽然大多数材质的表面都是各向同性的，但有一些材料的微观结构具有显著的各向异性，这大大地影响了它们的材质外观。"}]},{"ID":"20240610104932-kni1lay","Type":"NodeParagraph","Properties":{"id":"20240610104932-kni1lay","updated":"20240610105322"},"Children":[{"Type":"NodeText","Data":"与各向同性的NDF不同，各向异性的NDF不能仅仅使用单独的夹角"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\theta _m"},{"Type":"NodeText","Data":"进行描述，它还需要额外的方向信息。一般情况下，我们需要将微表面法线\\mathbf{m}变换到由法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}、切线（tangent）向量\\mathbf{t}、副切线（bitangent）向量\\mathbf{b}"},{"Type":"NodeText","Data":"所定义的局部坐标系或者切线空间中。"}]},{"ID":"20240610105323-e86y65e","Type":"NodeParagraph","Properties":{"id":"20240610105323-e86y65e","updated":"20240610105329"},"Children":[{"Type":"NodeText","Data":"这个变换通常被表示为三个独立的点积："},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{m} \\cdot \\mathbf{n}，\\mathbf{m} \\cdot \\mathbf{t}和\\mathbf{m} \\cdot \\mathbf{b}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240610105319-qv01z3p","Type":"NodeParagraph","Properties":{"id":"20240610105319-qv01z3p","updated":"20240610105343"},"Children":[{"Type":"NodeText","Data":"当我们将法线映射与各向异性BRDF相结合时，最重要的一点是，"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color4);"},"TextMarkType":"text","TextMarkTextContent":"确保法线映射在变换法线的同时，也会对切线和副切线进行变换"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color4);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240610105344-9ilakus","Type":"NodeParagraph","Properties":{"id":"20240610105344-9ilakus","updated":"20240610105405"},"Children":[{"Type":"NodeText","Data":"通常来说，这个过程是通过对扰动法线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"，以及顶点插值而来的切线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{t}_0"},{"Type":"NodeText","Data":"和副切线"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{b}_0"},{"Type":"NodeText","Data":"，应用改进的Gram-Schmidt过程来完成的。其数学表达如下（假设"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"已经被事先归一化了）："}]},{"ID":"20240610105406-guv1olv","Type":"NodeMathBlock","Properties":{"id":"20240610105406-guv1olv","updated":"20240610105410"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{array}{l}\\mathbf{t}^{\\prime}=\\mathbf{t}_{0}-\\left(\\mathbf{t}_{0} \\cdot \\mathbf{n}\\right) \\mathbf{n} \\quad \\Longrightarrow \\mathbf{t}=\\frac{\\mathbf{t}^{\\prime}}{\\left\\|\\mathbf{t}^{\\prime}\\right\\|}, \\\\ \\left.\\begin{array}{rl}\\mathbf{b}^{\\prime} \u0026 =\\mathbf{b}_{0}-\\left(\\mathbf{b}_{0} \\cdot \\mathbf{n}\\right) \\mathbf{n}, \\\\ \\mathbf{b}^{\\prime \\prime} \u0026 =\\mathbf{b}^{\\prime}-\\left(\\mathbf{b}^{\\prime} \\cdot \\mathbf{t}\\right) \\mathbf{t}\\end{array}\\right\\} \\Rightarrow \\mathbf{b}=\\frac{\\mathbf{b}^{\\prime \\prime}}{\\left\\|\\mathbf{b}^{\\prime \\prime}\\right\\|} \\\\\\end{array}\n\\tag{9.48}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610105410-s4cemsk","Type":"NodeParagraph","Properties":{"id":"20240610105410-s4cemsk","updated":"20240610105430"},"Children":[{"Type":"NodeText","Data":"或者也在第一行之后，通过"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"和"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{t}"},{"Type":"NodeText","Data":"的叉乘来得到正交向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{n}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240610105430-7hrt2re","Type":"NodeParagraph","Properties":{"id":"20240610105430-7hrt2re","updated":"20240610105501"},"Children":[{"Type":"NodeText","Data":"创建各向异性NDF的一种常见方法是，将现有的各向同性NDF进行推广，这种一般性的方法可以应用于任何形状不变的各向同性NDF [708]。"}]},{"ID":"20240610105502-c879t80","Type":"NodeParagraph","Properties":{"id":"20240610105502-c879t80","updated":"20240610105521"},"Children":[{"Type":"NodeText","Data":"回顾一下，形状不变的各向同学NDF可以写成："}]},{"ID":"20240610105521-1inmovh","Type":"NodeMathBlock","Properties":{"id":"20240610105521-1inmovh","updated":"20240610105526"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"D(\\mathbf{m})=\\frac{\\chi^{+}(\\mathbf{n} \\cdot \\mathbf{m})}{\\alpha^{2}(\\mathbf{n} \\cdot \\mathbf{m})^{4}} g\\left(\\frac{\\sqrt{1-(\\mathbf{n} \\cdot \\mathbf{m})^{2}}}{\\alpha(\\mathbf{n} \\cdot \\mathbf{m})}\\right)\n\\tag{9.49}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610105526-gz65hkd","Type":"NodeParagraph","Properties":{"id":"20240610105526-gz65hkd","updated":"20240610105535"},"Children":[{"Type":"NodeText","Data":"方程中的函数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"g"},{"Type":"NodeText","Data":"是一个代表NDF形状的一维函数。方程9.49的其各向异性版本是："}]},{"ID":"20240610105536-sj7o4m6","Type":"NodeMathBlock","Properties":{"id":"20240610105536-sj7o4m6","updated":"20240610105544"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"D(\\mathbf{m})=\\frac{\\chi^{+}(\\mathbf{n} \\cdot \\mathbf{m})}{\\alpha_{x} \\alpha_{y}(\\mathbf{n} \\cdot \\mathbf{m})^{4}} g\\left(\\frac{\\sqrt{\\frac{(\\mathbf{t} \\cdot \\mathbf{m})^{2}}{\\alpha_{x}^{2}}+\\frac{(\\mathbf{b} \\cdot \\mathbf{m})^{2}}{\\alpha_{y}^{2}}}}{(\\mathbf{n} \\cdot \\mathbf{m})}\\right)\n\\tag{9.50}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610105544-mw08n7d","Type":"NodeParagraph","Properties":{"id":"20240610105544-mw08n7d","updated":"20240610105613"},"Children":[{"Type":"NodeText","Data":"方程中的参数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{x}"},{"Type":"NodeText","Data":"和"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{y}"},{"Type":"NodeText","Data":"，分别代表了沿"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{t}"},{"Type":"NodeText","Data":"方向和"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{b}"},{"Type":"NodeText","Data":"方向的粗糙度。如果"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{x}=\\alpha_{y}"},{"Type":"NodeText","Data":"的话，方程9.50还可以退化为各向同性的形式。"}]},{"ID":"20240610105614-plufef5","Type":"NodeParagraph","Properties":{"id":"20240610105614-plufef5","updated":"20240610105635"},"Children":[{"Type":"NodeText","Data":"各向异性NDF的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"  G_2  "},{"Type":"NodeText","Data":"masking-shadowing函数，与各向同性中的基本相同，除了变量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"a"},{"Type":"NodeText","Data":"（用于传递给"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\Lambda"},{"Type":"NodeText","Data":"函数）的计算有所不同："}]},{"ID":"20240610105632-s9n5vyx","Type":"NodeMathBlock","Properties":{"id":"20240610105632-s9n5vyx","updated":"20240610105642"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"a=\\frac{\\mathbf{n} \\cdot \\mathbf{s}}{\\sqrt{\\alpha_{x}^{2}(\\mathbf{t} \\cdot \\mathbf{s})^{2}+\\alpha_{y}^{2}(\\mathbf{b} \\cdot \\mathbf{s})^{2}}}\n\\tag{9.51}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610105642-wc3dao7","Type":"NodeParagraph","Properties":{"id":"20240610105642-wc3dao7","updated":"20240610105656"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{s}"},{"Type":"NodeText","Data":"​代表了相机的观察方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeText","Data":"或者光线的入射方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{l}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240610105657-4qqgtvk","Type":"NodeParagraph","Properties":{"id":"20240610105657-4qqgtvk","updated":"20240610105710"},"Children":[{"Type":"NodeText","Data":"可以推导出各向异性版本的Beckmann NDF:"}]},{"ID":"20240610105710-ngbiuyx","Type":"NodeMathBlock","Properties":{"id":"20240610105710-ngbiuyx","updated":"20240610105715"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"D(\\mathbf{m})=\\frac{\\chi^{+}(\\mathbf{n} \\cdot \\mathbf{m})}{\\pi \\alpha_{x} \\alpha_{y}(\\mathbf{n} \\cdot \\mathbf{m})^{4}} \\exp \\left(-\\frac{\\frac{(\\mathbf{t} \\cdot \\mathbf{m})^{2}}{\\alpha_{x}^{2}}+\\frac{(\\mathbf{b} \\cdot \\mathbf{m})^{2}}{\\alpha_{y}^{2}}}{(\\mathbf{n} \\cdot \\mathbf{m})^{2}}\\right)\n\\tag{9.52}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610105715-8y1aubz","Type":"NodeParagraph","Properties":{"id":"20240610105715-8y1aubz","updated":"20240610105736"},"Children":[{"Type":"NodeText","Data":"以及各向异性版本的GGX NDF："}]},{"ID":"20240610105730-jxdheqv","Type":"NodeMathBlock","Properties":{"id":"20240610105730-jxdheqv","updated":"20240610105734"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"D(\\mathbf{m})=\\frac{\\chi^{+}(\\mathbf{n} \\cdot \\mathbf{m})}{\\pi \\alpha_{x} \\alpha_{y}\\left(\\frac{(\\mathbf{t} \\cdot \\mathbf{m})^{2}}{\\alpha_{x}^{2}}+\\frac{(\\mathbf{b} \\cdot \\mathbf{m})^{2}}{\\alpha_{y}^{2}}+(\\mathbf{n} \\cdot \\mathbf{m})^{2}\\right)^{2}}\n\\tag{9.53}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610105742-08gwkgp","Type":"NodeParagraph","Properties":{"id":"20240610105742-08gwkgp","updated":"20240610105744"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240610105742-picrmug.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240610105746-5c2sjur","Type":"NodeParagraph","Properties":{"id":"20240610105746-5c2sjur","style":"text-align: center;","updated":"20240610105753"},"Children":[{"Type":"NodeText","Data":"图9.38：利用各向异性NDF渲染的球体，其中第一行使用的是Beckmann NDF，第二行使用的是GGX NDF。在这两行中，粗糙度参数"},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":" \\alpha_{y} "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":"保持不变， "},{"Type":"NodeTextMark","Properties":{"parent-style":"text-align: center;"},"TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{x} "},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"text-align: center;\"}"},{"Type":"NodeText","Data":"从左到右递增。"}]},{"ID":"20240610105756-lefy7i7","Type":"NodeParagraph","Properties":{"id":"20240610105756-lefy7i7","updated":"20240610105824"},"Children":[{"Type":"NodeText","Data":"虽然将各向异性NDF参数化的最直接方法，就是将各向同性的粗糙度参数化表示使用两次，一次用于"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{x}"},{"Type":"NodeText","Data":"，一次用于"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{y}"},{"Type":"NodeText","Data":"，但有时也会使用其他形式的参数化表示。"}]},{"ID":"20240610105825-nsjmm01","Type":"NodeParagraph","Properties":{"id":"20240610105825-nsjmm01","updated":"20240610105843"},"Children":[{"Type":"NodeText","Data":"在Disney原则着色模型中[214]，各向同性的粗糙度参数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":" r  "},{"Type":"NodeText","Data":"会与另一个范围为[0,1]的标量参数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"k_{aniso}"},{"Type":"NodeText","Data":"相结合，然后通过以下方式来计算出"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{x}"},{"Type":"NodeText","Data":"和"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\alpha_{y}"},{"Type":"NodeText","Data":"的值："}]},{"ID":"20240610105844-0q3e77a","Type":"NodeMathBlock","Properties":{"id":"20240610105844-0q3e77a","updated":"20240610105850"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{aligned} k_{\\text {aspect }} \u0026 =\\sqrt{1-0.9 k_{\\text {aniso }}}, \\\\ \\alpha_{x} \u0026 =\\frac{r^{2}}{k_{\\text {aspect }}}, \\\\ \\alpha_{y} \u0026 =r^{2} k_{\\text {aspect }} .\\end{aligned}\n\\tag{9.54}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610105853-3m4kfny","Type":"NodeParagraph","Properties":{"id":"20240610105853-3m4kfny","updated":"20240610105857"},"Children":[{"Type":"NodeText","Data":"方程中的0.9将长宽比限制为10:1。"}]},{"ID":"20240610105901-mciedzx","Type":"NodeParagraph","Properties":{"id":"20240610105901-mciedzx","updated":"20240610105901"},"Children":[{"Type":"NodeText","Data":"Imageworks [947]使用了另一种不同形式的参数化方法，它允许构建任意程度的各向异性："}]},{"ID":"20240610105903-reds1s3","Type":"NodeMathBlock","Properties":{"id":"20240610105903-reds1s3","updated":"20240610105907"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{array}{l}\\alpha_{x}=r^{2}\\left(1+k_{\\text {aniso }}\\right), \\\\ \\alpha_{y}=r^{2}\\left(1-k_{\\text {aniso }}\\right) .\\end{array}\n\\tag{9.55}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240610105907-wzexcqp","Type":"NodeParagraph","Properties":{"id":"20240610105907-wzexcqp"}}]}