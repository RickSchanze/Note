{"ID":"20240308235814-5efa3pd","Spec":"1","Type":"NodeDocument","Properties":{"custom-sy-fullwidth":"true","id":"20240308235814-5efa3pd","title":"Chapter4 变换","type":"doc","updated":"20240526213525"},"Children":[{"ID":"20240308235814-5s84yip","Type":"NodeParagraph","Properties":{"id":"20240308235814-5s84yip","updated":"20240309000233"},"Children":[{"Type":"NodeTextMark","TextMarkType":"em strong","TextMarkTextContent":"变换"},{"Type":"NodeText","Data":"（transform）是指以点、向量、颜色等实体作为输入，并以某种方式对其进行转换的一种操作。"}]},{"ID":"20240309000233-6clx75v","Type":"NodeParagraph","Properties":{"id":"20240309000233-6clx75v","updated":"20240309000249"},"Children":[{"Type":"NodeText","Data":"线性变换（linear transform）是指一种仅保留向量加法和标量乘法的变换，具体来说就是："}]},{"ID":"20240309000250-aebdhgk","Type":"NodeMathBlock","Properties":{"id":"20240309000250-aebdhgk","updated":"20240418193422"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{f(x)} + \\mathbf{f(y)} = \\mathbf{f(x + y)} \\tag{4.1}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309000311-0qy5to1","Type":"NodeMathBlock","Properties":{"id":"20240309000311-0qy5to1","updated":"20240309000457"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\nk \\mathbf{f(x)} = \\mathbf{f(} k \\mathbf{x)}  \\tag{4.2}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309000321-lrpe1fn","Type":"NodeParagraph","Properties":{"id":"20240309000321-lrpe1fn","updated":"20240309000607"},"Children":[{"Type":"NodeText","Data":"\t函数  "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{f(x)} = \\mathbf{x} + (7,3,2)"},{"Type":"NodeText","Data":" 是一个非线性变换，其中的向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":" \\mathbf{x}"},{"Type":"NodeText","Data":"是一个三维向量。对两个不同的向量分别执行这个函数，其结果为每个向量各自加上"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"(7,3,2)"},{"Type":"NodeText","Data":"。让一个向量加上另一个固定的向量，意味着完成了一次平移变换（translation），即它以相同的程度对所有输入向量进行了移动，这是一种非常有用的变换类型。"}]},{"ID":"20240309000442-wqwybyp","Type":"NodeParagraph","Properties":{"id":"20240309000442-wqwybyp","updated":"20240309001338"},"Children":[{"Type":"NodeText","Data":"\t我们可以使用仿射变换（affine transform）的形式来将线性变换和平移变换组合在一起，仿射变换通常存储在一个"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"4 \\times 4"},{"Type":"NodeText","Data":"的矩阵中。"},{"Type":"NodeTextMark","TextMarkType":"strong em","TextMarkTextContent":"仿射变换是指先进行一次线性变换，然后再进行一次平移操作的变换。"},{"Type":"NodeText","Data":"我们使用齐次符号（homogeneous notation）来表示这样的四维向量，点和方向也会使用同样的方式来进行表示（小写的粗体字母），二者之间的区别是："},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"代表方向的向量，其"},{"Type":"NodeTextMark","TextMarkType":"inline-math strong","TextMarkInlineMathContent":"w"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"分量为0；代表点的向量，其"},{"Type":"NodeTextMark","TextMarkType":"inline-math strong","TextMarkInlineMathContent":"w"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"分量为1。"},{"Type":"NodeText","Data":"例如：方向向量可以表示为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v} = \\begin{array}{}_esc_newline_(v_x \u0026 v_y \u0026 v_z \u0026 0)^T_esc_newline_\\end{array}"},{"Type":"NodeText","Data":"，点可以表示为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v} = \\begin{array}{}_esc_newline_(v_x \u0026 v_y \u0026 v_z \u0026 1)^T_esc_newline_\\end{array}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240309000652-5593o1v","Type":"NodeParagraph","Properties":{"id":"20240309000652-5593o1v","updated":"20240309001359"},"Children":[{"Type":"NodeText","Data":"\t仿射变换最主要的特征就是"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"它保证了直线的平行性（即两个平行的直线在变换之后仍然是平行的）"},{"Type":"NodeText","Data":"，但是其长度和角度可能会发生一些变化。一个仿射变换也可以表示为一系列独立仿射变换的组合。"}]},{"ID":"20240309001422-quva7qb","Type":"NodeParagraph","Properties":{"id":"20240309001422-quva7qb","updated":"20240309001422"},"Children":[{"Type":"NodeText","Data":"\t正交矩阵的逆矩阵（inverse）就是它的转置矩阵（tanspose）。"}]},{"ID":"20240309001639-9l2ov5z","Type":"NodeTable","TableAligns":[0,0,0],"Properties":{"colgroup":"||","id":"20240309001639-9l2ov5z","style":"text-align: center;","updated":"20240309001639"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"符号"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"名称"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"特征描述"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{T(t)}"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"平移矩阵"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"移动一个点；仿射变换"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{R}_x(\\rho)"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"旋转矩阵"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"绕"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"x"},{"Type":"NodeText","Data":"轴旋转"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\rho"},{"Type":"NodeText","Data":"弧度；绕"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":" y,z  "},{"Type":"NodeText","Data":"轴旋转的标记也是类似的；正交矩阵 \u0026 仿射变换"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{R}"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"旋转矩阵"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"任意的旋转矩阵；正交矩阵 \u0026 仿射变换"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{S(s)}"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"缩放矩阵"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"根据传入的向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{s}"},{"Type":"NodeText","Data":"，沿"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"x,y,z"},{"Type":"NodeText","Data":"方向进行缩放；仿射变换"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{H}_{ij}(s)"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"剪切变换"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"将分量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"i"},{"Type":"NodeText","Data":"相对于分量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"j"},{"Type":"NodeText","Data":"进行剪切，其中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"i,j \\in \\{ x,y,z \\}"},{"Type":"NodeText","Data":"；仿射变换"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{E}(h,p,r)"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"欧拉变换"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"根据给定的欧拉角（yaw，pitch，roll）调整矩阵的朝向；正交矩阵 \u0026 仿射变换"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{P}_o(s)"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"正交投影矩阵"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"平行投影到一个平面或者是体积上；仿射变换"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{P}_p(s)"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"透视投影矩阵"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"透视投影到一个平面或者体积上"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathsf{slerp}(\\mathbf{\\hat{p}, \\hat{r}}, t)"},{"Type":"NodeText","Data":"​"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"球面插值"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"根据参数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t"},{"Type":"NodeText","Data":"，在四元数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{p}, \\hat{r}}"},{"Type":"NodeText","Data":"中创建一个插值四元数"}]}]}]},{"ID":"20240309001642-p3llc8c","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240309001642-p3llc8c","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.1 基本变换"}]},{"ID":"20240309002143-c37d4bm","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240309002143-c37d4bm","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.1.1 平移"}]},{"ID":"20240309002324-k45h9xx","Type":"NodeParagraph","Properties":{"id":"20240309002324-k45h9xx","updated":"20240309002558"},"Children":[{"Type":"NodeText","Data":"可以使用一个平移矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{T}"},{"Type":"NodeText","Data":"来描述从一个位置到另一个位置。此矩阵需要一个输入向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{t}=(t_x,t_y,t_Z)"},{"Type":"NodeText","Data":"作为参数："}]},{"ID":"20240309002454-sawylae","Type":"NodeMathBlock","Properties":{"id":"20240309002454-sawylae","updated":"20240317005059"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{T(t)} = \\mathbf{T}(t_x, t_y, t_z)=\n\\left (\n\\begin{array}{}\n1 \u0026 0 \u0026 0 \u0026 t_x \\\\\n0 \u0026 1 \u0026 0 \u0026 t_y \\\\\n0 \u0026 0 \u0026 1 \u0026 t_z \\\\\n0 \u0026 0 \u0026 0 \u0026 1 \\\\\n\\end{array} \n\\right) \n\\tag{4.3}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309002525-3hp99vh","Type":"NodeParagraph","Properties":{"id":"20240309002525-3hp99vh","updated":"20240309002546"},"Children":[{"Type":"NodeText","Data":"效果："}]},{"ID":"20240309002551-l3qrlsb","Type":"NodeParagraph","Properties":{"id":"20240309002551-l3qrlsb","updated":"20240309002554"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240309002551-a74uu5i.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240309002554-sf8b8cv","Type":"NodeParagraph","Properties":{"id":"20240309002554-sf8b8cv","updated":"20240309002601"},"Children":[{"Type":"NodeText","Data":"注意："}]},{"ID":"20240309002614-pfe8o8k","Type":"NodeBlockquote","Properties":{"id":"20240309002614-pfe8o8k","updated":"20240309002726"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240309002623-vn3pbk4","Type":"NodeParagraph","Properties":{"id":"20240309002623-vn3pbk4","updated":"20240309002726"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"一个向量"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"\\mathbf{v} = (v_x, v_y, v_z, 0)"},{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"和矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{T}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"相乘之后，是不会受到影响的，因为一个方向向量是无法被平移的；相比之下，点和向量都会受到其他仿射变换的影响。"}]}]},{"ID":"20240309002750-jg2hxnt","Type":"NodeParagraph","Properties":{"id":"20240309002750-jg2hxnt","updated":"20240309002808"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"平移矩阵的逆矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{T^{-1}(t)} = \\mathbf{T(-t)}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，即向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{t}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"取反即可；通俗的来理解就是，平移矩阵的逆矩阵就是反向平移相同距离的矩阵。"}]},{"ID":"20240309002808-1bs87n3","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240309002808-1bs87n3","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.1.2 旋转"}]},{"ID":"20240309002839-i5jfw1g","Type":"NodeParagraph","Properties":{"id":"20240309002839-i5jfw1g","updated":"20240309232017"},"Children":[{"Type":"NodeText","Data":"\t"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"旋转（rotation）变换可以将一个向量（位置或者方向），绕着一个过原点的旋转轴旋转一定的角度。"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeText","Data":"与平移变换一样，旋转变换也是一个刚体变换（rigid-body transform），也就是说，被变换点之间的距离并不会发生改变，并且保持了手性（handedness），即它不会导致物体左右两边相互交换；"}]},{"ID":"20240309232020-kvrbt6p","Type":"NodeParagraph","Properties":{"id":"20240309232020-kvrbt6p","updated":"20240309232039"},"Children":[{"Type":"NodeText","Data":"\t"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"方向矩阵"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeText","Data":"（orientation matrix）是一个与相机视角和物体朝向相关的旋转矩阵，它定义了物体在空间中的朝向，即物体向上和向前的方向。"}]},{"ID":"20240309232042-6l9dqxp","Type":"NodeParagraph","Properties":{"id":"20240309232042-6l9dqxp","updated":"20240309232205"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"假设我们现在有一个向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v} = (v_x, v_y)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，我们可以将其参数化表示为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v} = (v_x, v_y) = (r \\cos \\theta, r \\sin \\theta)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"。如果我们将向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"顺时针旋转"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"度，那么可以获得一个新向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v} =  (r \\cos (\\theta + \\phi), r \\sin (\\theta + \\phi))"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"，"},{"Type":"NodeText","Data":"推导："}]},{"ID":"20240309232205-dtrgs0b","Type":"NodeMathBlock","Properties":{"id":"20240309232205-dtrgs0b","updated":"20240309232746"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\n\\begin{aligned} \\mathbf{u} \u0026 =\\left(\\begin{array}{c}r \\cos (\\theta+\\phi) \\\\ r \\sin (\\theta+\\phi)\\end{array}\\right)=\\left(\\begin{array}{l}r(\\cos \\theta \\cos \\phi-\\sin \\theta \\sin \\phi) \\\\ r(\\sin \\theta \\cos \\phi+\\cos \\theta \\sin \\phi)\\end{array}\\right) \\\\ \u0026 =\\underbrace{\\left(\\begin{array}{rr}\\cos \\phi \u0026 -\\sin \\phi \\\\ \\sin \\phi \u0026 \\cos \\phi\\end{array}\\right)}_{\\mathbf{R}(\\phi)} \\underbrace{\\left(\\begin{array}{l}r \\cos \\theta \\\\ r \\sin \\theta\\end{array}\\right)}_{\\mathbf{v}}=\\mathbf{R}(\\phi) \\mathbf{v},\\end{aligned}\\tag{4.4}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309232523-72sta5l","Type":"NodeParagraph","Properties":{"id":"20240309232523-72sta5l","updated":"20240309232538"},"Children":[{"Type":"NodeText","Data":"其中"}]},{"ID":"20240309232538-jculk37","Type":"NodeMathBlock","Properties":{"id":"20240309232538-jculk37","updated":"20240309232801"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{R}_x(\\phi) =\n\\left (\n\\begin{array}{}\n\\cos \\phi \u0026 -\\sin \\phi  \\\\\n\\sin \\phi \u0026 \\cos \\phi \n\\end{array} \n\\right) "},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309232625-ztlpr7z","Type":"NodeParagraph","Properties":{"id":"20240309232625-ztlpr7z","updated":"20240309232717"},"Children":[{"Type":"NodeText","Data":"是二维的旋转矩阵，而在三维空间中，"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"经常使用的旋转矩阵是"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{R}_x(\\phi)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{R}_y(\\phi)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{R}_z(\\phi)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，它们分别代表了绕"},{"Type":"NodeText","Data":"x,y,z"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"轴旋转"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"度"}]},{"ID":"20240309232642-jqwgujh","Type":"NodeMathBlock","Properties":{"id":"20240309232642-jqwgujh","updated":"20240309232757"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{R}_x(\\phi) =\n\\left (\n\\begin{array}{}\n1 \u0026 0         \u0026 0          \u0026 0 \\\\\n0 \u0026 \\cos \\phi \u0026 -\\sin \\phi \u0026 0 \\\\\n0 \u0026 \\sin \\phi \u0026 \\cos \\phi  \u0026 0 \\\\\n0 \u0026 0         \u0026 0          \u0026 1 \\\\\n\\end{array} \n\\right) \n\\tag{4.5}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309232752-55khs3a","Type":"NodeMathBlock","Properties":{"id":"20240309232752-55khs3a","updated":"20240309232756"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{R}_y(\\phi) =\n\\left (\n\\begin{array}{}\n\\cos \\phi \u0026 0 \u0026 \\sin \\phi  \u0026 0 \\\\\n0 \u0026 1 \u0026  \u0026 0 \\\\\n-\\sin \\phi \u0026 0 \u0026 \\cos \\phi  \u0026 0 \\\\\n0 \u0026 0  \u0026 0  \u0026 1 \\\\\n\\end{array} \n\\right) \n\\tag{4.6}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309232801-5ho1mts","Type":"NodeMathBlock","Properties":{"id":"20240309232801-5ho1mts","updated":"20240309232805"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{R}_z(\\phi) =\n\\left (\n\\begin{array}{}\n\\cos \\phi \u0026 -\\sin \\phi \u0026 0 \u0026 0 \\\\\n\\sin \\phi \u0026 \\cos \\phi  \u0026 0 \u0026 0 \\\\\n0 \u0026  0\u0026  1 \u0026 0 \\\\\n0 \u0026 0  \u0026 0   \u0026 1 \\\\\n\\end{array} \n\\right) \n\\tag{4.7}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309232805-f1h7rck","Type":"NodeParagraph","Properties":{"id":"20240309232805-f1h7rck","updated":"20240309233254"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"假设我们想让一个物体以点"},{"Type":"NodeText","Data":"\\mathbf{p}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"为中心，绕"},{"Type":"NodeText","Data":"z"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"轴旋转"},{"Type":"NodeText","Data":"\\phi"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"度，那么其变换过程是什么样的呢？"}]},{"ID":"20240309233309-fwpdle2","Type":"NodeParagraph","Properties":{"id":"20240309233309-fwpdle2","updated":"20240309233310"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240309233309-xzq2kqx.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240309233311-078w3tv","Type":"NodeParagraph","Properties":{"id":"20240309233311-078w3tv","updated":"20240309233412"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"先将物体进行平移，使得点"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{p}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"和原点重合，这个过程可以通过平移矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{T(-p)}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"来完成；然后我们可以对物体进行想要的旋转操作，即"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{R}_z(\\phi)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"；最后我们再使用反向平移矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{T(p)}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"来将这个物体平移回原来的位置。最后就得到了总变换矩阵"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"\\mathbf{X}"},{"Type":"NodeText","Data":"："}]},{"ID":"20240309233412-exyounr","Type":"NodeMathBlock","Properties":{"id":"20240309233412-exyounr","updated":"20240309233423"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{X} = \\mathbf{T(p)} \\mathbf{R}_z(\\phi) \\mathbf{T(-p)} \\tag{4.9}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309233423-6hn0vpn","Type":"NodeParagraph","Properties":{"id":"20240309233423-6hn0vpn","updated":"20240309233509"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"注意：最先应用的变换位于房产最右边，接下来的若干个变换依次左乘。"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"}]},{"ID":"20240309233509-rpadnm5","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240309233509-rpadnm5","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.1.3 缩放"}]},{"ID":"20240309233527-cwyhf2v","Type":"NodeParagraph","Properties":{"id":"20240309233527-cwyhf2v","updated":"20240309233557"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"缩放（scaling）矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{S(s)} = \\mathbf{S} (s_x, s_y, s_z)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"可以分别在"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"x,y,z"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"方向上，使用缩放因子"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s_x, s_y, s_z"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"来对物体进行缩放，也就是说缩放矩阵可以放大或者缩小物体，缩放因子"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s_i, i \\in{ x, y, z }"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"的值越大，物体在该方向上的尺寸也就会变得越大；如果我们将缩放矩阵的其中一个分量设置为1，那么物体在该方向上的尺寸将会保持不变。"}]},{"ID":"20240309233559-s62l2yw","Type":"NodeParagraph","Properties":{"id":"20240309233559-s62l2yw","updated":"20240309233603"},"Children":[{"Type":"NodeText","Data":"缩放矩阵："}]},{"ID":"20240309233604-yejburl","Type":"NodeMathBlock","Properties":{"id":"20240309233604-yejburl","updated":"20240309233616"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{S(s)} = \n\\left (\n\\begin{array}{}\ns_x \u0026 0 \u0026 0 \u0026 0 \\\\\n0 \u0026 s_y \u0026 0 \u0026 0 \\\\\n0 \u0026 0 \u0026 s_z \u0026 0 \\\\\n0 \u0026 0 \u0026 0 \u0026 1 \\\\\n\\end{array} \n\\right) \n\\tag{4.10}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309233616-dm5w9l4","Type":"NodeParagraph","Properties":{"id":"20240309233616-dm5w9l4","updated":"20240309233809"},"Children":[{"Type":"NodeText","Data":"当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s_x=s_y=s_z"},{"Type":"NodeText","Data":"时，称为均匀缩放（各向同性[isotropic]），否则为非均匀缩放(各向异性[anisotropic])。"}]},{"ID":"20240309233809-kv3j5dy","Type":"NodeParagraph","Properties":{"id":"20240309233809-kv3j5dy","updated":"20240309233904"},"Children":[{"Type":"NodeText","Data":"当使用齐次坐标来表示变换时，还可以操作位于矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"(3,3)"},{"Type":"NodeText","Data":"位置的元素创建一个均匀缩放（只能是点）。"}]},{"ID":"20240309233905-nvu7dqk","Type":"NodeMathBlock","Properties":{"id":"20240309233905-nvu7dqk","updated":"20240309233912"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{S} = \n\\left (\n\\begin{array}{}\n5 \u0026 0 \u0026 0 \u0026 0 \\\\\n0 \u0026 5 \u0026 0 \u0026 0 \\\\\n0 \u0026 0 \u0026 5 \u0026 0 \\\\\n0 \u0026 0 \u0026 0 \u0026 1 \\\\\n\\end{array} \n\\right) ，\n\n\\mathbf{S^{\\prime}} = \n\\left (\n\\begin{array}{}\n1 \u0026 0 \u0026 0 \u0026 0 \\\\\n0 \u0026 1 \u0026 0 \u0026 0 \\\\\n0 \u0026 0 \u0026 1 \u0026 0 \\\\\n0 \u0026 0 \u0026 0 \u0026 1/5 \\\\\n\\end{array} \n\\right) .\n\\tag{4.11}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309233618-6rr861w","Type":"NodeParagraph","Properties":{"id":"20240309233618-6rr861w","updated":"20240309233924"},"Children":[{"Type":"NodeText","Data":"这两个矩阵缩放形式不同，但是效果相同。"}]},{"ID":"20240309233946-z72nb6p","Type":"NodeParagraph","Properties":{"id":"20240309233946-z72nb6p","updated":"20240309233953"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"注意："},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"strong text","TextMarkTextContent":"这个缩放矩阵的效率并不高，因为它在齐次坐标过程中引入了除法；即如果矩阵最右下角（位置"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"(3,3)"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"strong text","TextMarkTextContent":"）上的元素值为1，则不需要进行除法操作。"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"}]},{"ID":"20240309233954-jkkzsht","Type":"NodeParagraph","Properties":{"id":"20240309233954-jkkzsht","updated":"20240309234304"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"如果向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{s}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"中包含1个或者3个为负的分量，那么我们就获得了反射（镜像）矩阵（mirror matrix）；如果有两个为负的分量，那么这个矩阵会将物体旋转180度（中心对称）。一个旋转矩阵和一个镜像矩阵相乘，那么生成的结果仍将是一个镜像矩阵。"}]},{"ID":"20240309234249-fxoong9","Type":"NodeParagraph","Properties":{"id":"20240309234249-fxoong9","updated":"20240309234252"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"可以通过计算左上角"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"3 \\times  3"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"行列式的值，来判断一个给定的缩放矩阵是否为一个反射矩阵。如果缩放矩阵的行列式为负数，则说明该矩阵是一个反射矩阵。"}]},{"ID":"20240309234518-eb386be","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240309234518-eb386be","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.1.4 剪切"}]},{"ID":"20240309234522-tzn1wdx","Type":"NodeParagraph","Properties":{"id":"20240309234522-tzn1wdx","updated":"20240309234529"},"Children":[{"Type":"NodeText","Data":"剪切（shear）变换是另一种基本变换，它可以用来对整个场景进行扭曲，从而创造出一种迷幻的效果，或者是对单个模型的外观进行扭曲。"}]},{"ID":"20240309234544-2xj7t5e","Type":"NodeParagraph","Properties":{"id":"20240309234544-2xj7t5e","updated":"20240309234607"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"剪切变换一共包含6个基本矩阵，它们分别是"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{H}_{xy}(s)"},{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"，"},{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{H}_{xz}(s)"},{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"，"},{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{H}_{yx}(s)"},{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"，"},{"Type":"NodeText","Data":"​"},{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"\\mathbf{H}_{yz}(s)，"},{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{H}_{zx}(s)"},{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"，"},{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{H}_{zy}(s)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"。其中第一个下标用于表示哪个坐标会被剪切矩阵改变，第二个下标表示将会使用哪个坐标来进行剪切。例如"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"\\mathbf{H}_{xz}(s)"}]},{"ID":"20240309234549-nk9dcsx","Type":"NodeMathBlock","Properties":{"id":"20240309234549-nk9dcsx","updated":"20240309234616"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{H_{xz}} (s)= \n\\left (\n\\begin{array}{}\n1 \u0026 0 \u0026 s \u0026 0 \\\\\n0 \u0026 1 \u0026 0 \u0026 0 \\\\\n0 \u0026 0 \u0026 1 \u0026 0 \\\\\n0 \u0026 0 \u0026 0 \u0026 1 \\\\\n\\end{array} \n\\right) \n\\tag{4.15}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309234647-oa95mt6","Type":"NodeParagraph","Properties":{"id":"20240309234647-oa95mt6","updated":"20240309234649"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240309234647-dj2gct2.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240309234650-3o3jwsr","Type":"NodeParagraph","Properties":{"id":"20240309234650-3o3jwsr","updated":"20240309234722"},"Children":[{"Type":"NodeText","Data":"下面有一种稍微不同的剪切矩阵："}]},{"ID":"20240309234722-cbgy041","Type":"NodeMathBlock","Properties":{"id":"20240309234722-cbgy041","updated":"20240309234730"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{H^{\\prime}_{xy}} (s,t)= \n\\left (\n\\begin{array}{}\n1 \u0026 0 \u0026 s \u0026 0 \\\\\n0 \u0026 1 \u0026 t \u0026 0 \\\\\n0 \u0026 0 \u0026 1 \u0026 0 \\\\\n0 \u0026 0 \u0026 0 \u0026 1 \\\\\n\\end{array} \n\\right) \n\\tag{4.16}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309234730-a6ppccm","Type":"NodeParagraph","Properties":{"id":"20240309234730-a6ppccm","updated":"20240309234746"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"剪切变换包含两个输入参数，它们代表了这两个坐标（"},{"Type":"NodeText","Data":"x,y"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"）都会被第三个坐标（"},{"Type":"NodeText","Data":"z"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"）剪切。这个特殊的剪切矩阵可以通过上面一般的剪切矩阵组合而成，即"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{H^{\\prime}_{xy}} (s,t) = \\mathbf{H}_{ik}(s) \\mathbf{H}_{jk}(t)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，其中的"},{"Type":"NodeText","Data":"k"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"代表了 第三个坐标分量的索引。"}]},{"ID":"20240309234748-dktr1qm","Type":"NodeParagraph","Properties":{"id":"20240309234748-dktr1qm","updated":"20240309234805"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"strong text","TextMarkTextContent":"任何剪切矩阵的行列式值都为"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\vert \\mathbf{H} \\vert =1"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"strong text","TextMarkTextContent":"，这意味着剪切变换是一种体积保持（volume-preserving）的变换，即变换前后，物体的体积并不会发生改变（在三维空间中是体积，在二维空间中则是面积）"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"}]},{"ID":"20240309234805-s4cplit","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240309234805-s4cplit","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.1.6 刚体变换"}]},{"ID":"20240309235233-kg6rmx4","Type":"NodeParagraph","Properties":{"id":"20240309235233-kg6rmx4","updated":"20240309235255"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"将只包含平移和旋转的变换叫做刚体变换（rigid-body transform），它具有保持长度、角度和手性的特点。"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"}]},{"ID":"20240309235048-th97cxl","Type":"NodeParagraph","Properties":{"id":"20240309235048-th97cxl","updated":"20240309235311"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"任何刚体变换矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{X}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，都可以写成一个平移矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{T(t)}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"和一个旋转矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{R}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"的连接"}]},{"ID":"20240309235312-xjrj8bt","Type":"NodeMathBlock","Properties":{"id":"20240309235312-xjrj8bt","updated":"20240310000028"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{X} = \\mathbf{T(t)R}=\n\\left (\n\\begin{array}{}\nr_{00} \u0026 r_{01} \u0026 r_{02} \u0026 t_x \\\\\nr_{10} \u0026 r_{11} \u0026 r_{12} \u0026 t_y \\\\\nr_{20} \u0026 r_{21} \u0026 r_{22} \u0026 t_z \\\\\n0 \u0026 0 \u0026 0 \u0026 1 \\\\\n\\end{array} \n\\right) \n\\tag{4.17}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309235322-0achebm","Type":"NodeParagraph","Properties":{"id":"20240309235322-0achebm","updated":"20240309235854"},"Children":[{"Type":"NodeText","Data":"矩阵的逆："}]},{"ID":"20240309235854-gfdmvpa","Type":"NodeMathBlock","Properties":{"id":"20240309235854-gfdmvpa","updated":"20240310001833"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{X^{-1} = (T(t)R)^{-1} = R^{-1}T(t)^{-1} = R^TT(-t)}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240309235911-zo8ab3m","Type":"NodeParagraph","Properties":{"id":"20240309235911-zo8ab3m","updated":"20240309235947"},"Children":[{"Type":"NodeText","Data":"即左上角旋转矩阵进行转置，平移矩阵取反，然后调换顺序。"}]},{"ID":"20240310001411-g2ckfd3","Type":"NodeParagraph","Properties":{"id":"20240310001411-g2ckfd3","updated":"20240310001424"},"Children":[{"Type":"NodeText","Data":"示例：相机LookAt函数"}]},{"ID":"20240310001428-k98ckjm","Type":"NodeParagraph","Properties":{"id":"20240310001428-k98ckjm","updated":"20240310001429"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240310001428-u5injsg.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240310001430-as0rrgy","Type":"NodeParagraph","Properties":{"id":"20240310001430-as0rrgy","updated":"20240310001543"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"此时相机指向上方的方向为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{u^{\\prime}}"},{"Type":"NodeText","Data":"，首先计算观察向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v = (l-c) / \\Vert l-c \\Vert}"},{"Type":"NodeText"}]},{"ID":"20240310001543-ufkmt60","Type":"NodeParagraph","Properties":{"id":"20240310001543-ufkmt60","updated":"20240310001611"},"Children":[{"Type":"NodeText","Data":"然后计算向右向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{r = (v \\times u^{\\prime}) / \\Vert v \\times u^{\\prime} \\Vert}"},{"Type":"NodeText","Data":"，然后更新向上向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{u = r \\times v}"},{"Type":"NodeText"}]},{"ID":"20240310001556-5kk2aid","Type":"NodeParagraph","Properties":{"id":"20240310001556-5kk2aid","updated":"20240317000723"},"Children":[{"Type":"NodeText","Data":"最后相机变换矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{M}"},{"Type":"NodeText","Data":":"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"先将相机平移到坐标原点"},{"Type":"NodeText","Data":"(0,0,0)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"的位置上；然后再对基底进行变换，使得向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{r}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"指向"},{"Type":"NodeText","Data":"(1,0,0)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{u}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"指向"},{"Type":"NodeText","Data":"(0,1,0)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{v}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"指向"},{"Type":"NodeText","Data":"(0,0,-1)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240310001638-a6m5cye","Type":"NodeMathBlock","Properties":{"id":"20240310001638-a6m5cye","updated":"20240418201823"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{array}{}\n\\mathbf{M} \u0026= \n\\underbrace{\n\\left ( \\begin{array}{}\nr_x \u0026 r_y \u0026 r_z \u0026 0 \\\\\nu_x \u0026 u_y \u0026 u_z \u0026 0 \\\\\n-v_x \u0026 -v_y \u0026 -v_z \u0026 0 \\\\\n0 \u0026 0 \u0026 0 \u0026 1 \\\\\n\\end{array}  \\right)\n}_{\\mathsf{change\\ of \\ basis}}\n\n\\underbrace{\n\\left ( \\begin{array}{}\n1 \u0026 0 \u0026 0 \u0026 -t_x \\\\\n0 \u0026 1 \u0026 0 \u0026 -t_y \\\\\n0 \u0026 0 \u0026 1 \u0026 -t_z \\\\\n0 \u0026 0 \u0026 0 \u0026 1 \\\\\n\\end{array}  \\right)\n}_{\\mathsf{translation}}\n\\\\[4mm]\n\u0026=\\left ( \\begin{array}{}\nr_x \u0026 r_y \u0026 r_z \u0026 -\\mathbf{t \\cdot r} \\\\\nu_x \u0026 u_y \u0026 u_z \u0026 -\\mathbf{t \\cdot u} \\\\\n-v_x \u0026 -v_y \u0026 -v_z \u0026 -\\mathbf{t \\cdot v} \\\\\n0 \u0026 0 \u0026 0 \u0026 1 \\\\\n\\end{array}  \\right) \n\\end{array}\n\\tag{4.20}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240418205620-zx2cgph","Type":"NodeSuperBlock","Properties":{"id":"20240418205620-zx2cgph","updated":"20240418205700"},"Children":[{"Type":"NodeSuperBlockOpenMarker"},{"Type":"NodeSuperBlockLayoutMarker","Data":"row"},{"ID":"20240310001713-9b7yt59","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240310001713-9b7yt59","updated":"20240418205700"},"Children":[{"Type":"NodeText","Data":"4.1.7 法线变换"}]},{"ID":"20240311093950-efye48w","Type":"NodeParagraph","Properties":{"id":"20240311093950-efye48w","updated":"20240418205700"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240311093950-tvjkgj4.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240311093952-1lu7wyw","Type":"NodeParagraph","Properties":{"id":"20240311093952-1lu7wyw","updated":"20240418205700"},"Children":[{"Type":"NodeText","Data":"如图，如果对法线应用同样的变换矩阵，那么无法得到正确的结果。"}]},{"ID":"20240311094019-dwr5y09","Type":"NodeParagraph","Properties":{"id":"20240311094019-dwr5y09","updated":"20240418205700"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"对法线正确的变换方法是：使用原始变换矩阵的伴随矩阵（adjoint）的转置矩阵来对其进行变换。"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"}]},{"ID":"20240311094201-3e0oq5q","Type":"NodeParagraph","Properties":{"id":"20240311094201-3e0oq5q","updated":"20240418205700"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"法线变换的传统方法是，计算原始变换矩阵的逆矩阵的转置"},{"Type":"NodeText","Data":"["},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"1794]，即"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{(M^{-1})^T}"},{"Type":"NodeText","Data":",但是这个方法耗时费力。"}]},{"ID":"20240311094033-4gv4j7e","Type":"NodeParagraph","Properties":{"id":"20240311094033-4gv4j7e","updated":"20240418205700"},"Children":[{"Type":"NodeText","Data":"在进行了平移、旋转和均匀缩放操作，我们可以直接使用模型的变换矩阵来对法线进行变换；但是如果模型变换涉及了非均匀缩放或者投影操作，那么就无法使用这种方法对法线进行变换了。"}]},{"ID":"20240311094401-wdm9990","Type":"NodeParagraph","Properties":{"id":"20240311094401-wdm9990","updated":"20240418205700"},"Children":[{"Type":"NodeText","Data":"法线进行归一化处理："}]},{"ID":"20240311094403-7t5k1lp","Type":"NodeParagraph","Properties":{"id":"20240311094403-7t5k1lp","updated":"20240418205700"},"Children":[{"Type":"NodeText","Data":"\t如果我们知道了一系列的均匀变换最终会导致物体比之前放大5.2倍，并且法线应用了这个变换矩阵的话，我们可以直接将法线的长度除以5.2即可（即缩小为原来的5.2倍）。"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"除此之外，我们还可以将这一步放在对法线变换之前，让左上角"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"3 \\times 3"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"子矩阵除以这个缩放系数，从而构建一个会生成归一化结果的法线变换矩阵。"}]},{"Type":"NodeSuperBlockCloseMarker","Properties":{"updated":"20240418205700"}}]},{"ID":"20240311094511-zdhp2ui","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240311094511-zdhp2ui","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.1.8 计算逆矩阵"}]},{"ID":"20240311094525-6d4hqpj","Type":"NodeList","ListData":{},"Properties":{"id":"20240311094525-6d4hqpj","updated":"20240311094645"},"Children":[{"ID":"20240311094550-ozvw7ri","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311094550-ozvw7ri","updated":"20240311094550"},"Children":[{"ID":"20240311094550-hs1t3pg","Type":"NodeParagraph","Properties":{"id":"20240311094550-hs1t3pg","updated":"20240311094608"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"现在有一个变换矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{M}=\\mathbf{T(t)}\\mathbf{R}(\\phi)"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，则其逆矩阵为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{M^{-1}} = \\mathbf{R}(-\\phi)\\mathbf{T(-t)}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"。这种求取逆矩阵的方式十分简单且准确"}]}]},{"ID":"20240311094601-asr9gx3","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311094601-asr9gx3","updated":"20240311094628"},"Children":[{"ID":"20240311094601-0azk1zo","Type":"NodeParagraph","Properties":{"id":"20240311094601-0azk1zo","updated":"20240311094628"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"如果一个矩阵是正交矩阵的话，那么其逆矩阵和转置矩阵是相等的，即"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{M^{-1}} = \\mathbf{M^{T}}"}]}]},{"ID":"20240311094627-75f4xad","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240311094627-75f4xad","updated":"20240311094645"},"Children":[{"ID":"20240311094627-rkms7xo","Type":"NodeParagraph","Properties":{"id":"20240311094627-rkms7xo","updated":"20240311094645"},"Children":[{"Type":"NodeText","Data":"如果这些信息都不知道的话，那么我们还可以使用伴随矩阵法、Cramer法则、LU分解法、高斯消元法等方法来计算一个矩阵的逆矩阵。伴随矩阵法和Cramer法则通常要更好一些，因为它们所涉及的分支操作较少。"}]}]}]},{"ID":"20240311094600-jtusrx9","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240311094600-jtusrx9","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.2 特殊的矩阵变换和操作"}]},{"ID":"20240311094703-lwfd1gp","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240311094703-lwfd1gp","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.2.1 欧拉变换"}]},{"ID":"20240311094721-068vpng","Type":"NodeParagraph","Properties":{"id":"20240311094721-068vpng","updated":"20240311094702"},"Children":[{"Type":"NodeText","Data":"欧拉变换可以构建一个旋转矩阵，将我们自身（相机）或者其他物体指向一个特定的方向。"}]},{"ID":"20240311094826-qv47zw2","Type":"NodeParagraph","Properties":{"id":"20240311094826-qv47zw2","updated":"20240311094702"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240311094826-kzw65d0.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240311094830-0as17tu","Type":"NodeParagraph","Properties":{"id":"20240311094830-0as17tu","updated":"20240311094702"},"Children":[{"Type":"NodeText","Data":"上图的欧拉变换可以表示为："}]},{"ID":"20240311094839-a5u243k","Type":"NodeMathBlock","Properties":{"id":"20240311094839-a5u243k","updated":"20240311094702"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{E}(h,p,r) = \\mathbf{R}_z(r) \\mathbf{R}_x(p)\\mathbf{R}_y(h) \\tag{4.21}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240311095016-ml43oou","Type":"NodeParagraph","Properties":{"id":"20240311095016-ml43oou","updated":"20240311094702"},"Children":[{"Type":"NodeText","Data":"欧拉角在小角度变换和调整观察者方向方面十分有用，但是它也有一些严重的限制，即我们很难将两组欧拉角组合在一起。例如：在两组欧拉角之间进行插值，并不是简单地对每个分量分别进行插值就可以完成的。"}]},{"ID":"20240311095037-0g0t8d9","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240311095037-0g0t8d9","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.2.2 从欧拉变换中提取参数"}]},{"ID":"20240311095048-g0g7fah","Type":"NodeMathBlock","Properties":{"id":"20240311095048-g0g7fah","updated":"20240311094702"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{E}(h,p,r) = \n\n \\left ( \\begin{array}{}\ne_{00} \u0026 e_{01} \u0026 e_{02} \\\\\ne_{10} \u0026 e_{11} \u0026 e_{12} \\\\\ne_{20} \u0026 e_{21} \u0026 e_{22} \\\\\n\\end{array}  \\right)\n\n= \\mathbf{R}_z(r) \\mathbf{R}_x(p)\\mathbf{R}_y(h) \\tag{4.22}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240311095143-6bwms0s","Type":"NodeParagraph","Properties":{"id":"20240311095143-6bwms0s","updated":"20240311094702"},"Children":[{"Type":"NodeText","Data":"上面的公式用于提起各个方向上所改变的角度。"}]},{"ID":"20240311095201-vz7v0m9","Type":"NodeParagraph","Properties":{"id":"20240311095201-vz7v0m9","updated":"20240311094702"},"Children":[{"Type":"NodeText","Data":"将上述的三个旋转矩阵展开相乘："}]},{"ID":"20240311095215-kxhhvih","Type":"NodeMathBlock","Properties":{"id":"20240311095215-kxhhvih","updated":"20240311094702"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{E}= \n\n \\left ( \\begin{array}{}\n\\cos r \\cos h - \\sin r \\sin p \\sin h \u0026 - \\sin r \\cos p \u0026 \\cos r \\sin h + \\sin r \\sin p \\cos h \\\\\n\n\\sin r \\cos h + \\cos r \\sin p \\sin h \u0026 \\cos r \\cos p \u0026 \\sin r \\sin h - \\cos r \\sin p \\cos h \\\\\n\n-\\cos p \\sin h \u0026 \\sin p \u0026 \\cos p \\cos h \\\\\n\\end{array}  \\right)\n\n\\tag{4.23}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240311095931-klbg58f","Type":"NodeParagraph","Properties":{"id":"20240311095931-klbg58f","updated":"20240311094702"},"Children":[{"Type":"NodeText","Data":"则"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\sin p = e_{21}"},{"Type":"NodeText","Data":"。令"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"e_{01}"},{"Type":"NodeText","Data":"除以"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"e_{11}"},{"Type":"NodeText","Data":"来计算"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"r"},{"Type":"NodeText","Data":"，令"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"e_{20}"},{"Type":"NodeText","Data":"除以"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"e_{22}"},{"Type":"NodeText","Data":"来计算"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"h"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240317000647-xvwx0sl","Type":"NodeMathBlock","Properties":{"id":"20240317000647-xvwx0sl","updated":"20240311094702"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\frac{e_{01}}{e_{11}} = \n\\frac{-\\sin r}{\\cos r} = -\\tan r ,\\qquad\n\\frac{e_{20}}{e_{22}} = \n\\frac{-\\sin h}{\\cos h} = -\\tan h \n\\tag{4.24}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240311095937-w9j3j7u","Type":"NodeParagraph","Properties":{"id":"20240311095937-w9j3j7u","updated":"20240311094702"},"Children":[{"Type":"NodeText","Data":"则可以计算出："}]},{"ID":"20240317001002-55vv3zy","Type":"NodeMathBlock","Properties":{"id":"20240317001002-55vv3zy","updated":"20240311094702"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\n\\begin{align}{}\nh \u0026= \\mathsf{atan2}(-e_{20},e_{22}) \\\\\np \u0026= \\arcsin (e_{21}) \\\\\nr \u0026= \\mathsf{atan2}(-e_{01},e_{11}) \\\\\n\\end{align} \n\\tag{4.25}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240317001012-2pzkk82","Type":"NodeParagraph","Properties":{"id":"20240317001012-2pzkk82","updated":"20240311094702"},"Children":[{"Type":"NodeText","Data":"当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"cos p = 0"},{"Type":"NodeText","Data":"时，会出现万向锁的问题。此时旋转角度"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"r"},{"Type":"NodeText","Data":"和"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"h"},{"Type":"NodeText","Data":"会绕着一个旋转轴旋转。此时只要计算其中一个角度即可。此时矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{E}"},{"Type":"NodeText","Data":"为:"}]},{"ID":"20240317001356-qyw901h","Type":"NodeMathBlock","Properties":{"id":"20240317001356-qyw901h","updated":"20240317004918"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\n\\begin{align}{}\n\\mathbf{E_1}\u0026 =\n\\left ( \\begin{array}{}\n\\cos r \\cos h - \\sin r \\sin h \u0026 0 \u0026 \\cos r \\sin h + \\sin r \\cos h \\\\\n\\sin r \\cos h + \\cos r \\sin h \u0026 0 \u0026 \\sin r \\sin h - \\cos r \\cos h \\\\\n0 \u0026 1 \u0026 0 \\\\\n\\end{array}  \\right)\n\\\\[5mm]\u0026=\n\\left ( \\begin{array}{}\n\\cos (r+h) \u0026 0 \u0026 \\sin (r+h) \\\\\n\\sin (r+h) \u0026 0 \u0026 \\cos (r+h) \\\\\n0 \u0026 1 \u0026 0 \\\\\n\\end{array}  \\right) ,p = \\pi/2\n\\\\[10mm]\n\\mathbf{E_2}\u0026= \n\\left ( \\begin{array}{}\n\\cos r \\cos h + \\sin r \\sin h \u0026 0 \u0026 \\cos r \\sin h - \\sin r \\cos h \\\\\n\\sin r \\cos h - \\cos r \\sin h \u0026 0 \u0026 \\sin r \\sin h + \\cos r \\cos h \\\\\n0 \u0026 -1 \u0026 0 \\\\\n\\end{array}  \\right)\n\\\\[5mm]\u0026=\n\\left ( \\begin{array}{}\n\\cos (r-h) \u0026 0 \u0026 \\sin (r-h) \\\\\n\\sin (r-h) \u0026 0 \u0026 \\cos (r-h) \\\\\n0 \u0026 -1 \u0026 0 \\\\\n\\end{array}  \\right) ,p = -\\pi/2\n\\end{align} \n\\tag{4.25.1}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240317001802-8aiieqh","Type":"NodeParagraph","Properties":{"id":"20240317001802-8aiieqh","updated":"20240311094702"},"Children":[{"Type":"NodeText","Data":"此时方程仅仅和"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"(r+h)或(r-h)"},{"Type":"NodeText","Data":"有关，此时假设其中任意一个旋转角为0，即可求出另一个参数；例如"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"h=0"},{"Type":"NodeText","Data":","},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"cosh=1,cosh=0"},{"Type":"NodeText","Data":"，则变换矩阵可写作:"}]},{"ID":"20240317001929-4lplefo","Type":"NodeMathBlock","Properties":{"id":"20240317001929-4lplefo","updated":"20240311094702"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{E}= \n\n \\left ( \\begin{array}{}\n\\cos r \u0026  -\\sin r \\cos p \u0026 \\sin r \\sin p \\\\\n\n\\sin r \u0026 \\cos r \\cos p \u0026 - \\cos r \\sin p  \\\\\n\n0 \u0026 \\sin p \u0026 \\cos p \\\\\n\\end{array}  \\right)\n\n\\tag{4.26}\n"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240317001937-t0kduoz","Type":"NodeParagraph","Properties":{"id":"20240317001937-t0kduoz","updated":"20240311094702"},"Children":[{"Type":"NodeText","Data":"可以看到旋转角度"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"p"},{"Type":"NodeText","Data":"不会对第一列的值产生任何影响。可以利用"}]},{"ID":"20240317002144-ldl1kza","Type":"NodeParagraph","Properties":{"id":"20240317002144-ldl1kza","updated":"20240311094702"},"Children":[{"Type":"NodeText","Data":"当我们使用欧拉变换的时候，有时会发生一种叫做"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"万向节死锁"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeText","Data":"（gimbal lock）的现象，即在旋转的过程中失去了一个自由度。"}]},{"ID":"20240317002149-4p3vmad","Type":"NodeParagraph","Properties":{"id":"20240317002149-4p3vmad","updated":"20240311094702"},"Children":[{"Type":"NodeText","Data":"例如：假设我们现在按照x,y,z的顺序进行变换，然后绕y轴旋转了\\pi/2的角度，即执行了第二个旋转；这个旋转操作会使得局部坐标系中的z轴与原始的x轴重合，最终导致绕z轴旋转的操作是多余的。"}]},{"ID":"20240317002355-o4rsr5g","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240317002355-o4rsr5g","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.2.4 绕任意轴旋转"}]},{"ID":"20240317003043-pzi5vqy","Type":"NodeParagraph","Properties":{"id":"20240317003043-pzi5vqy","updated":"20240317003212"},"Children":[{"Type":"NodeText","Data":"首先需要进行一次空间变换，将旋转轴"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{r}"},{"Type":"NodeText","Data":"与"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"x"},{"Type":"NodeText","Data":"轴重合。我们可以通过一个旋转矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{M}"},{"Type":"NodeText","Data":"来完成，然后当我们真正需要的旋转变换完成之后，再使用旋转矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{M}^{-1}"},{"Type":"NodeText","Data":"将其旋转回最初的位置。"}]},{"ID":"20240317003217-svxamjj","Type":"NodeParagraph","Properties":{"id":"20240317003217-svxamjj","updated":"20240317003219"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240317003217-m4tyglv.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240317003201-50w5wy7","Type":"NodeParagraph","Properties":{"id":"20240317003201-50w5wy7","updated":"20240317003619"},"Children":[{"Type":"NodeText","Data":"为了计算这个旋转矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{M}"},{"Type":"NodeText","Data":"，我们需要找到两个与旋转轴"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{r}"},{"Type":"NodeText","Data":"正交，且彼此相互正交的轴，从而构建一组标准正交基。其实我们只要能找到第二个轴"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{s}"},{"Type":"NodeText","Data":"即可，因为第三个轴"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{t}"},{"Type":"NodeText","Data":"可以通过前两个轴叉乘的结果获得，即"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{t = r \\times s}"},{"Type":"NodeText","Data":"。有一种数值稳定的方法是：找到原始旋转轴"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{r}"},{"Type":"NodeText","Data":"中的最小分量，然后将其设置为0，再交换剩下两个分量的值，最后再将刚才两个不为0的分量中的任意一个取反即可。"}]},{"ID":"20240317003406-jfp72ex","Type":"NodeMathBlock","Properties":{"id":"20240317003406-jfp72ex","updated":"20240317004918"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{array}{l}\\overline{\\mathbf{s}}=\\left\\{\\begin{array}{ll}\\left(0,-r_{z}, r_{y}\\right), \u0026 \\text { if }\\left|r_{x}\\right| \\leq\\left|r_{y}\\right| \\text { and }\\left|r_{x}\\right| \\leq\\left|r_{z}\\right|, \\\\ \\left(-r_{z}, 0, r_{x}\\right), \u0026 \\text { if }\\left|r_{y}\\right| \\leq\\left|r_{x}\\right| \\text { and }\\left|r_{y}\\right| \\leq\\left|r_{z}\\right|, \\\\ \\left(-r_{y}, r_{x}, 0\\right), \u0026 \\text { if }\\left|r_{z}\\right| \\leq\\left|r_{x}\\right| \\text { and }\\left|r_{z}\\right| \\leq\\left|r_{y}\\right|,\\end{array}\\right. \\\\[6mm] \\mathbf{s}=\\overline{\\mathbf{s}} /|| \\overline{\\mathbf{s}}||, \\\\[1mm] \\mathbf{t}=\\mathbf{r} \\times \\mathbf{s} .\\end{array}\n\\tag{4.27}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240317003421-40q9ti1","Type":"NodeParagraph","Properties":{"id":"20240317003421-40q9ti1","updated":"20240317003539"},"Children":[{"Type":"NodeText","Data":"由此可构建旋转矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{M}"}]},{"ID":"20240317003540-6n223tj","Type":"NodeMathBlock","Properties":{"id":"20240317003540-6n223tj","updated":"20240317003549"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{M}= \n\n \\left ( \\begin{array}{}\n\\mathbf{r}^T \\\\\n\\mathbf{s}^T \\\\\n\\mathbf{t}^T \\\\\n\\end{array}  \\right)\n\n\\tag{4.28}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240317003549-y5cm9d0","Type":"NodeParagraph","Properties":{"id":"20240317003549-y5cm9d0","updated":"20240317003653"},"Children":[{"Type":"NodeText","Data":"旋转后"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{r}"},{"Type":"NodeText","Data":"与"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"x"},{"Type":"NodeText","Data":"重合，此时应用旋转，然后再转回去即可："}]},{"ID":"20240317003653-wxi625g","Type":"NodeMathBlock","Properties":{"id":"20240317003653-wxi625g","updated":"20240317004914"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{X} = \\mathbf{M}^T \\mathbf{R}_x(\\alpha) \\mathbf{M}\n\n\\tag{4.29}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240317003710-gwzzla4","Type":"NodeParagraph","Properties":{"id":"20240317003710-gwzzla4","updated":"20240317003747"},"Children":[{"Type":"NodeText","Data":"另一种绕任意轴旋转"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi"},{"Type":"NodeText","Data":"度的方法："}]},{"ID":"20240317003747-mqvv4km","Type":"NodeMathBlock","Properties":{"id":"20240317003747-mqvv4km","updated":"20240317003753"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{R} = \\left(\\begin{array}{ccc}\n\\cos \\phi+(1-\\cos \\phi) r_{x}^{2} \u0026 (1-\\cos \\phi) r_{x} r_{y}-r_{z} \\sin \\phi \u0026 (1-\\cos \\phi) r_{x} r_{z}+r_{y} \\sin \\phi \\\\ \n(1-\\cos \\phi) r_{x} r_{y}+r_{z} \\sin \\phi \u0026 \\cos \\phi+(1-\\cos \\phi) r_{y}^{2} \u0026 (1-\\cos \\phi) r_{y} r_{z}-r_{x} \\sin \\phi \\\\ \n(1-\\cos \\phi) r_{x} r_{z}-r_{y} \\sin \\phi \u0026 (1-\\cos \\phi) r_{y} r_{z}+r_{x} \\sin \\phi \u0026 \\cos \\phi+(1-\\cos \\phi) r_{z}^{2}\n\\end{array}\\right)\n\\tag{4.30}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240317003753-3ik0gia","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240317003753-3ik0gia","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.3 四元数"}]},{"ID":"20240317003803-mvobu1x","Type":"NodeParagraph","Properties":{"id":"20240317003803-mvobu1x","updated":"20240317003833"},"Children":[{"Type":"NodeText","Data":"四元数可以用于表示旋转和方向，它在很多地方都比欧拉角和矩阵表示更加优秀。四元数可以用于稳定且恒定速度的方向插值，这是欧拉角很难实现的。"}]},{"ID":"20240317003848-uc4nfyb","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240317003848-uc4nfyb","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.3.1 数学背景"}]},{"ID":"20240317003901-34bjcpo","Type":"NodeParagraph","Properties":{"id":"20240317003901-34bjcpo","updated":"20240317003915"},"Children":[{"Type":"NodeText","Data":"定义："}]},{"ID":"20240317003915-bi0179j","Type":"NodeMathBlock","Properties":{"id":"20240317003915-bi0179j","updated":"20240317003931"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{aligned} \n\\hat{\\mathbf{q}} \u0026=\\left(\\mathbf{q}_{v}, q_{w}\\right)=i q_{x}+j q_{y}+k q_{z}+q_{w}=\\mathbf{q}_{v}+q_{w},\n\\\\ \\mathbf{q}_{v} \u0026=i q_{x}+j q_{y}+k q_{z}=\\left(q_{x}, q_{y}, q_{z}\\right),\n\\\\ i^{2} \u0026=j^{2}=k^{2}=-1, j k=-k j=i, k i=-i k=j, i j=-j i=k.\n\\end{aligned} \n\\tag{4.31}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240317004026-mm6holc","Type":"NodeParagraph","Properties":{"id":"20240317004026-mm6holc","updated":"20240317004330"},"Children":[{"Type":"NodeText","Data":"其中变量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"q_w"},{"Type":"NodeText","Data":"是四元数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{q}}"},{"Type":"NodeText","Data":"中的实数部分（实部），变量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{q_v}"},{"Type":"NodeText","Data":"是四元数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{q}}"},{"Type":"NodeText","Data":"中的虚数部分（虚部），"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"i,j,k"},{"Type":"NodeText","Data":"叫做虚数单位。四元数的结构和复数类似，但是"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"复数只有一个虚部，而四元数则包含三个虚部"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240317004331-lba8qjw","Type":"NodeParagraph","Properties":{"id":"20240317004331-lba8qjw","updated":"20240317004852"},"Children":[{"Type":"NodeText","Data":"对于虚部"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{q_v}"},{"Type":"NodeText","Data":"，我们可以将其看作为一个三维向量，可以对其应用诸如加法、缩放、点乘、叉乘以及其他的向量操作。利用四元数的定义，我们可以得到两个四元数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{q},\\hat{r}}"},{"Type":"NodeText","Data":"之间的乘法运算​"}]},{"ID":"20240317004347-tuadruu","Type":"NodeMathBlock","Properties":{"id":"20240317004347-tuadruu","updated":"20240318002707"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{aligned}  \\mathbf{ 乘法: } \\quad \\hat{\\mathbf{q}} \\hat{\\mathbf{r}}=\u0026\\left(i q_{x}+j q_{y}+k q_{z}+q_{w}\\right)\\left(i r_{x}+j r_{y}+k r_{z}+r_{w}\\right) \\\\=\u0026 i\\left(q_{y} r_{z}-q_{z} r_{y}+r_{w} q_{x}+q_{w} r_{x}\\right) \\\\ \u0026+j\\left(q_{z} r_{x}-q_{x} r_{z}+r_{w} q_{y}+q_{w} r_{y}\\right) \\\\ \u0026+k\\left(q_{x} r_{y}-q_{y} r_{x}+r_{w} q_{z}+q_{w} r_{z}\\right) \\\\ \u0026+q_{w} r_{w}-q_{x} r_{x}-q_{y} r_{y}-q_{z} r_{z} \\\\=\u0026\\left(\\mathbf{q}_{v} \\times \\mathbf{r}_{v}+r_{w} \\mathbf{q}_{v}+q_{w} \\mathbf{r}_{v}, q_{w} r_{w}-\\mathbf{q}_{v} \\cdot \\mathbf{r}_{v}\\right) . \\end{aligned}\n\\tag{4.32}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240317005127-3pz5t06","Type":"NodeParagraph","Properties":{"id":"20240317005127-3pz5t06","updated":"20240317005205"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"虚数单位之间的乘法是不具备交换律的"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240317005329-hn2lnqf","Type":"NodeBlockquote","Properties":{"id":"20240317005329-hn2lnqf","updated":"20240317005932"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240317005352-cq340hp","Type":"NodeParagraph","Properties":{"id":"20240317005352-cq340hp","updated":"20240317005718"},"Children":[{"Type":"NodeText","Data":"叉乘（Cross Product）又称向量积（Vector Product）。\n在空间中有两个向量："},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":" \\vec{a}=(x_1,y_1,z_1)"},{"Type":"NodeText","Data":"与"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\vec{b}=(x_2,y_2,z_2)"},{"Type":"NodeText","Data":","},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\vec{a}与\\vec{b}夹角为\\theta"},{"Type":"NodeText","Data":"，\n从代数角度计算："}]},{"ID":"20240317005558-g5hx9dd","Type":"NodeMathBlock","Properties":{"id":"20240317005558-g5hx9dd","updated":"20240317005851"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\vec{a}\\times\\vec{b}=(y_1z_2-z_1y_2,z_1x_2-x_1z_x,x_1y_2-y_1x_2)"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240317005737-iti85gv","Type":"NodeParagraph","Properties":{"id":"20240317005737-iti85gv","updated":"20240317005854"},"Children":[{"Type":"NodeText","Data":"从几何角度计算："}]},{"ID":"20240317005557-m2o8tkj","Type":"NodeMathBlock","Properties":{"id":"20240317005557-m2o8tkj","updated":"20240317005855"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\vec{a}\\times\\vec{b}=\\lvert\\vec{a}\\rvert\\lvert\\vec{b}\\rvert sin\\theta\\vec{n}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240317005737-99nnn1w","Type":"NodeParagraph","Properties":{"id":"20240317005737-99nnn1w","updated":"20240317005932"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\vec{n}"},{"Type":"NodeText","Data":"为法线单位向量，其运算结果是一个向量，并且与这两个向量都垂直，是这两个向量所在平面的法线向量。"}]}]},{"ID":"20240318002703-dmwvtnj","Type":"NodeMathBlock","Properties":{"id":"20240318002703-dmwvtnj","updated":"20240318004322"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{align}{}\n\u0026\\mathbf{加法} :\u0026\\hat{\\mathbf{q}}+\\hat{\\mathbf{r}}=(\\mathbf{q}_{v}, q_{w})+(\\mathbf{r}_{v}, r_{w})=(\\mathbf{q}_{v}+\\mathbf{r}_{v}, q_{w}+r_{w}) \\\\[5mm]\n\n\u0026\\mathbf{共轭} :\u0026 \\hat{\\mathbf{q}}^{*}=\\left(\\mathbf{q}_{v}, q_{w}\\right)^{*}=\\left(-\\mathbf{q}_{v}, q_{w}\\right)\\\\[5mm]\n\n\u0026\\mathbf{模长}:\u0026\n\\begin{aligned}{}\nn(\\hat{\\mathbf{q}}) \u0026=\\sqrt{\\hat{\\mathbf{q}} \\hat{\\mathbf{q}}^{*}}=\\sqrt{\\hat{\\mathbf{q}}^{*} \\hat{\\mathbf{q}}}=\\sqrt{\\mathbf{q}_{v} \\cdot \\mathbf{q}_{v}+q_{w}^{2}} \\\\\u0026=\\sqrt{q_{x}^{2}+q_{y}^{2}+q_{z}^{2}+q_{w}^{2}} .\n\\end{aligned}\\\\[5mm]\n\u0026\\mathbf{虚数单位}: \u0026\\quad \\hat{\\mathbf{i}}=(\\mathbf{0}, 1)\n\\end{align} \n\\tag{4.33}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318002719-oxlyr34","Type":"NodeParagraph","Properties":{"id":"20240318002719-oxlyr34","updated":"20240318002954"},"Children":[{"Type":"NodeText","Data":"使用符号"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\hat{\\mathbf{q}}^{-1}"},{"Type":"NodeText","Data":"表示一个四元数的逆，有："},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\hat{\\mathbf{q}}^{-1} \\hat{\\mathbf{q}} = \\hat{\\mathbf{q}} \\hat{\\mathbf{q}}^{-1} =1"},{"Type":"NodeText"}]},{"ID":"20240318002808-k9xuez8","Type":"NodeParagraph","Properties":{"id":"20240318002808-k9xuez8","updated":"20240318003008"},"Children":[{"Type":"NodeText","Data":"根据虚数模长的定义，我们可以推导出:"}]},{"ID":"20240318003012-qb4ysfa","Type":"NodeMathBlock","Properties":{"id":"20240318003012-qb4ysfa","updated":"20240318003015"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"n(\\hat{\\mathbf{q}})^{2}=\\hat{\\mathbf{q}} \\hat{\\mathbf{q}}^{*} \\Longleftrightarrow \\frac{\\hat{\\mathbf{q}} \\hat{\\mathbf{q}}^{*}}{n(\\hat{\\mathbf{q}})^{2}}=1\n\\tag{4.34}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318003015-2yhkkjn","Type":"NodeParagraph","Properties":{"id":"20240318003015-2yhkkjn","updated":"20240318003019"},"Children":[{"Type":"NodeText","Data":"可以推导出四元数逆的计算公式："}]},{"ID":"20240318003024-cgpjike","Type":"NodeMathBlock","Properties":{"id":"20240318003024-cgpjike","updated":"20240318003237"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{四元数的逆:}\\qquad \\hat{\\mathbf{q}}^{-1}=\\frac{1}{n(\\hat{\\mathbf{q}})^{2}} \\hat{\\mathbf{q}}^{*}\n\\tag{4.35}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318003027-d2n4p9s","Type":"NodeParagraph","Properties":{"id":"20240318003027-d2n4p9s","updated":"20240318003127"},"Children":[{"Type":"NodeText","Data":"即四元数的逆是四元数的共轭乘模平方之一。"}]},{"ID":"20240318003128-322m9j5","Type":"NodeParagraph","Properties":{"id":"20240318003128-322m9j5","updated":"20240318003205"},"Children":[{"Type":"NodeText","Data":"复数的标量乘法具备交换律，即： "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s \\hat{\\mathbf{q}} = \\hat{\\mathbf{q}} s = \\left(s \\mathbf{q}_{v}, s q_{w}\\right)  "},{"Type":"NodeText","Data":"。"}]},{"ID":"20240318003154-w0ax8kg","Type":"NodeParagraph","Properties":{"id":"20240318003154-w0ax8kg","updated":"20240318003214"},"Children":[{"Type":"NodeText","Data":"可以推导出下属法则："}]},{"ID":"20240318003214-a1eunmq","Type":"NodeMathBlock","Properties":{"id":"20240318003214-a1eunmq","updated":"20240318003238"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{align}\n\n\\left(\\hat{\\mathbf{q}}^{*}\\right)^{*} \u0026=\\hat{\\mathbf{q}}, \\\\\n\\mathbf{共轭法则:} \\qquad(\\hat{\\mathbf{q}}+\\hat{\\mathbf{r}})^{*} \u0026=\\hat{\\mathbf{q}}^{*}+\\hat{\\mathbf{r}}^{*}, \\\\\n(\\hat{\\mathbf{q}} \\hat{\\mathbf{r}})^{*} \u0026=\\hat{\\mathbf{r}}^{*} \\hat{\\mathbf{q}}^{*} . \n\\end{align} \\tag{4.36}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318003221-osf86a0","Type":"NodeMathBlock","Properties":{"id":"20240318003221-osf86a0","updated":"20240318003236"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{align}\n\\mathbf{模长法则:} \\qquad n\\left(\\hat{\\mathbf{q}}^{*}\\right)\u0026=n(\\hat{\\mathbf{q}})\\\\\nn(\\hat{\\mathbf{q}} \\hat{\\mathbf{r}})\u0026=n(\\hat{\\mathbf{q}}) n(\\hat{\\mathbf{r}})  \n\\end{align}\\tag{4.37}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318003238-1dx2mzt","Type":"NodeMathBlock","Properties":{"id":"20240318003238-1dx2mzt","updated":"20240318003250"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{align}{}\n\\mathbf{乘法分配律：}\u0026\\qquad \n\\begin{array}{l}\\hat{\\mathbf{p}}(s \\hat{\\mathbf{q}}+t \\hat{\\mathbf{r}})=s \\hat{\\mathbf{p}} \\hat{\\mathbf{q}}+t \\hat{\\mathbf{p}} \\hat{\\mathbf{r}} \\\\\n(s \\hat{\\mathbf{p}}+t \\hat{\\mathbf{q}}) \\hat{\\mathbf{r}}=s \\hat{\\mathbf{p}} \\hat{\\mathbf{r}}+t \\hat{\\mathbf{q}} \\hat{\\mathbf{r}}\n\\end{array} \\\\[5mm]\n\\mathbf{乘法结合律：}\u0026 \\qquad \\hat{\\mathbf{p}}(\\hat{\\mathbf{q}} \\hat{\\mathbf{r}})=(\\hat{\\mathbf{p}} \\hat{\\mathbf{q}}) \\hat{\\mathbf{r}} \n\\end{align}\\tag{4.38}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318003250-345u6wu","Type":"NodeParagraph","Properties":{"id":"20240318003250-345u6wu","updated":"20240318003330"},"Children":[{"Type":"NodeText","Data":"单位四元数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\hat{\\mathbf{q}}=\\left(\\mathbf{q}_{v}, q_{w}\\right)"},{"Type":"NodeText","Data":"的长度（模长）为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n\\left(\\hat{\\mathbf{q}}\\right)=1"},{"Type":"NodeText","Data":"。因此对于某些长度为1的三维向量"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{u}_{q}"},{"Type":"NodeText","Data":"，我们可以将这个四元数改写成如下形式："}]},{"ID":"20240318003313-rj7pzss","Type":"NodeMathBlock","Properties":{"id":"20240318003313-rj7pzss","updated":"20240318003336"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\hat{\\mathbf{q}}=\\left(\\sin \\phi \\mathbf{u}_{q}, \\cos \\phi\\right)=\\sin \\phi \\mathbf{u}_{q}+\\cos \\phi = \n\\cos \\phi + \\sin \\phi(\\mathbf{u}_{qx} + \\mathbf{u}_{qy} + \\mathbf{u}_{qz})\n\\tag{4.39}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318003336-0ppl2yd","Type":"NodeParagraph","Properties":{"id":"20240318003336-0ppl2yd","updated":"20240526213016"},"Children":[{"Type":"NodeText","Data":"对于复数而言，一个二维单位向量可以被写成"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\cos \\phi + i\\sin \\phi = e^{i \\phi}"},{"Type":"NodeText","Data":"的形式（复变函数中的欧拉公式）；而对于一个四元数来说，其等价形式如下"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"："}]},{"ID":"20240318003406-4y34y6u","Type":"NodeParagraph","Properties":{"id":"20240318003406-4y34y6u"}},{"ID":"20240318003407-hu1zwm4","Type":"NodeMathBlock","Properties":{"id":"20240318003407-hu1zwm4","updated":"20240318003414"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\hat{\\mathbf{q}}=\\sin \\phi \\mathbf{u}_{q}+\\cos \\phi=e^{\\phi \\mathbf{u}_{q}}\n\\tag{4.41}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318003409-993bccu","Type":"NodeParagraph","Properties":{"id":"20240318003409-993bccu","updated":"20240318003439"},"Children":[{"Type":"NodeText","Data":"对于一个单位四元数而言，其对数运算和幂运算遵循以下规则:"}]},{"ID":"20240318003439-8wcux5y","Type":"NodeMathBlock","Properties":{"id":"20240318003439-8wcux5y","updated":"20240417223625"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{align}{}\n\u0026\\mathbf{ Logarithm:}  \\qquad  \\log (\\hat{\\mathbf{q}})=\\log \\left(e^{\\phi \\mathbf{u}_{q}}\\right)=\\phi \\mathbf{u}_{q}\\\\[3mm]\n\u0026\\mathbf{Power: } \\qquad  \\qquad  \\hat{\\mathbf{q}}^{t}=\\left(\\sin \\phi \\mathbf{u}_{q}+\\cos \\phi\\right)^{t}=e^{\\phi t \\mathbf{u}_{q}}=\\sin (\\phi t) \\mathbf{u}_{q}+\\cos (\\phi t). \n\\end{align} \\tag{4.42}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318003444-k8pqk5c","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240318003444-k8pqk5c","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.3.2 四元数变换"}]},{"ID":"20240318003605-xu0tvoo","Type":"NodeParagraph","Properties":{"id":"20240318003605-xu0tvoo","updated":"20240318003628"},"Children":[{"Type":"NodeText","Data":"单位四元数可以用于表示任何的三维旋转，而且这种表示方式非常紧凑和简单。它们的模长为1."}]},{"ID":"20240318003629-d30gzyn","Type":"NodeParagraph","Properties":{"id":"20240318003629-d30gzyn","updated":"20240526212757"},"Children":[{"Type":"NodeText","Data":"假设现在有一个点（或者向量）"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{p}=\\left(\\begin{array}{llll}p_{x} \u0026 p_{y} \u0026 p_{z} \u0026 p_{w}\\end{array}\\right)^{T}"},{"Type":"NodeText","Data":"，首先我们将这个点坐标的四个分量对应放入一个四元数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{p}}"},{"Type":"NodeText","Data":"的各个分量中；假设我们现在还有一个单位四元数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{q}} = (\\sin \\phi \\mathbf{u}_{q}+\\cos \\phi)"},{"Type":"NodeText","Data":"，我们对这两个四元数进行如下操作"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"："}]},{"ID":"20240318003907-khyfoc9","Type":"NodeMathBlock","Properties":{"id":"20240318003907-khyfoc9","updated":"20240526212759"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\hat{\\mathbf{q}} \\hat{\\mathbf{p}} \\hat{\\mathbf{q}}^{-1}\\tag{4.43}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318003926-1c33l50","Type":"NodeParagraph","Properties":{"id":"20240318003926-1c33l50","updated":"20240526212802"},"Children":[{"Type":"NodeText","Data":"这个操作意味着将四元数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{p}}"},{"Type":"NodeText","Data":"（即点"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{p}"},{"Type":"NodeText","Data":"）以"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{u}_{q}"},{"Type":"NodeText","Data":"为旋转轴，旋转了 "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"2\\phi"},{"Type":"NodeText","Data":"  角度。"}]},{"ID":"20240318003943-h9v4g4z","Type":"NodeBlockquote","Properties":{"id":"20240318003943-h9v4g4z","updated":"20240417223010"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240318004108-67au2yp","Type":"NodeParagraph","Properties":{"id":"20240318004108-67au2yp","updated":"20240318004124"},"Children":[{"Type":"NodeText","Data":"为什么选择"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"2\\phi"},{"Type":"NodeText","Data":"?"}]},{"ID":"20240318004126-vmo8yjg","Type":"NodeParagraph","Properties":{"id":"20240318004126-vmo8yjg","updated":"20240417222805"},"Children":[{"Type":"NodeText","Data":"首先乘以"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\hat{q}"},{"Type":"NodeText","Data":"代表"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\hat{p}"},{"Type":"NodeText","Data":"绕"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{u}_{q}"},{"Type":"NodeText","Data":"旋转了"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi"},{"Type":"NodeText","Data":"度。"}]},{"ID":"20240318004232-fk7isvt","Type":"NodeParagraph","Properties":{"id":"20240318004232-fk7isvt","updated":"20240417222748"},"Children":[{"Type":"NodeTextMark","TextMarkType":"s","TextMarkTextContent":"其次，由于是单位四元数，因此"},{"Type":"NodeTextMark","TextMarkType":"inline-math s","TextMarkInlineMathContent":"\\mathbf{\\hat{q}}^{-1} = \\mathbf{\\hat{q}}^{*}"},{"Type":"NodeTextMark","TextMarkType":"s","TextMarkTextContent":"，而"},{"Type":"NodeTextMark","TextMarkType":"inline-math s","TextMarkInlineMathContent":"\\hat{\\mathbf{q}}^{*}=\\left(\\mathbf{q}_{v}, q_{w}\\right)^{*}=\\left(-\\mathbf{q}_{v}, q_{w}\\right)"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"s","TextMarkTextContent":"即对虚数部分取反，表示的是同一套直线，一次仍然是以"},{"Type":"NodeTextMark","TextMarkType":"inline-math s","TextMarkInlineMathContent":"\\hat{q}"},{"Type":"NodeTextMark","TextMarkType":"s","TextMarkTextContent":"代表"},{"Type":"NodeTextMark","TextMarkType":"inline-math s","TextMarkInlineMathContent":"\\hat{p}"},{"Type":"NodeTextMark","TextMarkType":"s","TextMarkTextContent":"绕"},{"Type":"NodeTextMark","TextMarkType":"inline-math s","TextMarkInlineMathContent":"\\mathbf{u}_{q}"},{"Type":"NodeTextMark","TextMarkType":"s","TextMarkTextContent":"旋转了"},{"Type":"NodeTextMark","TextMarkType":"inline-math s","TextMarkInlineMathContent":"\\phi"},{"Type":"NodeTextMark","TextMarkType":"s","TextMarkTextContent":"度。"}]},{"ID":"20240417222751-d48cst3","Type":"NodeParagraph","Properties":{"id":"20240417222751-d48cst3","updated":"20240417222918"},"Children":[{"Type":"NodeText","Data":"左乘"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\hat{q}"},{"Type":"NodeText","Data":"让它的球面投影变成了非单位球，而右乘"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\hat{q}^{-1}"},{"Type":"NodeText","Data":"使其从非单位球变回了单位球。"}]},{"ID":"20240417222919-hyxne6k","Type":"NodeParagraph","Properties":{"id":"20240417222919-hyxne6k","updated":"20240417222937"},"Children":[{"Type":"NodeText","Data":"参考："}]},{"ID":"20240417222938-shhny8t","Type":"NodeParagraph","Properties":{"id":"20240417222938-shhny8t","updated":"20240417223010"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://www.bilibili.com/video/BV1SW411y7W1/?spm_id_from=333.337.search-card.all.click","TextMarkTextContent":"四元数的可视化_哔哩哔哩_bilibili"},{"Type":"NodeText","Data":" ＆ "},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://www.bilibili.com/video/BV1Lt411U7og/?spm_id_from=333.788.recommend_more_video.-1\u0026amp;vd_source=dcc481c1d3245018bb5c23265b453db4","TextMarkTextContent":"四元数和三维转动，可互动的探索式视频（请看链接）_哔哩哔哩_bilibili"}]}]},{"ID":"20240318004414-rg24hbs","Type":"NodeParagraph","Properties":{"id":"20240318004414-rg24hbs","updated":"20240318004526"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"给定两个单位四元数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{q}}"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"和"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{r}}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，我们首先对"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{p}}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"（可以被认为一个点或者是一个向量）应用四元数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{q}}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"所代表的旋转变换，然后再应用四元数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{r}}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"所代表的变换"}]},{"ID":"20240318004527-oalj1qf","Type":"NodeMathBlock","Properties":{"id":"20240318004527-oalj1qf","updated":"20240318004534"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\n\\hat{\\mathbf{r}}\\left(\\hat{\\mathbf{q}} \\hat{\\mathbf{p}} \\hat{\\mathbf{q}}^{*}\\right) \\hat{\\mathbf{r}}^{*}=\n(\\hat{\\mathbf{r}} \\hat{\\mathbf{q}}) \\hat{\\mathbf{p}}(\\hat{\\mathbf{r}} \\hat{\\mathbf{q}})^{*}\n=\n\\hat{\\mathbf{c}} \\hat{\\mathbf{p}} \\hat{\\mathbf{c}}^{*}\n\\tag{4.44}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318004520-4w1c0xv","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240318004520-4w1c0xv","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.3.2.1 矩阵变换"}]},{"ID":"20240318004546-kcdd9nw","Type":"NodeParagraph","Properties":{"id":"20240318004546-kcdd9nw","updated":"20240318004622"},"Children":[{"Type":"NodeText","Data":"一个四元数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\hat{q}"},{"Type":"NodeText","Data":"可以转换为一个变换矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{M^q}"},{"Type":"NodeText","Data":",如下："}]},{"ID":"20240318004622-htgapmx","Type":"NodeMathBlock","Properties":{"id":"20240318004622-htgapmx","updated":"20240318004630"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{M}^{q}=\\left(\\begin{array}{cccc}1-s\\left(q_{y}^{2}+q_{z}^{2}\\right) \u0026 s\\left(q_{x} q_{y}-q_{w} q_{z}\\right) \u0026 s\\left(q_{x} q_{z}+q_{w} q_{y}\\right) \u0026 0 \\\\ s\\left(q_{x} q_{y}+q_{w} q_{z}\\right) \u0026 1-s\\left(q_{x}^{2}+q_{z}^{2}\\right) \u0026 s\\left(q_{y} q_{z}-q_{w} q_{x}\\right) \u0026 0 \\\\ s\\left(q_{x} q_{z}-q_{w} q_{y}\\right) \u0026 s\\left(q_{y} q_{z}+q_{w} q_{x}\\right) \u0026 1-s\\left(q_{x}^{2}+q_{y}^{2}\\right) \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 1\\end{array}\\right)\n\\tag{4.45}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318004630-xivlmrl","Type":"NodeParagraph","Properties":{"id":"20240318004630-xivlmrl","updated":"20240318004658"},"Children":[{"Type":"NodeText","Data":"其中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s=2 /(n(\\hat{\\mathbf{q}}))^{2}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240318004659-wqbeui1","Type":"NodeParagraph","Properties":{"id":"20240318004659-wqbeui1","updated":"20240318004731"},"Children":[{"Type":"NodeText","Data":"对于一个单位四元数而言，可简化为："}]},{"ID":"20240318004732-e5mlaoh","Type":"NodeMathBlock","Properties":{"id":"20240318004732-e5mlaoh","updated":"20240318004746"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{M}^{q}=\\left(\\begin{array}{cccc}1-2\\left(q_{y}^{2}+q_{z}^{2}\\right) \u0026 2\\left(q_{x} q_{y}-q_{w} q_{z}\\right) \u0026 2\\left(q_{x} q_{z}+q_{w} q_{y}\\right) \u0026 0 \\\\ 2\\left(q_{x} q_{y}+q_{w} q_{z}\\right) \u0026 1-2\\left(q_{x}^{2}+q_{z}^{2}\\right) \u0026 2\\left(q_{y} q_{z}-q_{w} q_{x}\\right) \u0026 0 \\\\ 2\\left(q_{x} q_{z}-q_{w} q_{y}\\right) \u0026 2\\left(q_{y} q_{z}+q_{w} q_{x}\\right) \u0026 1-2\\left(q_{x}^{2}+q_{y}^{2}\\right) \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 1\\end{array}\\right)\n\\tag{4.46}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318004746-4irwf69","Type":"NodeParagraph","Properties":{"id":"20240318004746-4irwf69","updated":"20240318004817"},"Children":[{"Type":"NodeText","Data":"此时方程不含任何三角函数运，在实际应用时效率很高。"}]},{"ID":"20240318004901-jz907dq","Type":"NodeParagraph","Properties":{"id":"20240318004901-jz907dq","updated":"20240318004913"},"Children":[{"Type":"NodeText","Data":"通过一个矩阵计算四元数的方法如下："}]},{"ID":"20240318004913-ynpv1fp","Type":"NodeParagraph","Properties":{"id":"20240318004913-ynpv1fp","updated":"20240318004951"},"Children":[{"Type":"NodeText","Data":"首先算出矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{M^q}"},{"Type":"NodeText","Data":"的迹，即住对角线元素之和。"}]},{"ID":"20240318004953-8z1zqfq","Type":"NodeMathBlock","Properties":{"id":"20240318004953-8z1zqfq","updated":"20240318005001"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{aligned} \\operatorname{tr}\\left(\\mathbf{M}^{q}\\right) \u0026 =4-2 s\\left(q_{x}^{2}+q_{y}^{2}+q_{z}^{2}\\right)=4\\left(1-\\frac{q_{x}^{2}+q_{y}^{2}+q_{z}^{2}}{q_{x}^{2}+q_{y}^{2}+q_{z}^{2}+q_{w}^{2}}\\right) \\\\ \u0026 =\\frac{4 q_{w}^{2}}{q_{x}^{2}+q_{y}^{2}+q_{z}^{2}+q_{w}^{2}}=\\frac{4 q_{w}^{2}}{(n(\\hat{\\mathbf{q}}))^{2}} .\\end{aligned}\n\\tag{4.48}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318005001-zx4uuws","Type":"NodeParagraph","Properties":{"id":"20240318005001-zx4uuws","updated":"20240318005133"},"Children":[{"Type":"NodeText","Data":"则其他几项为："}]},{"ID":"20240318005133-rtajaum","Type":"NodeMathBlock","Properties":{"id":"20240318005133-rtajaum","updated":"20240418205306"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{array}{ll}q_{w}=\\frac{1}{2} \\sqrt{\\operatorname{tr}\\left(\\mathbf{M}^{q}\\right)}, \u0026 q_{x}=\\dfrac{m_{21}^{q}-m_{12}^{q}}{4 q_{w}}, \\\\[3mm] q_{y}=\\dfrac{m_{02}^{q}-m_{20}^{q}}{4 q_{w}}, \u0026 q_{z}=\\dfrac{m_{10}^{q}-m_{01}^{q}}{4 q_{w}} .\\end{array}\n\\tag{4.49}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318005139-mz6ezdl","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240318005139-mz6ezdl","updated":"20240526213525"},"Children":[{"Type":"NodeText","Data":"4.3.2.2 球面线性插值"}]},{"ID":"20240318005247-iuc5as6","Type":"NodeParagraph","Properties":{"id":"20240318005247-iuc5as6","updated":"20240318005313"},"Children":[{"Type":"NodeText","Data":"球面线性插值（spherical linear interpolation）是指，给定两个单位四元数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{q}}"},{"Type":"NodeText","Data":"，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{r}}"},{"Type":"NodeText","Data":"以及一个参数"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t \\in [0,1]"},{"Type":"NodeText","Data":"，然后计算出一个插值的四元数。"}]},{"ID":"20240318005303-ga830sq","Type":"NodeParagraph","Properties":{"id":"20240318005303-ga830sq","updated":"20240318005327"},"Children":[{"Type":"NodeText","Data":"其数学表达式如下："}]},{"ID":"20240318005328-m61dhg5","Type":"NodeMathBlock","Properties":{"id":"20240318005328-m61dhg5","updated":"20240318005333"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\hat{\\mathbf{s}}(\\hat{\\mathbf{q}}, \\hat{\\mathbf{r}}, t)=\\left(\\hat{\\mathbf{r}} \\hat{\\mathbf{q}}^{-1}\\right)^{t} \\hat{\\mathbf{q}}\n\\tag{4.52}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318005333-231w6ky","Type":"NodeParagraph","Properties":{"id":"20240318005333-231w6ky","updated":"20240318005348"},"Children":[{"Type":"NodeText","Data":"对于软件实现而言，通常会使用更为合适的slerp函数来代表球面线性插值，其形式如下："}]},{"ID":"20240318005350-op5wojq","Type":"NodeMathBlock","Properties":{"id":"20240318005350-op5wojq","updated":"20240526213525"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\hat{\\mathbf{s}}(\\hat{\\mathbf{q}}, \\hat{\\mathbf{r}}, t)\n=\\operatorname{slerp}(\\hat{\\mathbf{q}}, \\hat{\\mathbf{r}}, t)\n=\\frac{\\sin (\\phi(1-t))}{\\sin \\phi} \\hat{\\mathbf{q}}\n+\\frac{\\sin (\\phi t)}{\\sin \\phi} \\hat{\\mathbf{r}}\n\\tag{4.53}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240318005354-waknxos","Type":"NodeParagraph","Properties":{"id":"20240318005354-waknxos","updated":"20240318005445"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"其中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\cos \\phi=q_{x} r_{x}+q_{y} r_{y}+q_{z} r_{z}+q_{w} r_{w}"},{"Type":"NodeText","Data":"，slerp函数所计算出的四元数是唯一的（"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"当且仅当"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"inline-math text","TextMarkInlineMathContent":"\\mathbf{\\hat{q}}不与\\mathbf{\\hat{r}}"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"反向"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeText","Data":"）。"}]},{"ID":"20240318005435-rsmuv8e","Type":"NodeParagraph","Properties":{"id":"20240318005435-rsmuv8e","updated":"20240318005507"},"Children":[{"Type":"NodeText","Data":"这些插值生成的四元数组合在一起，构成了一个四维单位球面上，从"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{q}}(t=0)到\\mathbf{\\hat{r}}(t=1)"},{"Type":"NodeText","Data":"的最短弧。"}]},{"ID":"20240318005512-nta8w1b","Type":"NodeParagraph","Properties":{"id":"20240318005512-nta8w1b","updated":"20240318005514"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240318005512-ui14ho3.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240318005623-80fkbra","Type":"NodeParagraph","Properties":{"id":"20240318005623-80fkbra","updated":"20240318005639"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"当现在有两个以上的方向时，例如"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\hat{\\mathbf{q}}_{0}, \\hat{\\mathbf{q}}_{1}, \\ldots, \\hat{\\mathbf{q}}_{n-1}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，我们希望可以从从"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{q}}_1"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"插值到"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{q}}_2"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，再插值到"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{\\hat{q}}_3"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，直到最终插值到"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\hat{\\mathbf{q}}_{n-1}"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"，使用slerp函数是最直接的方式。"}]},{"ID":"20240318005640-n4u8uyy","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240318005640-n4u8uyy","updated":"20240517092339"},"Children":[{"Type":"NodeText","Data":"4.3.2.3 从一个向量旋转到另一个向量"}]},{"ID":"20240318005628-js9p7bn","Type":"NodeParagraph","Properties":{"id":"20240318005628-js9p7bn","updated":"20240418194637"},"Children":[{"Type":"NodeText","Data":"将方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s"},{"Type":"NodeText","Data":"以最短路径变换到一个方向"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t"},{"Type":"NodeText","Data":"，首先将"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s"},{"Type":"NodeText","Data":"与"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t"},{"Type":"NodeText","Data":"归一化，然后通过"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{u}=(\\mathbf{s} \\times \\mathbf{t}) /\\|\\mathbf{s} \\times \\mathbf{t}\\|"},{"Type":"NodeText","Data":"计算归一化旋转轴（同时垂直于"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s"},{"Type":"NodeText","Data":"和"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t"},{"Type":"NodeText","Data":"）,然后令"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"e=\\mathbf{s} \\cdot \\mathbf{t}=\\cos (2 \\phi) ， \\|\\mathbf{s} \\times \\mathbf{t}\\|=\\sin (2 \\phi)"},{"Type":"NodeText","Data":","},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"2\\phi"},{"Type":"NodeText","Data":"是"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s"},{"Type":"NodeText","Data":"和"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t"},{"Type":"NodeText","Data":"的夹角。这时候就可以表示从"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s"},{"Type":"NodeText","Data":"变换到"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t"},{"Type":"NodeText","Data":"的四元数，即"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\hat{\\mathbf{q}}=(\\sin \\phi \\mathbf{u}, \\cos \\phi)"},{"Type":"NodeText","Data":",展开得到"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\hat{\\mathbf{q}}=\\left(\\frac{\\sin \\phi}{\\sin 2 \\phi}(\\mathbf{s} \\times \\mathbf{t}), \\cos \\phi\\right)"},{"Type":"NodeText","Data":"，又"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\cos \\phi=\\sqrt{\\frac{e+1}{2}}"},{"Type":"NodeText","Data":"进一步化简得到："}]},{"ID":"20240418194638-5vhfjdk","Type":"NodeMathBlock","Properties":{"id":"20240418194638-5vhfjdk","updated":"20240418194645"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\hat{\\mathbf{q}}=\n\\left(\\mathbf{q}_{v}, q_{w}\\right)\n=\\left(\n\\frac{1}{\\sqrt{2(1+e)}}(\\mathbf{s} \\times \\mathbf{t}), \n\\frac{\\sqrt{2(1+e)}}{2}\n\\right)\n\\tag{4.56}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240418194227-5gvfmaa","Type":"NodeParagraph","Properties":{"id":"20240418194227-5gvfmaa","updated":"20240418194928"},"Children":[{"Type":"NodeText","Data":"这种方法可以避免当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s"},{"Type":"NodeText","Data":"和"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t"},{"Type":"NodeText","Data":"几乎指向相同方向时造成的数值不稳定，但是"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s"},{"Type":"NodeText","Data":"和"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t"},{"Type":"NodeText","Data":"反向时，会出现数值不稳定的情况（分母为0）。此时可以使用任何一个垂直于"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s"},{"Type":"NodeText","Data":"的向量做旋转轴然后将"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s"},{"Type":"NodeText","Data":"旋转到"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t"},{"Type":"NodeText","Data":"."}]},{"ID":"20240418194928-ni96ow7","Type":"NodeParagraph","Properties":{"id":"20240418194928-ni96ow7","updated":"20240418194939"},"Children":[{"Type":"NodeText","Data":"从"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s"},{"Type":"NodeText","Data":"到"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t"},{"Type":"NodeText","Data":"的旋转矩阵可以表示为"}]},{"ID":"20240418194940-fbplfj8","Type":"NodeMathBlock","Properties":{"id":"20240418194940-fbplfj8","updated":"20240418194948"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{R}(\\mathbf{s}, \\mathbf{t})=\\left(\\begin{array}{cccc}e+h v_{x}^{2} \u0026 h v_{x} v_{y}-v_{z} \u0026 h v_{x} v_{z}+v_{y} \u0026 0 \\\\ h v_{x} v_{y}+v_{z} \u0026 e+h v_{y}^{2} \u0026 h v_{y} v_{z}-v_{x} \u0026 0 \\\\ h v_{x} v_{z}-v_{y} \u0026 h v_{y} v_{z}+v_{x} \u0026 e+h v_{z}^{2} \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 1\\end{array}\\right)\n\\tag{4.57}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240418194949-zzepeec","Type":"NodeParagraph","Properties":{"id":"20240418194949-zzepeec","updated":"20240418195009"},"Children":[{"Type":"NodeText","Data":"其中："}]},{"ID":"20240418195009-2hqhbel","Type":"NodeMathBlock","Properties":{"id":"20240418195009-2hqhbel","updated":"20240418205545"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{aligned} \n\\mathbf{v} \u0026=\\mathbf{s} \\times \\mathbf{t} \\\\ \ne \u0026=\\cos (2 \\phi)=\\mathbf{s} \\cdot \\mathbf{t}, \\\\ \nh \u0026\n=\\frac{1-\\cos (2 \\phi)}{\\sin ^{2}(2 \\phi)}\n=\\frac{1-e}{\\mathbf{v} \\cdot \\mathbf{v}}\n=\\frac{1}{1+e} . \n\\end{aligned}\n\\tag{4.58}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240418195018-0qrvppr","Type":"NodeParagraph","Properties":{"id":"20240418195018-0qrvppr","updated":"20240418195254"},"Children":[{"Type":"NodeText","Data":"当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s"},{"Type":"NodeText","Data":"和"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t"},{"Type":"NodeText","Data":"平行或接近平行时需要格外小心："}]},{"ID":"20240418195255-e7p4931","Type":"NodeList","ListData":{},"Properties":{"id":"20240418195255-e7p4931","updated":"20240418195256"},"Children":[{"ID":"20240418195259-3olbuvp","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240418195259-3olbuvp"},"Children":[{"ID":"20240418195259-x9k9aeo","Type":"NodeParagraph","Properties":{"id":"20240418195259-x9k9aeo","updated":"20240418195317"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi \\approx 0"},{"Type":"NodeText","Data":"时可以返回单位矩阵"}]}]},{"ID":"20240418195317-3uhfnzk","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240418195317-3uhfnzk"},"Children":[{"ID":"20240418195317-ocm1acr","Type":"NodeParagraph","Properties":{"id":"20240418195317-ocm1acr","updated":"20240418195414"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"2\\phi \\approx \\pi"},{"Type":"NodeText","Data":"时可以绕任意旋转轴旋转"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\pi"},{"Type":"NodeText","Data":"弧度，这个轴可以使"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s"},{"Type":"NodeText","Data":"与其他任何不平行于"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"s"},{"Type":"NodeText","Data":"的向量之间的叉乘"}]}]}]},{"ID":"20240418195605-xw54303","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240418195605-xw54303","updated":"20240517092339"},"Children":[{"Type":"NodeText","Data":"4.4 顶点混合"}]},{"ID":"20240418195631-56yqxse","Type":"NodeParagraph","Properties":{"id":"20240418195631-56yqxse","updated":"20240418200046"},"Children":[{"Type":"NodeText","Data":"允许单个顶点被若干个不同的矩阵所变换，并将这些变换所得到的结果加权混合在一起。这是通过为动画物体设置一个骨架来完成的，通过用户自定义的权重，每个骨骼的变换都可能会对其他的顶点产生影响。即"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"所有的顶点都可能会受到多个矩阵变换的影响，因此也可以将整个网格模型称作为包裹骨骼的蒙皮（skin）"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240418200037-wb0y4nb","Type":"NodeParagraph","Properties":{"id":"20240418200037-wb0y4nb","updated":"20240418200157"},"Children":[{"Type":"NodeText","Data":"顶点混合的数学表达式如下："}]},{"ID":"20240418200157-x7lmi24","Type":"NodeMathBlock","Properties":{"id":"20240418200157-x7lmi24","updated":"20240418200202"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{u}(t)=\n\\sum_{i=0}^{n-1} w_{i} \\mathbf{B}_{i}(t) \\mathbf{M}_{i}^{-1} \\mathbf{p},\\  \\text{ where} \\quad \\sum_{i=0}^{n-1} w_{i}=1, \\quad w_{i} \\geq 0 \n\\tag{4.59}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240418200202-nk71ot3","Type":"NodeParagraph","Properties":{"id":"20240418200202-nk71ot3","updated":"20240418200247"},"Children":[{"Type":"NodeText","Data":"其中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{p}"},{"Type":"NodeText","Data":"是原始顶点坐标，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{u}(t)"},{"Type":"NodeText","Data":"是变化后的顶点位置，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t"},{"Type":"NodeText","Data":"是动画事件。"}]},{"ID":"20240418200340-20j31dd","Type":"NodeParagraph","Properties":{"id":"20240418200340-20j31dd","updated":"20240418200452"},"Children":[{"Type":"NodeText","Data":"此方程的含义是有n个骨骼会对点"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{p}"},{"Type":"NodeText","Data":"的世界空间坐标产生影响；"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"w_i"},{"Type":"NodeText","Data":"的值代表了骨骼i对于顶点"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{p}"},{"Type":"NodeText","Data":"坐标的影响权重；矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{M}_{i}^{-1}"},{"Type":"NodeText","Data":"代表骨骼i的模型变换矩阵，它负责将骨骼变换到世界空间中。"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"通常来说，骨骼的控制关节位于自身坐标系的原点位置"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240418200453-sd38jua","Type":"NodeBlockquote","Properties":{"id":"20240418200453-sd38jua","updated":"20240418200502"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240418200454-r1gbmjq","Type":"NodeParagraph","Properties":{"id":"20240418200454-r1gbmjq","updated":"20240418200502"},"Children":[{"Type":"NodeText","Data":"例如对于前臂骨骼而言，其控制关节为肘关节，则肘关节应当位于这个前臂骨骼模型空间的原点处；这样可以直接对模型的旋转矩阵进行动画处理，从而可以对整个前臂进行移动，并且移动结束之后，肘关节仍然位于模型空间的原点处。"}]}]},{"ID":"20240418200332-l3h3hsi","Type":"NodeParagraph","Properties":{"id":"20240418200332-l3h3hsi","updated":"20240418200532"},"Children":[{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{B}_{i}(t)"},{"Type":"NodeText","Data":"是一个世界变换矩阵，代表了地"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"i"},{"Type":"NodeText","Data":"个骨骼的世界变换。"}]},{"ID":"20240418200533-gj1b9tm","Type":"NodeBlockquote","Properties":{"id":"20240418200533-gj1b9tm","updated":"20240418200605"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240418200537-pg002y4","Type":"NodeParagraph","Properties":{"id":"20240418200537-pg002y4","updated":"20240418200605"},"Children":[{"Type":"NodeText","Data":"世界变换矩阵通常是由若干个矩阵连接组成，例如上一层级的变换以及局部的动画矩阵等。"}]}]},{"ID":"20240418200609-rzf2j4o","Type":"NodeParagraph","Properties":{"id":"20240418200609-rzf2j4o","updated":"20240418200753"},"Children":[{"Type":"NodeText","Data":"矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{B}_{i}(t)"},{"Type":"NodeText","Data":"和矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{M}_{i}^{-1}"},{"Type":"NodeText","Data":"在每一帧种都会进行连接组合，最终生成的变换矩阵会被用于对顶点进行变换。点"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{p}"},{"Type":"NodeText","Data":"会被不同骨骼的变换矩阵进行变换，并通过使用权重"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"w_i"},{"Type":"NodeText","Data":"，来将这些变换进行加权混合——这也是顶点混合的名称由来。"}]},{"ID":"20240418200753-jo6arme","Type":"NodeParagraph","Properties":{"id":"20240418200753-jo6arme","updated":"20240418201805"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"这些权重的值通常都是非负的，且它们的和为1"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeText","Data":"。点"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{p}"},{"Type":"NodeText","Data":"会被变换到若干个位置上，并在这些位置之间进行插值。"}]},{"ID":"20240418200806-1y5690b","Type":"NodeParagraph","Properties":{"id":"20240418200806-1y5690b","updated":"20240418201803"},"Children":[{"Type":"NodeText","Data":"换句话说，对于一个固定的时刻"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t"},{"Type":"NodeText","Data":"，最终插值出来的点"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{u}"},{"Type":"NodeText","Data":"位于点集"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{B}_{i}(t) \\mathbf{M}_{i}^{-1} \\mathbf{p},\\quad i = 0 \\cdots n-1"},{"Type":"NodeText","Data":"的凸包（convex hull）内部。"}]},{"ID":"20240418201220-qss5412","Type":"NodeParagraph","Properties":{"id":"20240418201220-qss5412","updated":"20240418205745"},"Children":[{"Type":"NodeText","Data":"如果骨骼被大量拉伸或者挤压，就需要使用矩阵"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathbf{B}_{i}(t) \\mathbf{M}_{i}^{-1}"},{"Type":"NodeText","Data":"的逆来对法线进行变换。"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-card-error-color); background-color: var(--b3-card-error-background);"},"TextMarkType":"em text","TextMarkTextContent":"见"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-card-error-color); background-color: var(--b3-card-error-background);\"}"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-card-error-color); background-color: var(--b3-card-error-background);"},"TextMarkType":"block-ref em text","TextMarkBlockRefID":"20240418205620-zx2cgph","TextMarkBlockRefSubtype":"d","TextMarkTextContent":"4.1.7 法线变换"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-card-error-color); background-color: var(--b3-card-error-background);\"}"}]},{"ID":"20240418201742-8ct2jju","Type":"NodeBlockquote","Properties":{"id":"20240418201742-8ct2jju","updated":"20240418202635"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240418202631-2tzumxp","Type":"NodeParagraph","Properties":{"id":"20240418202631-2tzumxp","updated":"20240418202635"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"顶点混合非常适合在GPU上运行，我们可以将网格中的顶点集合放入GPU的静态缓存中（只需要发送一次），之后重复使用这个缓存即可。在每一帧中，只有骨骼节点发生了变化（顶点数量和连接关系不会发生变化，即GPU上的静态缓存也不会发生变化），我们使用一个顶点着色器，来计算骨骼节点对缓存中存储网格的影响。通过这种方式，可以最大程度的减少在CPU上进行的处理，以及与GPU之间的数据传输（会带来大量延迟），这使得GPU可以高效地渲染这个网格。最简单的情况是可以同时使用模型的整套骨骼矩阵，否则的话就需要拆分模型，并复制一些骨骼。还可以将骨骼的变换存储在顶点可以访问的纹理中，从而避免触及寄存器的限制。通过使用四元数来表示旋转变换，那么每个变换都可以被存储在两张纹理中"},{"Type":"NodeText","Data":"["},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"1639]（一张存储顶点的位置，一张存储用于旋转的单位四元数）。如果可以使用无序访问视图（UAV）的话，还可以对蒙皮的动画结果进行重复使用"}]}]},{"ID":"20240418202636-94ajma3","Type":"NodeParagraph","Properties":{"id":"20240418202636-94ajma3","updated":"20240418202908"},"Children":[{"Type":"NodeText","Data":"上面的是最基础的顶点混合方案，但是存在一些缺点，比如可能出现"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"折叠、扭曲或者自交"},{"Type":"NodeText","Data":"​现象，一个更好的方案是使用"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"双四元数混合"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeText","Data":"，这个技术可以让蒙皮保持原始形状的刚性从而避免四肢出现像“糖纸”一样的扭曲，且此方案计算成本小于线性蒙皮混合。"}]},{"ID":"20240418202923-l42mhl9","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240418202923-l42mhl9","updated":"20240517092339"},"Children":[{"Type":"NodeText","Data":"4.5 变形"}]},{"ID":"20240418203017-4v344zy","Type":"NodeParagraph","Properties":{"id":"20240418203017-4v344zy","updated":"20240418203138"},"Children":[{"Type":"NodeText","Data":"变形主要会涉及到两个问题："},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"顶点对应"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeText","Data":"（vertex correspondence）问题和"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"插值"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeText","Data":"（interpolation）问题。"}]},{"ID":"20240418203135-0xrwjsz","Type":"NodeParagraph","Properties":{"id":"20240418203135-0xrwjsz","updated":"20240418203213"},"Children":[{"Type":"NodeText","Data":"如果两个模型之间已经有了一一对应的顶点了，即对于第一个模型中的每个顶点，我们都可以在第二个模型中找到唯一相对应的顶点。这种情况下的变形操作是很简单的，我们只需要在对应的顶点属性之间进行插值就可以获得中间数据了。"}]},{"ID":"20240418203238-472yvrf","Type":"NodeParagraph","Properties":{"id":"20240418203238-472yvrf","updated":"20240418203245"},"Children":[{"Type":"NodeText","Data":"变形目标（morph target）或者形状混合（blend shape）[907]是变形技术的其中一种，用户可以对其进行更加直观的控制，下图展示了其基本思想。"}]},{"ID":"20240418203251-5y5n9g9","Type":"NodeParagraph","Properties":{"id":"20240418203251-5y5n9g9","updated":"20240517092339"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240418203251-mwliozt.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"给定两个嘴巴的姿态，可以计算一组差分向量，用于控制插值。在变形目标中，我们可以通过调整差分向量的权重，从而在中性面部（标准面部姿态，类似于T Pose）上“添加”运动。在这个例子中，当权重为正的时候，我们可以获得一个嘴角上扬的笑脸；当权重为负的时候，我们可以获得一个相反的结果，即嘴角下垂的哭脸。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240418203254-qm3gal2","Type":"NodeParagraph","Properties":{"id":"20240418203254-qm3gal2","updated":"20240418203509"},"Children":[{"Type":"NodeText","Data":"从一个标准的中性模型（neutral model）开始，在这个例子中，这个中性模型是一个没有表情的脸，我们将其标记为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathcal{N}"},{"Type":"NodeText","Data":"。此外还需要有一组不同的面部姿态，而在这个例子中我们只有一个笑脸作为额外的面部姿态。一般来说，我们可以允许"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"k \\ge 1"},{"Type":"NodeText","Data":"个不同的姿态，我们使用"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathcal{P}_{i}, i \\in[1, \\ldots, k]"},{"Type":"NodeText","Data":"来标记它们。在预处理阶段，我们通过使用每个不同的姿态来减去中性姿态，从而计算出姿态之间的差分向量，即"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathcal{D}_{i}=\\mathcal{P}_{i}-\\mathcal{N}"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240418203506-m4qagz4","Type":"NodeParagraph","Properties":{"id":"20240418203506-m4qagz4","updated":"20240418203536"},"Children":[{"Type":"NodeText","Data":"可以使用下面的方程计算一个变形模型"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\mathcal{M}"},{"Type":"NodeText","Data":":"}]},{"ID":"20240418203537-lspzs1t","Type":"NodeMathBlock","Properties":{"id":"20240418203537-lspzs1t","updated":"20240418203542"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathcal{M}=\\mathcal{N}+\\sum_{i=1}^{k} w_{i} \\mathcal{D}_{i}\n\\tag{4.61}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240418203542-g2brxdv","Type":"NodeParagraph","Properties":{"id":"20240418203542-g2brxdv","updated":"20240418203553"},"Children":[{"Type":"NodeText","Data":"通过使用不同的权重"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"w_{i}"},{"Type":"NodeText","Data":"，根据需要来将不同姿态的特征进行加权混合。"}]},{"ID":"20240418203554-kqxfoum","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240418203554-kqxfoum","updated":"20240418203637"},"Children":[{"Type":"NodeText","Data":"4.6 几何缓存回放"}]},{"ID":"20240418203638-gpd67h8","Type":"NodeBlockquote","Properties":{"id":"20240418203638-gpd67h8","updated":"20240418203855"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240418203843-v098d6h","Type":"NodeParagraph","Properties":{"id":"20240418203843-v098d6h","updated":"20240418203855"},"Children":[{"Type":"NodeText","Data":"在一些过场动画中，我们可能会希望使用一些极高质量的动画，这些高质量动画使用上述我们所提到的任何方法和技术都无法实时实现。一种简单的方法是，将所有帧的顶点数据预先计算并存储起来， 然后在游戏运行的时候，从磁盘上读取这些数据并对顶点进行更新。但是对于一个包含30000个顶点的模型而言，一段简单的动画可能就会占据50 MB/s的带宽。"}]}]},{"ID":"20240418204011-rj28ehe","Type":"NodeParagraph","Properties":{"id":"20240418204011-rj28ehe","updated":"20240418204041"},"Children":[{"Type":"NodeText","Data":"优化方法见原书。"}]},{"ID":"20240418204041-mjnyk0l","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240418204041-mjnyk0l","updated":"20240418204048"},"Children":[{"Type":"NodeText","Data":"4.7 投影"}]},{"ID":"20240418204049-9xbimwa","Type":"NodeParagraph","Properties":{"id":"20240418204049-9xbimwa","updated":"20240418204210"},"Children":[{"Type":"NodeText","Data":"在本小节中，我们假设在经过观察变换之后，相机会看向负z轴，同时y轴指向上，x轴指向右，即一个标准的右手坐标系。"}]},{"ID":"20240418204225-xf6kkaf","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240418204225-xf6kkaf","updated":"20240418204233"},"Children":[{"Type":"NodeText","Data":"4.7.1 正交投影"}]},{"ID":"20240418204242-2auzqrg","Type":"NodeParagraph","Properties":{"id":"20240418204242-2auzqrg","updated":"20240418204247"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"正交投影的一个特征是，投影之前的平行线，在投影之后仍然会保持平行。"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"},{"Type":"NodeText","Data":"这也就意味着，当使用正交投影来观察一个场景的时候，无论场景中的物体距离相机多远，它们的大小都不会发生改变。"}]},{"ID":"20240418204247-jtznt3o","Type":"NodeParagraph","Properties":{"id":"20240418204247-jtznt3o","updated":"20240418204326"},"Children":[{"Type":"NodeText","Data":"下面的矩阵是一个简单的正交投影，将"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"z"},{"Type":"NodeText","Data":"分量直接归零："}]},{"ID":"20240418204327-6chmyq3","Type":"NodeMathBlock","Properties":{"id":"20240418204327-6chmyq3","updated":"20240418204332"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{P}_{o}=\n\\left(\\begin{array}{cccc}\n1 \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 1 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 1\n\\end{array}\\right)\n\\tag{4.62}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240418204342-r38ec0l","Type":"NodeParagraph","Properties":{"id":"20240418204342-r38ec0l","updated":"20240418204355"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240418204342-pnj5ioc.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"由 方程4.62 生成的简单正交投影，图中展示了这个过程的三个观察视图。这个投影可以看作是观察者沿着负 z 轴进行观察，这意味着这个投影操作实际上只是省略了（或者设置为零） z 坐标，同时保持 x 和 y 坐标不变。请注意，位于 平面 z = 0 两边的物体，都会被投影到投影平面上。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240418204355-a6twri0","Type":"NodeParagraph","Properties":{"id":"20240418204355-a6twri0","updated":"20240418204710"},"Children":[{"Type":"NodeText","Data":"通常我们会使用一个六元组（l, r, b, t, n, f）来描述一个正交投影矩阵，它们分别代表了左侧、右侧、底部、顶部、近裁剪平面以及远裁剪平面。这个矩阵会将代表可视空间的轴对齐包围盒（axis-aligned bounding box，简称AABB，详见章节22.2）转换为一个位于原点的轴对齐立方体。我们需要额外注意的是"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color6);"},"TextMarkType":"text","TextMarkTextContent":"由于相机此时看向的是负 z  轴，因此n \u0026gt; f。"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color6);\"}"}]},{"ID":"20240418204724-qse2f3s","Type":"NodeParagraph","Properties":{"id":"20240418204724-qse2f3s","updated":"20240418204752"},"Children":[{"Type":"NodeText","Data":"在OpenGL中，这个轴对齐立方体的范围是从"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"(-1,-1,-1)"},{"Type":"NodeText","Data":"到"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"(1, 1, 1)"},{"Type":"NodeText","Data":"；而在DirectX中这个范围则是"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"(-1,-1,0)"},{"Type":"NodeText","Data":"到"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"(1, 1, 1)"},{"Type":"NodeText","Data":"。这个立方体被称为规则观察体（canonical view volume，CVV），此时所在的空间被称为规范化设备坐标系（normalized device coordinates，NDC；也叫做齐次裁剪空间）。"}]},{"ID":"20240418204803-tymo3hm","Type":"NodeParagraph","Properties":{"id":"20240418204803-tymo3hm","updated":"20240418204812"},"Children":[{"Type":"NodeText","Data":"整个变换过程如下所示："}]},{"ID":"20240418204817-4jx2zp4","Type":"NodeParagraph","Properties":{"id":"20240418204817-4jx2zp4","updated":"20240418204830"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240418204817-214toba.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"将一个AABB转换为一个规则观察体。左侧图中的AABB首先会进行平移，使其几何中心位于原点处；然后再对AABB进行缩放，使其变成右图中的规则观察体。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240418204830-385u92c","Type":"NodeParagraph","Properties":{"id":"20240418204830-385u92c","updated":"20240418204857"},"Children":[{"Type":"NodeText","Data":"在转换为规则观察体之后，需要渲染的几何体顶点会被这个立方体所裁剪。位于立方体内的几何体最终会被保留，然后通过屏幕映射的方式，将剩余的正方形区域渲染到屏幕上。"}]},{"ID":"20240418204859-x8a6od0","Type":"NodeParagraph","Properties":{"id":"20240418204859-x8a6od0","updated":"20240418204905"},"Children":[{"Type":"NodeText","Data":"详细的正交投影矩阵如下："}]},{"ID":"20240418204906-a2p4q5k","Type":"NodeMathBlock","Properties":{"id":"20240418204906-a2p4q5k","updated":"20240419190625"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{aligned} \n\\mathbf{P}_{o}=\\mathbf{S}(\\mathbf{s}) \\mathbf{T}(\\mathbf{t}) \u0026=\n\\left(\\begin{array}{cccc}\n\\dfrac{2}{r-l} \u0026 0 \u0026 0 \u0026 0 \\\\ \n0 \u0026 \\dfrac{2}{t-b} \u0026 0 \u0026 0 \\\\\n0 \u0026 0 \u0026 \\dfrac{2}{f-n} \u0026 0 \\\\ \n0 \u0026 0 \u0026 0 \u0026 1\n\\end{array}\\right)\n\\left(\\begin{array}{cccc}\n1 \u0026 0 \u0026 0 \u0026 -\\dfrac{l+r}{2} \\\\ \n0 \u0026 1 \u0026 0 \u0026 -\\dfrac{t+b}{2} \\\\ \n0 \u0026 0 \u0026 1 \u0026 -\\dfrac{f+n}{2} \\\\ \n0 \u0026 0 \u0026 0 \u0026 1\n\\end{array}\\right) \\\\\n\u0026=\\left(\\begin{array}{cccc}\n\\dfrac{2}{r-l} \u0026 0 \u0026 0 \u0026 -\\dfrac{r+l}{r-l} \\\\[2mm]\n0 \u0026 \\dfrac{2}{t-b} \u0026 0 \u0026 -\\dfrac{t+b}{t-b} \\\\[2mm]\n0 \u0026 0 \u0026 \\dfrac{2}{f-n} \u0026 -\\dfrac{f+n}{f-n} \\\\[2mm] \n0 \u0026 0 \u0026 0 \u0026 1\\end{array}\\right) . \n\\end{aligned}\\tag{4.63}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240418204918-wdcyd8f","Type":"NodeBlockquote","Properties":{"id":"20240418204918-wdcyd8f","updated":"20240418205021"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240418205002-eb7u16j","Type":"NodeParagraph","Properties":{"id":"20240418205002-eb7u16j","updated":"20240418205021"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"当且仅当"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"n \\ne f"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"l \\ne r"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"t \\ne b"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"此矩阵存在逆矩阵；否则，不存在逆矩阵。"}]}]},{"ID":"20240418205022-f0rz6kq","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240418205022-f0rz6kq","updated":"20240418205228"},"Children":[{"Type":"NodeText","Data":"4.7.2 透视投影"}]},{"ID":"20240418205229-9moy0cv","Type":"NodeParagraph","Properties":{"id":"20240418205229-9moy0cv","updated":"20240419191611"},"Children":[{"Type":"NodeText","Data":"透视投影具有近大远小的特点，比较符合人眼观察世界的模式。"}]},{"ID":"20240419192140-sj17hl0","Type":"NodeParagraph","Properties":{"id":"20240419192140-sj17hl0","updated":"20240419192230"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240419192140-3zjfuvs.png"},{"Type":"NodeLinkSpace"},{"Type":"NodeLinkTitle","Data":"上图是用于推导透视投影矩阵的几何符号。点 p 投影到平面 z=-d,d\u003e0 上，最终生成一个新的顶点 q 。投影是从相机的角度执行的，在本例中相机位于原点。使用右图中的相似三角形，可以推导出点q的 x 分量。"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240419192230-mprcvhu","Type":"NodeParagraph","Properties":{"id":"20240419192230-mprcvhu","updated":"20240419192244"},"Children":[{"Type":"NodeText","Data":"通过相似三角形有："}]},{"ID":"20240419192245-1n1j8va","Type":"NodeMathBlock","Properties":{"id":"20240419192245-1n1j8va","updated":"20240419192250"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\frac{q_{x}}{p_{x}}=\\frac{-d}{p_{z}} \\quad \n\\Longleftrightarrow \n\\quad q_{x}=-d \\frac{p_{x}}{p_{z}}.\n\\tag{4.67}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240419192250-e44nvmg","Type":"NodeParagraph","Properties":{"id":"20240419192250-e44nvmg","updated":"20240419192325"},"Children":[{"Type":"NodeText","Data":"同理可以推出q的其他分量，如"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"q_{y}=-d p_{y} / p_{z}"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"和"},{"Type":"NodeTextMark","TextMarkType":"strong inline-math","TextMarkInlineMathContent":"q_{z}=-d"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"。"},{"Type":"NodeText","Data":"整合得"}]},{"ID":"20240419192326-8akw6zm","Type":"NodeMathBlock","Properties":{"id":"20240419192326-8akw6zm","updated":"20240419192423"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{P}_{p}=\n\\left(\\begin{array}{cccc}\n1 \u0026 0 \u0026 0 \u0026 0 \\\\ \n0 \u0026 1 \u0026 0 \u0026 0 \\\\ \n0 \u0026 0 \u0026 1 \u0026 0 \\\\ \n0 \u0026 0 \u0026 -1 / d \u0026 0\n\\end{array}\\right)\n\\tag{4.68}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240419192333-ja0u7k5","Type":"NodeParagraph","Properties":{"id":"20240419192333-ja0u7k5","updated":"20240419192442"},"Children":[{"Type":"NodeText","Data":"4.68式的透视变换矩阵可以产生正确的透视投影，具体方程如下："}]},{"ID":"20240419192443-7q31p3x","Type":"NodeMathBlock","Properties":{"id":"20240419192443-7q31p3x","updated":"20240419192448"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\begin{array}{}\n\\mathbf{q}=\\mathbf{P}_{p} \\mathbf{p}\u0026=\n\\left(\\begin{array}{}\n1 \u0026 0 \u0026 0 \u0026 0 \\\\\n0 \u0026 1 \u0026 0 \u0026 0 \\\\ \n0 \u0026 0 \u0026 1 \u0026 0 \\\\ \n0 \u0026 0 \u0026 -1 / d \u0026 0\n\\end{array}\\right)\n\\left(\\begin{array}{c}\np_{x} \\\\ p_{y} \\\\ p_{z} \\\\ 1\n\\end{array}\\right)\\\\[2mm]\n\u0026=\\left(\\begin{array}{c}p_{x} \n\\\\ p_{y} \\\\ p_{z} \\\\ -p_{z} / d\n\\end{array}\\right) \n\\Rightarrow\n\\left(\\begin{array}{c}\n-d p_{x} / p_{z} \\\\ -d p_{y} / p_{z} \\\\ -d \\\\ 1\n\\end{array}\\right)\n\\tag{4.69} \n\\end{array}{}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240419192448-o29rutj","Type":"NodeParagraph","Properties":{"id":"20240419192448-o29rutj","updated":"20240419192540"},"Children":[{"Type":"NodeText","Data":"最后一步将所有分量都除以了"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"w"},{"Type":"NodeText","Data":"，几何解释是将点"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"(p_x,p_y,p_z)"},{"Type":"NodeText","Data":"投影到"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"w=1"},{"Type":"NodeText","Data":"的平面上。"}]},{"ID":"20240419192540-nf396kt","Type":"NodeParagraph","Properties":{"id":"20240419192540-nf396kt","updated":"20240419192946"},"Children":[{"Type":"NodeText","Data":"与正交投影类似，透视投影并没有真正地将所有物体都投影到了一个平面上（这个过程是不可逆的），而是将视锥体变换成了一个规则观察体。在透视投影的时候，我们会假设视锥体从 "},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"z=n"},{"Type":"NodeText","Data":"   开始，并在"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"z=f"},{"Type":"NodeText","Data":"结束，其中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"0\u003en\u003ef"},{"Type":"NodeText","Data":"。在"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"z=n"},{"Type":"NodeText","Data":"这个平面上，视锥体的截面是一个长方形，其最小角（左下角）是"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"(l, b, n)"},{"Type":"NodeText","Data":"，最大角（右上角）是"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"(r, t, f)"},{"Type":"NodeText","Data":"，如图4.20所示。"}]},{"ID":"20240419192905-h0fwxtf","Type":"NodeParagraph","Properties":{"id":"20240419192905-h0fwxtf","updated":"20240419192940"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240419192938-zi8rdk9.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240419192941-bjg9mys","Type":"NodeParagraph","Properties":{"id":"20240419192941-bjg9mys","updated":"20240419193125"},"Children":[{"Type":"NodeText","Data":"视场角（field of view，FOV）是提供场景感的重要因素。"}]},{"ID":"20240419193126-cj4qzo8","Type":"NodeParagraph","Properties":{"id":"20240419193126-cj4qzo8","updated":"20240419193130"},"Children":[{"Type":"NodeText","Data":"水平视场角的计算方法为："}]},{"ID":"20240419193131-8e2rt86","Type":"NodeMathBlock","Properties":{"id":"20240419193131-8e2rt86","updated":"20240419193135"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\phi=2 \\arctan (w /(2 d))  \\tag{4.70}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240419193135-6cdnn9v","Type":"NodeParagraph","Properties":{"id":"20240419193135-6cdnn9v","updated":"20240419193150"},"Children":[{"Type":"NodeText","Data":"其中"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"\\phi"},{"Type":"NodeText","Data":"是视场角，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"w"},{"Type":"NodeText","Data":"是物体垂直于视线的宽度，"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"d"},{"Type":"NodeText","Data":"是物体到相机的距离。"}]},{"ID":"20240419193146-d05iuym","Type":"NodeBlockquote","Properties":{"id":"20240419193146-d05iuym","updated":"20240419193333"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20240419193157-p1tiyp8","Type":"NodeParagraph","Properties":{"id":"20240419193157-p1tiyp8","updated":"20240419193333"},"Children":[{"Type":"NodeText","Data":"一个25英寸（对角线距离）的显示器大约宽22英寸，如果这个显示器在距离12英寸远的地方，那么水平视场角应为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"85^{\\circ}"},{"Type":"NodeText","Data":"；20英寸远时水平视场角为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"58^{\\circ}"},{"Type":"NodeText","Data":"；30英寸远时水平视场角为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"40"},{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"sup inline-math","TextMarkInlineMathContent":"{\\circ}"},{"Type":"NodeText","Data":"。这个视场角的计算公式也可以用于将相机镜头尺寸转换为视场角，例如：相机的感光元件宽35mm ，镜头长50mm，则其视场角为"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"^\\phi=2 \\arctan (36 /(2 \\cdot 50))=39.6^{\\circ}。"},{"Type":"NodeText","Data":"\n"}]}]},{"ID":"20240419193437-q4do964","Type":"NodeParagraph","Properties":{"id":"20240419193437-q4do964","updated":"20240419193454"},"Children":[{"Type":"NodeText","Data":"将透视投影矩阵转换为规则观察体的矩阵如下："}]},{"ID":"20240419193455-67uj22m","Type":"NodeMathBlock","Properties":{"id":"20240419193455-67uj22m","updated":"20240419213201"},"Children":[{"Type":"NodeMathBlockOpenMarker"},{"Type":"NodeMathBlockContent","Data":"\\mathbf{P}_{p}=\n\\left(\\begin{array}{cccc}\n\\dfrac{2 n}{r-l} \u0026 0 \u0026 -\\dfrac{r+l}{r-l} \u0026 0 \\\\[2mm]\n0 \u0026 \\dfrac{2 n}{t-b} \u0026 -\\dfrac{t+b}{t-b} \u0026 0 \\\\[2mm]\n0 \u0026 0 \u0026 \\dfrac{f+n}{f-n} \u0026 -\\dfrac{2 f n}{f-n} \\\\[2mm]\n0 \u0026 0 \u0026 1 \u0026 0\n\\end{array}\\right)\n\\tag{4.71}"},{"Type":"NodeMathBlockCloseMarker"}]},{"ID":"20240419193638-22u08fw","Type":"NodeParagraph","Properties":{"id":"20240419193638-22u08fw","updated":"20240419193737"},"Children":[{"Type":"NodeText","Data":"推导可见："},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://www.bilibili.com/video/BV1X7411F744?p=4\u0026amp;vd_source=dcc481c1d3245018bb5c23265b453db4","TextMarkTextContent":"Lecture 04 Transformation Cont._哔哩哔哩_bilibili"}]},{"ID":"20240419193737-kxt0b2b","Type":"NodeParagraph","Properties":{"id":"20240419193737-kxt0b2b","updated":"20240419193912"},"Children":[{"Type":"NodeText","Data":"在投影变换（包括正交投影和透视投影）之后，还会进行裁剪操作和齐次化操作（homogenization，坐标除以w分量），最终将其转换到NDC空间中（规范化设备坐标系，normalized device coordinate）。"}]},{"ID":"20240419193912-ct1a1or","Type":"NodeParagraph","Properties":{"id":"20240419193912-ct1a1or","updated":"20240419194021"},"Children":[{"Type":"NodeText","Data":"透视投影带来的一个影响是，计算出的深度值并不会随着输入的"},{"Type":"NodeTextMark","TextMarkType":"inline-math","TextMarkInlineMathContent":"p_z"},{"Type":"NodeText","Data":"值线性变化，"}]},{"ID":"20240419213142-wedw8oj","Type":"NodeParagraph","Properties":{"id":"20240419213142-wedw8oj"}}]}